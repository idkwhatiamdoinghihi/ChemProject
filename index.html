<!DOCTYPE html>
<html lang="zh-MO">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    <title>ChemScope</title>
<style>
/* --- 1. åŸºç¤è¨­å®š --- */
    :root {
        --bg-radial-inner: #070707; 
        --bg-radial-outer: #000000;
        --panel-glass: rgba(20, 20, 20, 0.9);
        --panel-border: rgba(255, 255, 255, 0.15);
        --card-glass: rgba(255, 255, 255, 0.05);
        --text-main: #ffffff;
        --text-sub: #c2a70c;
        --text-highlight: #e0d01f;
        --accent-yellow: #f59e0b;
        --accent-blue: var(--accent-yellow);
    }

    /* Light mode override: toggled by adding `light-mode` to <body> */
    body.light-mode {
        --bg-radial-inner: #fbfbfc;
        --bg-radial-outer: #f1f5f9;
        --panel-glass: rgba(255, 255, 255, 0.92);
        --panel-border: rgba(15, 23, 42, 0.06);
        --card-glass: rgba(2, 6, 23, 0.03);
        --text-main: #0f172a;
        --text-sub: #92400e;
        --text-highlight: #92400e;
        --accent-yellow: #f59e0b;
        --accent-blue: var(--accent-yellow);
    }
    /* Additional light-mode surface tweaks */
    /* Make the 3D viewport area pure white in light mode */
    body.light-mode .viewport-area { background: #ffffff !important; background-image: none !important; }
    body.light-mode .viewport-header h1 { color: #0f172a; text-shadow: none; }
    body.light-mode .molecule-display-info { background: #ffffff !important; color: #0f172a; text-shadow: none; border: none; }
    body.light-mode .molecule-display-info .info-formula, body.light-mode .molecule-display-info .info-name { color: #0f172a; }
    body.light-mode .molecule-display-info .info-formula { text-shadow: none; }
    body.light-mode .creator-credit { background: #ffffff !important; color: #0f172a !important; text-shadow: none; border: none; }
    /* Make the divider between viewport and controls a simple solid medium-dark grey */
    body.light-mode .controls-area { border-left: 1px solid #6b7280; box-shadow: none; }

     /* Controls content: light yellow background; inner cards white/light-grey with black text */
     /* Make the overall controls area pale yellow and force inner cards to white
         (use !important to override occasional inline styles used on specific cards) */
     body.light-mode .controls-area { background: #fffbeb; }
     body.light-mode .controls-content { background: transparent; }
    body.light-mode .controls-content .card { background: #ffffff !important; color: #0f172a; border: 1px solid #000 !important; }
     body.light-mode .controls-content .card .card-title { color: #0f172a; }
     body.light-mode .controls-content .card .data-label, body.light-mode .controls-content .card .data-value { color: #0f172a; }
    body.light-mode .controls-content .input-group input, body.light-mode .controls-content .input-group button { color: #0f172a; }
    /* Ensure switch/toggle containers don't keep a dark background inside white cards */
    body.light-mode .controls-content .switch-container { background: transparent; }
    /* Data rows: use lighter grey separators (more subtle) and remove the last (beneath åˆ†å­é‡) */
    body.light-mode #data-card .data-row { border-bottom: 1px solid #D1D5DB !important; }
    body.light-mode #data-card .data-row:last-child { border-bottom: none !important; }

    /* Load button: lighter yellow (match active switch color) with dark text for contrast */
    body.light-mode .controls-content .input-group button, body.light-mode #load-btn { background: #facc15 !important; color: #000 !important; border: 1px solid rgba(0,0,0,0.08) !important; }

    /* Make checkboxes/radios use a lighter yellow accent in light mode for visual parity */
    body.light-mode .controls-content .switch-container input,
    body.light-mode input[type="checkbox"],
    body.light-mode input[type="radio"] { accent-color: #facc15 !important; }

    /* Formula input: white background with dark grey border in light mode */
    body.light-mode .input-group input { background: #ffffff !important; border: 1px solid #374151 !important; color: #0f172a !important; }

    /* Theme toggle: yellow background with black text */
    body.light-mode #theme-toggle { background: #facc15 !important; color: #000 !important; border-color: #000 !important; }

    * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

    /* --- [ä¿®æ”¹] ä¸Šä¸‹æ¨™èˆ‡æ­£è² è™Ÿ åˆ†é›¢æ§åˆ¶å€ --- */
    
    /* 1. ä¸‹æ¨™è¨­å®š (æ§åˆ¶åŸå­æ•¸é‡ï¼Œå¦‚ H2 çš„ 2) */
    sub {
        font-size: 0.7em;      /* ä¸‹æ¨™å­—é«”å¤§å° */
        line-height: 1;
        position: relative;
        vertical-align: baseline;
        bottom: -0.2em;        /* ä¸‹æ¨™ä½ç½®ï¼šè¶Šè² è¶Šå¾€ä¸‹ */
    }

    /* 2. ä¸Šæ¨™è¨­å®š (æ§åˆ¶é›»è·çš„"æ•¸å­—"ï¼Œå¦‚ 3- çš„ 3) */
    sup {
        font-size: 0.7em;      /* ä¸Šæ¨™å­—é«”å¤§å° */
        line-height: 1;
        position: relative;
        vertical-align: baseline;
        top: -0.5em;          /* ä¸Šæ¨™ä½ç½®ï¼šè¶Šè² è¶Šå¾€ä¸Š */
        font-weight: bold;     /* ä¸Šæ¨™åŠ ç²—boldï¼Œæ­£å¸¸ç‚ºnormal */
        margin-left: 1px;      /* èˆ‡ä¸»æ–‡å­—çš„è·é›¢ */
    }

    /* 3. æ­£è² è™Ÿè¨­å®š (å°ˆé–€æ§åˆ¶ + èˆ‡ -ï¼Œå¦‚ 3- çš„ -) */
    .charge-sign {
        font-size: 1.4em;      /* æ­£è² è™Ÿå¯ä»¥è¨­å¤§ä¸€é»ï¼Œæ¯”è¼ƒæ¸…æ¥š */
        font-weight: bold;     /* æ­£è² è™ŸåŠ ç²— */
        position: relative;
        top: 0.05em;           /* æ­£è² è™Ÿå¾®èª¿ï¼šæ­£å€¼å¾€ä¸‹ï¼Œè² å€¼å¾€ä¸Š */
        margin-left: 0px;      /* æ­£è² è™Ÿèˆ‡æ•¸å­—çš„è·é›¢ */
    }

    body {
        margin: 0;
        font-family: 'Noto Serif TC', serif;
        background: radial-gradient(circle at center, var(--bg-radial-inner) 0%, var(--bg-radial-outer) 100%);
        color: var(--text-main);
        height: 100vh; overflow: hidden; display: flex; flex-direction: column;
        overscroll-behavior: none;
    }

    .app-container { display: flex; width: 100%; height: 100%; flex-direction: row; }

/* --- 3D é¡¯ç¤ºå€ --- */
    .viewport-area {
        flex: 1; position: relative;
        background-image: 
            linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), 
            linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
        background-size: 60px 60px; 
        background-position: center center;
        overflow: hidden; cursor: grab;
        touch-action: none; 
        -webkit-user-select: none;
        will-change: transform;
        transform: translateZ(0);
    } 

    .viewport-header { 
        position: absolute; top: 70px; left: 25px; z-index: 10; pointer-events: none; 
        max-width: 80%;
    }

    /* hide per-viewport title to avoid duplication with global header */
    .viewport-header h1 {
        margin: 0;
        font-size: 1.6rem;
        color: #ffffff;
        text-shadow: 0 0 5px rgba(255, 245, 137, 0.519);
        margin-bottom: 5px;
        display: none; /* hide duplicate title (global header shows tool name) */
        align-items: baseline;
        gap: 8px;
    }

    .molecule-display-info {
        margin-top: 5px;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        padding: 10px 15px;
        border-radius: 12px;
        border-left: none;
        /* nudge left to remove small leftover gap after border removal */
        margin-left: -8px;
        pointer-events: auto;
        display: inline-block;
    }

    .info-formula {
        font-size: 2.2rem;
        font-weight: 700;
        color: #fff;
        line-height: 1.1;
        text-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }
    
    .info-name {
        font-size: 1.2rem;
        color: var(--text-highlight);
        font-weight: 500;
        margin-top: 4px;
    }

    @media (max-width: 768px) {
        .viewport-header { top: 15px; left: 15px; }
        .viewport-header h1 { display: none; font-size: 0.9rem; letter-spacing: normal; }
        .molecule-display-info { padding: 8px 12px; }
        .info-formula { font-size: 1.8rem; }
        .info-name { font-size: 1rem; }
    }

    #viewport-subtitle { display: none; }
    #molecule-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    #molecule-svg * { pointer-events: none; }

    .atom-label-text {
        font-family: 'Noto Serif TC', serif; font-weight: 700; 
        text-anchor: middle; dominant-baseline: central; 
        fill: #ffffff; text-shadow: 0 0 4px #000;
    }

/* --- æ§åˆ¶é¢æ¿ --- */
    .controls-container {
        position: absolute; top: 25px; right: 25px; z-index: 50; 
        display: flex; gap: 15px; align-items: center; pointer-events: auto;
    }

    .control-button {
        padding: 8px 16px; border-radius: 20px; font-size: 0.9rem; font-weight: 600;
        border: 1px solid var(--panel-border); cursor: pointer; transition: all 0.3s;
        background: rgba(0, 0, 0, 0.4); color: var(--text-main);
        backdrop-filter: blur(4px); box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .control-button.active { background: var(--accent-yellow); border-color: var(--accent-yellow); box-shadow: 0 0 15px var(--accent-yellow); }

    /* App switch / dropdown */
    .app-switch { position: relative; display: inline-block; }
    #app-switch-btn { display: inline-flex; align-items: center; gap: 8px; }
    .app-switch-arrow { display: inline-block; transform: rotate(90deg); transition: transform 0.22s ease; font-weight: 900; }
    .app-switch.open .app-switch-arrow { transform: rotate(270deg); }
    .app-switch-menu {
        position: absolute; right: 0; top: calc(100% + 8px); min-width: 180px; display: flex; flex-direction: column; gap: 8px;
        background: rgba(10,10,10,0.95); border: 1px solid rgba(255,255,255,0.06); padding: 10px; border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.6); z-index: 500; opacity: 0; transform-origin: top right; transform: translateY(-6px) scale(0.98); pointer-events: none; transition: all 0.18s ease;
    }
    /* Ensure dropdown menu items use the same font-family as the title */
    .app-switch-menu .app-switch-item { font-family: inherit; }
    .app-switch.open .app-switch-menu { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
    .app-switch-menu .app-switch-item { text-align: left; padding: 8px 12px; border-radius: 10px; background: transparent; border: 1px solid rgba(255,255,255,0.03); }
    .app-switch-menu .app-switch-item:hover, .app-switch-menu .app-switch-item:focus { background: rgba(255,255,255,0.03); outline: none; }

    /* Title-based app switch adjustments */
    .app-switch-root { position: relative; display: inline-block; }
    .app-switch-root .title-btn { background: transparent; border: none; color: inherit; font-family: inherit; font-size: 1.6rem; font-weight: 700; padding: 0; cursor: pointer; display: inline-flex; align-items: baseline; gap: 8px; }
    .app-switch-root .app-switch-arrow { transform: rotate(90deg); font-size: 0.9rem; }
    .app-switch-root.open .app-switch-arrow { transform: rotate(270deg); }
    .app-switch-root .app-switch-menu { right: auto; left: 0; top: calc(100% + 8px); transform-origin: top left; }
    .app-switch-root.open .app-switch-menu { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }

    /* Tool panels (single-page views) */
    .tool-panel { display: none; }
    .tool-panel.active { display: block; }

    /* Allow interactive elements in the header (viewport-header uses pointer-events:none globally) */
    .viewport-header .app-switch-root, .viewport-header .title-btn, .viewport-header .molecule-display-info, .viewport-header .input-note { pointer-events: auto; }

    .card { 
        background: var(--card-glass); border: 1px solid var(--panel-border); 
        border-radius: 16px; padding: 20px; margin-bottom: 20px; 
    }
    .card-title { 
        font-size: 1rem; font-weight: 700; color: var(--text-highlight); 
        margin-bottom: 15px; display: flex; align-items: center; gap: 10px; text-transform: uppercase; letter-spacing: 1px;
    }
    /* Preserve title-case for specific control headings (override global uppercase) */
    #card-title-input, #data-card-title { text-transform: none; }
    .card-title.large-title { font-size: 1.15rem; }
    .data-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .data-label { font-size: 1rem; color: var(--text-sub); }
    .data-value { font-size: 1.15rem; color: var(--text-main); font-weight: 500; }
    /* --- å¹³è¡¡ä¿‚æ•¸èˆ‡è©³è§£é¢æ¿æ¨£å¼ --- */
    #balance-result {
        display: flex; flex-wrap: wrap; align-items: center; justify-content: center;
        padding: 20px; font-family: 'Noto Serif TC', serif;
    }
    .eqn-item { display: flex; align-items: center; margin: 0 4px; }
    .coeff { 
        color: #facc15; font-weight: 900; font-size: 1.6rem; 
        margin-right: 4px; font-style: italic;
        text-shadow: 0 0 15px rgba(250, 204, 21, 0.5);
    }
    .eqn-op { color: rgba(255,255,255,0.4); font-size: 1.2rem; margin: 0 10px; font-weight: bold; }
    .reaction-arrow { color: var(--accent-yellow); font-size: 1.8rem; margin: 0 15px; font-weight: bold; }
    #balance-result sup { top: -0.6em; font-size: 0.75em; margin-left: 1px; vertical-align: baseline; position: relative; }
    #balance-result sub { bottom: -0.2em; font-size: 0.75em; vertical-align: baseline; position: relative; }
    .step-box { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .step-title { color: #facc15; font-weight: bold; margin-bottom: 6px; display: flex; align-items: center; gap: 8px; font-size: 1.05rem; }
    .step-formula-box { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 8px; margin: 8px 0; font-family: 'Noto Serif TC', serif; font-size: 1.15rem; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
    .highlight-atom { color: var(--accent-yellow); font-weight: bold; border-bottom: 2px solid var(--accent-yellow); padding: 0 2px; }
    
    .input-group { display: flex; gap: 8px; font-family: 'Noto Serif TC', serif; align-items: center; width: 100%; }
    .input-group input { 
        flex: 1 1 auto; min-width: 0; padding: 12px; border: 1px solid var(--panel-border); border-radius: 8px; 
        background: rgba(0,0,0,0.3); color: white; transition: border 0.3s; outline: none; font-size: 1.1rem; 
        font-family: inherit; height: 44px; box-sizing: border-box;
    }
    .input-group button { 
        flex: 0 0 auto; padding: 10px 20px; background: var(--accent-yellow); color: white; border: none; border-radius: 8px; 
        cursor: pointer; font-weight: bold; font-family: inherit; height: 44px; display: inline-flex; align-items: center; justify-content: center; box-sizing: border-box;
    }

    /* Make mode/theme buttons match load button appearance and remove shadow
       Also ensure load button text is black for contrast in both themes */
    #mode-toggle, #theme-toggle, #load-btn, #lang-toggle {
        background: var(--accent-yellow) !important;
        color: #000 !important;
        border: 1px solid rgba(0,0,0,0.08) !important;
        font-family: inherit !important;
        font-weight: 700 !important;
        box-shadow: none !important;
        text-shadow: none !important;
    }
    /* Remove the black border specifically for the mode-switch button and make its shape similar to the load button */
    #mode-toggle {
        border: none !important;
        border-radius: 8px !important;
        padding: 10px 16px !important;
    }

    /* In light mode specifically ensure no black border and make the button match load-button sizing */
    body.light-mode #mode-toggle {
        border: none !important;
        border-radius: 8px !important;
        height: 44px !important;
        padding: 8px 14px !important;
        box-shadow: none !important;
        background: var(--accent-yellow) !important;
        color: #000 !important;
    }

    /* legacy container kept for compatibility; new inline switch styles below */
    .switch-container { display: none; }

    /* Row that holds multiple switch items side-by-side */
    .switch-row { display: flex; gap: 12px; margin-top: 12px; align-items: center; }
    .switch-item { display: inline-flex; align-items: center; gap: 10px; background: transparent; padding: 0; cursor: pointer; }

    /* Switch control appearance */
    .switch-input { position: absolute; opacity: 0; width: 0; height: 0; }
    .switch-item { position: relative; }
    .switch-item .slider { position: relative; display: inline-block; width: 44px; height: 24px; background: #e5e7eb; border-radius: 999px; border: 1px solid rgba(0,0,0,0.06); transition: background 0.18s ease; }
    .switch-item .slider::before { content: ""; position: absolute; left: 3px; top: 3px; width: 18px; height: 18px; background: #ffffff; border-radius: 50%; transition: left 0.18s ease, background 0.18s ease; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .switch-item input:checked + .slider { background: #facc15; border-color: rgba(0,0,0,0.08); }
    .switch-item input:checked + .slider::before { left: 23px; background: #000000; }
    .switch-label { font-size: 0.95rem; color: var(--text-main); font-weight: 600; }

    #variant-selector {
        display: none; background: rgba(16, 185, 129, 0.05); border: 1px solid rgba(16, 185, 129, 0.2);
        padding: 15px; border-radius: 12px; margin-bottom: 15px;
    }
    .variant-option { padding: 5px 0; display: flex; align-items: center; gap: 10px; cursor: pointer; color: var(--accent-blue); }

    #variant-selector.acid-theme { background: rgba(245, 158, 11, 0.05); border: 1px solid rgba(245, 158, 11, 0.3); }
    #variant-selector.acid-theme .variant-header { color: #fbbf24; }
    #variant-selector.acid-theme .variant-option { color: #fbbf24; }
    #variant-selector.acid-theme .variant-option:hover { background: rgba(245, 158, 11, 0.15); }

    #reaction-container { margin-bottom: 30px; width: 100%; }
    .reaction-row { display: flex; gap: 12px; width: 100%; flex-wrap: wrap; justify-content: center; }
    .reaction-btn {
        flex: 1 0 42%; max-width: 48%; min-width: 140px; height: 50px;
        padding: 0 10px; font-size: 0.95rem; font-weight: 600; color: white;
        border: none; border-radius: 50px; cursor: pointer;
        transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        display: none; align-items: center; justify-content: center; white-space: nowrap;
    }
    .reaction-btn:hover { transform: translateY(-2px); filter: brightness(1.1); box-shadow: 0 6px 16px rgba(0,0,0,0.3); }
    .reaction-btn:active { transform: translateY(1px); }

    .btn-h2o { background: linear-gradient(135deg, #3b82f6 0%, #2dd4bf 100%); }
    .btn-cl2 { background: linear-gradient(135deg, #fbbf24 0%, #b38728 100%); }
    .btn-h2  { background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%); }
    .btn-hcl { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
    .btn-kmno4 { background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); }
    
    @keyframes blurOutEffect { 0% { opacity: 1; filter: blur(0px); transform: scale(1); } 100% { opacity: 0; filter: blur(8px) brightness(1.5); transform: scale(1.05); } }
    @keyframes blurInEffect { 0% { opacity: 0; filter: blur(8px); transform: scale(0.95); } 100% { opacity: 1; filter: blur(0px); transform: scale(1); } }
    .scene-blur-out { animation: blurOutEffect 1.5s forwards ease-in; }
    .scene-blur-in { animation: blurInEffect 1.5s forwards ease-out; }

    .reset-btn {
        flex: 1; padding: 12px; background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--panel-border); color: var(--text-sub); border-radius: 12px;
        font-weight: bold; cursor: pointer; transition: all 0.2s;
    }
    .reset-btn:hover { background: rgba(255, 255, 255, 0.2); color: white; }

    /* æ‰‹æ©Ÿç‰ˆæ¨£å¼ */
    body.simulate-mobile .app-container { flex-direction: column; }
    body.simulate-mobile .controls-container { display: none !important; }
    body.simulate-mobile .viewport-area { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
    body.simulate-mobile .controls-area {
        position: fixed; bottom: 0; left: 0; width: 100%; height: 98vh; max-height: 98vh;
        border-left: none; border-top: 1px solid rgba(255,255,255,0.15);
        border-radius: 20px 20px 0 0; background-color: #1a1a1a; padding: 0; z-index: 100;
        transform: translateY(0); transition: transform 0.3s; will-change: transform;
    }
    body.simulate-mobile #mobile-panel-handle {
        display: flex; width: 100%; height: 40px; justify-content: center; align-items: center;
        cursor: pointer; flex-shrink: 0; background: rgba(255,255,255,0.03); border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .controls-area { 
        width: 520px; min-width: 360px;
        background-color: var(--panel-glass);
        backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
        border-left: 1px solid #6b7280; /* simple solid medium-to-dark grey */
        display: flex; flex-direction: column; 
        padding: 25px; overflow-y: auto; 
        box-shadow: none; 
        z-index: 20;
    }
    #mobile-panel-handle { display: none; }

    .input-note { font-size: 0.8rem; color: var(--text-sub); margin-top: 10px; line-height: 1.4; }
    .clickable-label { cursor: pointer; font-weight: bold; }
    .variant-header { font-weight: bold; color: var(--accent-blue); margin-bottom: 5px; }

/* --- æ‰‹æ©Ÿç‰ˆæ¥µé€Ÿå„ªåŒ– (iOS Native Like) --- */
@media (max-width: 768px), (max-height: 500px) { 
    .app-container { flex-direction: column; height: 100vh; width: 100vw; overflow: hidden; position: relative; }
    .controls-container { display: none !important; } 
    .viewport-area { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
    
    .controls-area {
        position: fixed; 
        left: 0; 
        bottom: 0; 
        width: 100%; 
        height: 98vh; 
        max-height: 98vh;
        background-color: rgba(26, 26, 26, 0.96); 
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border-radius: 20px 20px 0 0; 
        border-top: 1px solid rgba(255,255,255,0.15);
        box-shadow: 0 -10px 40px rgba(0,0,0,0.6);
        z-index: 100;
        display: flex; flex-direction: column;
        padding: 0;
        transform: translateY(calc(100% - 45px)); /* ç¢ºä¿æŠŠæ‰‹æ°¸é éœ²å‡ºä¸€é» */
        will-change: transform;
        transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
    }

    #mobile-panel-handle { 
        display: flex; width: 100%; height: 40px; 
        justify-content: center; align-items: center;
        cursor: grab; flex-shrink: 0; 
        /* æŠŠæ‰‹èƒŒæ™¯ */
        background: rgba(255,255,255,0.02);
        border-bottom: 1px solid rgba(255,255,255,0.05); 
        touch-action: none; /* é‡è¦ï¼šé–å®šç€è¦½å™¨é è¨­æ»‘å‹• */
    }
    
    /* ä¿®æ”¹é€™è£¡ï¼šæŠŠæ‰‹çš„æ¨£å¼ */
    .handle-bar {
        width: 36px; 
        height: 5px; 
        background-color: rgba(255, 255, 255, 0.3); 
        border-radius: 10px;
        /* åŠ å…¥éæ¸¡å‹•ç•«ï¼Œè®“è®Šå¤§è®Šå°å¾ˆæ»‘é † */
        transition: all 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    /* æ–°å¢é€™è£¡ï¼šç•¶æŠŠæ‰‹è¢«æŒ‰ä½ (active) æ™‚çš„æ•ˆæœ */
    #mobile-panel-handle:active .handle-bar,
    #mobile-panel-handle.active .handle-bar {
        width: 55px; /* è®Šå¯¬ */
        background-color: rgba(255, 255, 255, 0.7); /* è®Šäº® */
        box-shadow: 0 0 10px rgba(255,255,255,0.3); /* åŠ ä¸€é»ç™¼å…‰ */
    }
    
    .controls-content { 
        flex: 1; 
        padding: 20px; 
        overflow-y: auto; 
        overscroll-behavior: contain;
        padding-bottom: 15px; /* å…¨é–‹çš„åº•éƒ¨ç•™ç™½ */
        transition: padding-bottom 0.4s ease;
    }

    .controls-area.half-open .controls-content {
        padding-bottom: 45vh; /* åŠé–‹çš„åº•éƒ¨ç•™ç™½ */
    }
}

    .hybrid-tooltip {
        position: fixed; top: 40%; left: 50%; transform: translate(-50%, -50%); 
        background: rgba(0, 0, 0, 0.9); color: #fff; padding: 15px 25px;
        border-radius: 12px; border: 2px solid var(--accent-blue);
        font-family: 'Noto Serif TC', serif; font-size: 1.4rem; font-weight: bold;
        pointer-events: none; opacity: 0; transition: opacity 0.2s;
        z-index: 9999; white-space: nowrap; text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.8); text-shadow: 0 2px 4px #000;
        max-width: 90vw; 
    }
    
    /* --- çŸ¥è­˜å°ç™¾ç§‘å¡ç‰‡æ¨£å¼ --- */
    .knowledge-card {
        border: 1px solid rgba(251, 191, 36, 0.3); /* é‡‘é»ƒè‰²é‚Šæ¡† */
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.05) 0%, rgba(0, 0, 0, 0.2) 100%);
        transition: all 0.3s ease;
    }

    .knowledge-card .card-title {
        color: #fbbf24; cursor: pointer; justify-content: space-between; margin-bottom: 0; 
    }

    .toggle-icon { font-size: 0.8rem; transition: transform 0.3s; color: #fbbf24; }
    .knowledge-card.expanded .toggle-icon { transform: rotate(180deg); }
    .knowledge-card.expanded .card-title { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(251, 191, 36, 0.2); }
    .knowledge-content { display: none; font-size: 0.95rem; line-height: 1.6; color: #e2e8f0; text-align: justify; }
    .knowledge-content strong { color: var(--accent-yellow); }
    .knowledge-card.expanded .knowledge-content { display: block; animation: fadeIn 0.4s ease; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    /* çµ±ä¸€é«˜äº®ç´«è‰²ç»ç’ƒé¢¨æ ¼ */
    .glass-toggle-btn {
        width: 100%; height: 46px; margin-bottom: 12px;
        background: rgba(139, 92, 246, 0.25); 
        backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
        border: 1px solid rgba(139, 92, 246, 0.7); 
        color: #fff; font-size: 1rem; font-weight: 600; border-radius: 23px;
        cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px;
        transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .glass-toggle-btn:hover { background: rgba(139, 92, 246, 0.35); border-color: #fff; }

    .glass-content-panel {
        display: none; padding: 12px; border-radius: 20px;
        background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(139, 92, 246, 0.3);
        margin-top: -6px; margin-bottom: 15px;
    }
    /* å­é¸å–®å°ˆç”¨æ¨£å¼ */
    .sub-panel-btn {
        height: 40px !important;
        font-size: 0.95rem !important;
        background: rgba(255, 255, 255, 0.05) !important;
        border-color: rgba(255, 255, 255, 0.1) !important;
        margin-bottom: 6px !important;
    }
    
    .sub-content {
        background: rgba(0, 0, 0, 0.4) !important;
        border-radius: 15px !important;
        margin-left: 10px;
        margin-right: 10px;
        padding: 15px !important;
        border: 1px solid rgba(255, 255, 255, 0.05) !important;
    }

    /* è¼¸å…¥æ¡†é©é… */
    .sub-content .input-group input {
        padding: 8px;
        font-size: 0.9rem;
    }

    .panel-wrapper.expanded > .glass-content-panel { display: block; animation: fadeIn 0.3s ease; }
    .panel-wrapper.expanded > .glass-toggle-btn { border-bottom-left-radius: 5px; border-bottom-right-radius: 5px; }

    .glass-content-panel .glass-toggle-btn {
        height: 40px; font-size: 0.95rem;
        background: rgba(139, 92, 246, 0.15); border-color: rgba(139, 92, 246, 0.4);
    }
    .info-section { margin-bottom: 15px; }
    .info-title { font-weight: bold; color: #4ade80; margin-bottom: 8px; font-size: 1.05rem; border-left: 3px solid #4ade80; padding-left: 10px; letter-spacing: 1px; }
    .info-body { padding-left: 6px; font-size: 0.95rem; color: #f1f5f9; line-height: 1.7; text-align: justify; }
    .info-body strong { color: inherit; font-weight: 700; }
    .highlight-title { color: var(--accent-yellow); font-weight: bold; display: inline-block; margin-right: 4px; }
    .hybrid-tooltip.show { opacity: 1; }
    .flow-card {
        width: 100%;
        max-width: 500px;
        padding: 20px;
        border-radius: 16px;
        border: 2px solid;
        position: relative;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .branch-card { max-width: 300px; }
    .step-badge {
        position: absolute;
        top: -12px;
        left: 20px;
        padding: 2px 12px;
        border-radius: 20px;
        color: #000;
        font-size: 0.75rem;
        font-weight: 900;
        text-transform: uppercase;
    }
    .flow-title { font-weight: bold; font-size: 1.1rem; color: #fff; }
    .flow-body { margin-top: 10px; color: #94a3b8; line-height: 1.6; }
    .flow-arrow { color: #334155; font-size: 1.5rem; margin: -5px 0; }
    .pg-tag { color: var(--accent-yellow); font-weight: bold; margin: 0 4px; font-family: 'Noto Serif TC', serif; }
    .res-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
    .res-box {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.1);
        padding: 15px 5px;
        border-radius: 12px;
        font-size: 0.85rem;
        transition: all 0.3s;
    }
    .res-box:hover { background: rgba(250, 205, 21, 0.08); border-color: var(--accent-yellow); transform: translateY(-5px); }
    .pg-final { display: block; margin-top: 8px; font-size: 1.3rem; font-weight: bold; color: var(--accent-yellow); font-family: 'Noto Serif TC', serif; }

    /* é›»å­é–ƒçˆå‹•ç•« */
    @keyframes spark-flicker {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.4; transform: scale(0.6); }
    }
    .electron-spark { animation: spark-flicker 0.15s linear infinite; }
    /* ========== [è«‹æ’å…¥é€™æ®µ CSS] é›»å­çµ„æ…‹è¡¨æ¨£å¼ ========== */
    #config-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 200; justify-content: center; align-items: center; }
    .config-panel { background: #0f172a; border: 1px solid #334155; display: flex; flex-direction: column; width: 500px; height: 85vh; border-radius: 16px; box-shadow: 0 0 50px rgba(0,0,0,0.8); overflow: hidden; animation: slideUp 0.3s ease-out; }
    @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @media (max-width: 600px) { .config-panel { width: 100%; height: 100%; border-radius: 0; border: none; } }
    
    .config-header { padding: 15px; background: rgba(30,41,59,0.9); border-bottom: 1px solid #334155; display: flex; gap: 10px; align-items: center; }
    .config-close { background: transparent; border: none; color: #94a3b8; font-size: 1.5rem; cursor: pointer; padding: 0 10px; transition: 0.2s; } .config-close:hover { color: #fff; }
    .config-search { flex: 1; background: rgba(0,0,0,0.3); border: 1px solid #475569; color: #f1f5f9; padding: 12px; border-radius: 8px; font-size: 1rem; outline: none; }
    .config-list { flex: 1; overflow-y: auto; padding: 15px; }
    
    .element-card { background: rgba(30,41,59,0.4); border: 1px solid rgba(255,255,255,0.1); border-left: 3px solid var(--accent-yellow); border-radius: 12px; padding: 15px; margin-bottom: 15px; position: relative; }
    .ec-header { display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; }
    .ec-top-row { display: flex; justify-content: space-between; align-items: center; width: 100%; }
    .ec-sym-box { display: flex; align-items: center; gap: 25px; }
    .ec-sym { font-size: 3.8rem; font-weight: 900; color: #fff; line-height: 1; min-width: 80px; text-align: center; text-shadow: 0 0 10px rgba(255,255,255,0.5), 0 0 30px rgba(255,255,255,0.2); }
    .ec-info { display: flex; flex-direction: column; gap: 2px; }
    .ec-name { font-size: 0.95rem; font-weight: bold; color: #fff; }
    .ec-meta { font-size: 0.75rem; color: #94a3b8; font-family: 'Noto Serif TC', serif; }
    .ec-tag { font-size: 0.75rem; color: #a78bfa; font-weight: 500; background: rgba(139, 92, 246, 0.15); padding: 2px 6px; border-radius: 4px; border: 1px solid rgba(139, 92, 246, 0.3); width: fit-content; }
    .ec-config-row { width: 100%; display: flex; justify-content: flex-end; background: rgba(0,0,0,0.3); padding: 6px 10px; border-radius: 6px; }
    .ec-config { font-family: 'Noto Serif TC', serif; color: #a5f3fc; font-weight: bold; font-size: 1.1rem; letter-spacing: -0.5px; word-spacing: -2px; white-space: nowrap; }
    .ec-config sup { color: var(--accent-yellow); font-size: 0.75em; vertical-align: super; }
    /* [ä¿®æ”¹] é–‹å•Ÿæ°´å¹³æ²è»¸ä¸¦ç¾åŒ–æ¨£å¼ */
    .ec-scroll { 
        width: 100%; 
        overflow-x: auto; /* å…è¨±æ©«å‘æ²å‹• */
        padding-top: 5px; 
        padding-bottom: 8px; /* å¢åŠ åº•éƒ¨ç©ºé–“çµ¦æ²è»¸ */
        border-top: 1px solid rgba(255,255,255,0.05); 
        scrollbar-width: thin; /* Firefox: ç´°æ²è»¸ */
        scrollbar-color: #475569 #0f172a; /* Firefox: é¡è‰² */
    }
    
    /* Chrome/Edge/Safari æ²è»¸æ¨£å¼ */
    .ec-scroll::-webkit-scrollbar { height: 6px; display: block; } /* è¨­å®šé«˜åº¦ä¸¦é¡¯ç¤º */
    .ec-scroll::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); border-radius: 3px; }
    .ec-scroll::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
    .ec-scroll::-webkit-scrollbar-thumb:hover { background: var(--accent-yellow); } /* æ»‘é¼ ç§»éå»è®Šäº® */

    .ec-row { display: flex; gap: 8px; width: max-content; padding-right: 10px; }
    .ec-sub { display: flex; flex-direction: column; align-items: center; background: rgba(255,255,255,0.03); padding: 6px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.05); }
    .ec-boxes { display: flex; gap: 2px; }
    .ec-box { width: 32px; height: 32px; border: 1px solid #555; background: #000; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; color: #facc15; font-weight: bold; }
    .ec-label { margin-top: 4px; font-size: 0.75rem; color: #64748b; font-family: 'Noto Serif TC', serif; }

    /* ========== [æ–°å¢] é›¢å­æŒ‰éˆ•äº’å‹•æ¨£å¼ ========== */
    .ion-btn {
    opacity: 0.8;
    border-width: 1px !important;
    font-weight: normal;
}

.ion-btn:active {
    opacity: 0.6; 
}

.ion-btn.active {
    opacity: 1;
    font-weight: bold;
    border-width: 2px !important;
    z-index: 2;
}

.ion-btn.active[data-type="neutral"] { background: #f1f5f9 !important; color: #000 !important; border-color: #fff !important; }
.ion-btn.active[data-type="pos"]     { background: #fca5a5 !important; color: #000 !important; border-color: #fca5a5 !important; }
.ion-btn.active[data-type="neg"]     { background: #93c5fd !important; color: #000 !important; border-color: #93c5fd !important; }


/* --- [æ–°å¢] å…±æŒ¯çµæ§‹ä¸»é¡Œ (ç´«è‰²ç³») --- */
#variant-selector.resonance-theme { 
    background: rgba(139, 92, 246, 0.05); 
    border: 1px solid rgba(139, 92, 246, 0.3); 
}
#variant-selector.resonance-theme .variant-header { 
    color: #a78bfa; /* æ·ºç´«è‰² */
}
#variant-selector.resonance-theme .variant-option { 
    color: #a78bfa; 
}
#variant-selector.resonance-theme .variant-option:hover { 
    background: rgba(139, 92, 246, 0.15); 
    color: #fff;
}
#variant-selector.resonance-theme input[type="radio"] {
    accent-color: #8b5cf6; /* ç´«è‰²é¸æ¡† */
}

/* --- [æ–°å¢] çµæ§‹/æ™¶é«”åˆ‡æ›ä¸»é¡Œ (è—è‰²ç³») --- */
#variant-selector.structure-theme { 
    background: rgba(56, 189, 248, 0.05); /* å¤©è—è‰²èƒŒæ™¯ */
    border: 1px solid rgba(56, 189, 248, 0.3); 
}
#variant-selector.structure-theme .variant-header { 
    color: var(--accent-yellow); /* was å¤©è—è‰²æ–‡å­— */
}
#variant-selector.structure-theme .variant-option { 
    color: var(--accent-yellow);
}
#variant-selector.structure-theme .variant-option:hover { 
    background: rgba(56, 189, 248, 0.15); 
    color: #fff;
}
#variant-selector.structure-theme input[type="radio"] {
    accent-color: var(--accent-yellow); /* was è—è‰²é¸æ¡† */
}


/* Orbital-related styles removed (orbital UI was deleted). */

/* æ‰‹æ©Ÿç‰ˆç‰¹åˆ¥å„ªåŒ–ï¼šä½ç½®æ›´ç·Šæ¹Š */
@media (max-width: 768px) {}

@keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

.creator-credit {
    position: fixed;
    left: 20px;
    bottom: 18px;
    z-index: 60;
    color: #ffffff;
    font-weight: 700;
    font-size: 13px;
    text-shadow: 0 0 8px rgba(56,189,248,0.2);
    background: rgba(0,0,0,0.25);
    padding: 6px 10px;
    border-radius: 8px;
    pointer-events: none;
}
@media (max-width: 768px) {
    .creator-credit { display: none; }
}


</style>
</head>
<body>

<div class="app-container">
    <!-- Global header: persistent app switch (moves the title dropdown out of individual viewports) -->
    <div class="global-header" style="position:absolute;top:20px;left:25px;z-index:70;pointer-events:auto;">
        <div class="app-switch-root">
            <button id="title-switch-btn" class="title-btn" aria-haspopup="true" aria-expanded="false">
                <span class="app-switch-label">ChemScope</span>
                <span class="app-switch-arrow">&gt;</span>
            </button>
            <div class="app-switch-menu" id="titleSwitchMenu" role="menu" aria-hidden="true">
                <button class="control-button app-switch-item" data-tool="ChemScope" role="menuitem">ChemScope</button>
                <button class="control-button app-switch-item" data-tool="Elements" role="menuitem">Elements</button>
                <button class="control-button app-switch-item" data-tool="EquationBalancer" role="menuitem">Equation Balancer</button>
            </div>
        </div>
    </div>
    <div class="viewport-area viewport-panel active" id="viewport" data-tool="ChemScope">
        <!-- æ¨™é¡Œèˆ‡è³‡è¨Šé¡¯ç¤ºå€ -->
        <div class="viewport-header">
            <h1 class="title">ChemScope</h1>
            
            <div class="molecule-display-info" id="molecule-display-info">
                <div class="info-formula" id="info-formula"></div>
                <div class="info-name" id="info-name"></div>
            </div>

            <!-- çŒœä½ æƒ³çœ‹åŠŸèƒ½ -->
            <span class="input-note" id="viewport-subtitle"></span>
        </div>
        
        <div class="controls-container">
            <button id="mode-toggle" class="control-button active">æ¨¡å¼: è¤‡åˆ</button>
            <button id="lang-toggle" class="control-button" title="åˆ‡æ›èªè¨€">EN</button>
        </div>

        <script>
            (function(){
                const root = document.querySelector('.app-switch-root');
                const btn = document.getElementById('title-switch-btn');
                const menu = document.getElementById('titleSwitchMenu');
                if(!btn || !menu || !root) return;

                function openMenu(){ root.classList.add('open'); btn.setAttribute('aria-expanded','true'); menu.setAttribute('aria-hidden','false'); }
                function closeMenu(){ root.classList.remove('open'); btn.setAttribute('aria-expanded','false'); menu.setAttribute('aria-hidden','true'); }
                function toggleMenu(){ root.classList.contains('open') ? closeMenu() : openMenu(); }

                btn.addEventListener('click', (e)=>{ e.stopPropagation(); toggleMenu(); btn.focus(); });
                btn.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleMenu(); } else if(e.key === 'Escape') closeMenu(); });

                function switchTool(toolName){
                    // hide all control/tool panels, show target control panel
                    document.querySelectorAll('.tool-panel').forEach(p=>{ p.classList.remove('active'); p.style.display = 'none'; });
                    const controlTarget = document.querySelector(`.tool-panel[data-tool="${toolName}"]`);
                    if(controlTarget){ controlTarget.classList.add('active'); controlTarget.style.display = ''; }

                    // hide all viewport panels and show the one for selected tool
                    document.querySelectorAll('.viewport-panel').forEach(v=>{ v.classList.remove('active'); v.style.display = 'none'; });
                    const viewTarget = document.querySelector(`.viewport-panel[data-tool="${toolName}"]`);
                    if(viewTarget){ viewTarget.classList.add('active'); viewTarget.style.display = ''; }

                    // mark menu active
                    menu.querySelectorAll('.app-switch-item').forEach(b=> b.classList.toggle('active', b.dataset.tool === toolName));

                    // update title label if needed
                    const label = root.querySelector('.app-switch-label');
                    if(label && toolName) label.textContent = toolName === 'ChemScope' ? 'ChemScope' : toolName;
                }

                menu.addEventListener('click', (e)=>{
                    const t = e.target.closest('.app-switch-item'); if(!t) return; const tool = t.dataset.tool; if(!tool) return; e.stopPropagation(); closeMenu(); switchTool(tool);
                });

                // close on outside click or Escape
                document.addEventListener('click', (e)=>{ if(!root.contains(e.target)) closeMenu(); });
                document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMenu(); });

                // initialize default tool
                switchTool('ChemScope');
            })();
        </script>

        <svg id="molecule-svg" viewBox="-400 -300 800 600" preserveAspectRatio="xMidYMid slice">
            <defs>
                <filter id="soft-glow" x="-300%" y="-300%" width="700%" height="700%" filterUnits="objectBoundingBox" color-interpolation-filters="sRGB">
                    <feGaussianBlur in="SourceGraphic" stdDeviation="3.5" />
                </filter>
            </defs>
            <g id="scene-root"></g>
        </svg>
        <div id="hybrid-label" class="hybrid-tooltip"></div>
    </div>

    <!-- Elements viewport panel (single-page) -->
    <div class="viewport-area viewport-panel" data-tool="Elements" style="display:none">
        <div class="viewport-header">
            <h1 class="title">Elements</h1>
            <div class="molecule-display-info" id="elements-display-info">
                <div class="info-formula">--</div>
                <div class="info-name">Elements Browser</div>
            </div>
        </div>
    </div>

    <!-- Equation Balancer viewport panel (single-page) -->
    <div class="viewport-area viewport-panel" data-tool="EquationBalancer" style="display:none">
        <div class="viewport-header">
            <h1 class="title">Equation Balancer</h1>
            <div class="molecule-display-info" id="eqbal-display-info">
                <div class="info-formula">--</div>
                <div class="info-name">Balance equations</div>
            </div>
        </div>
    </div>
    <div id="config-modal">
        <div class="config-panel">
            <div class="config-header">
                <button class="config-close" onclick="closeConfigModal()">âœ•</button>
                <input type="text" class="config-search" id="configSearchInput" placeholder="æœå°‹å…ƒç´  (Ex: Fe, 26, Carbon)..." onkeyup="renderConfigList()">
            </div>
            <div class="config-list" id="configListContainer"></div>
        </div>
    </div>

    <div class="controls-area" id="controls-panel">
        <div id="mobile-panel-handle"><div class="handle-bar"></div></div>
        
        <div class="controls-content">
            <div class="tool-panel active" data-tool="ChemScope" style="display:block">
            <!-- 1. æ ¸å¿ƒè¼¸å…¥ -->
            <div class="card">
                <div class="card-title large-title" style="display: flex; justify-content: space-between; align-items: center;">
                    <span id="card-title-input">Input Formula</span>
                </div>
                <div class="input-group">
                    <input type="text" id="formula-input" placeholder="eg: H2O, SO4 2-, C60, ..." value="H2O">
                    <button id="load-btn" style="background: var(--accent-yellow) !important; color: #000 !important; border: 1px solid rgba(0,0,0,0.08) !important;">è¼‰å…¥</button>
                </div>
                <!-- Inline switches placed under the input, in the same card -->
                <div class="switch-row">
                    <label class="switch-item">
                        <input type="checkbox" id="toggle-lp" class="switch-input" checked>
                        <span class="slider"></span>
                        <span class="switch-label" id="lbl-lp">é¡¯ç¤ºå­¤å°é›»å­</span>
                    </label>
                    <label class="switch-item">
                        <input type="checkbox" id="toggle-auto-rotate" class="switch-input" checked>
                        <span class="slider"></span>
                        <span class="switch-label" id="lbl-auto-rotate">è‡ªå‹•æ—‹è½‰</span>
                    </label>
                </div>
            </div>

            <!-- 3. ğŸ› ï¸ å…¶ä»–æ“´å……åŠŸèƒ½ (å·²ç§»é™¤) -->
            <!-- å·²å¾æ­¤æª”ç§»é™¤ã€Œå…¶ä»–æ“´å……åŠŸèƒ½ã€é¢æ¿åŠå…¶å…§å»ºå­åŠŸèƒ½ã€‚è‹¥éœ€é‚„åŸï¼Œè«‹å¾åŸå§‹å‚™ä»½é‚„åŸè©²å€å¡Šã€‚ -->

            <!-- 4. ğŸŸ¢ ç•°æ§‹ç‰©é¸æ“‡å€ (ç¢ºä¿åœ¨åŠŸèƒ½é¢æ¿ä¸‹æ–¹) -->
            <div id="variant-selector"></div>

            <!-- 5. ğŸ§ª åæ‡‰æŒ‰éˆ•å€ (å·²ç§»é™¤) -->
            <!-- Reaction buttons removed per user request -->

            <!-- 6. å°ç™¾ç§‘ -->
            <!-- å°çŸ¥è­˜å¡ç‰‡å·²ç§»é™¤ -->
            
            
            <div class="card" id="data-card">
                <div class="card-title large-title" id="data-card-title">Substance Data</div>
                <div class="data-row"><span class="data-label" id="lbl-formula">åŒ–å­¸å¼</span><span class="data-value" id="disp-formula"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-name">ä¸­æ–‡åç¨±</span><span class="data-value" id="disp-center"></span></div>
                <!-- æ··æˆè»ŒåŸŸ å·²ç§»é™¤ -->
                <div class="data-row"><span class="data-label" id="lbl-shape">å½¢ç‹€</span><span class="data-value" id="disp-shape"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-angle">éµè§’</span><span class="data-value" id="disp-angle"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-mp">ç†”é» (MP)</span><span class="data-value" id="disp-mp"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-bp">æ²¸é» (BP)</span><span class="data-value" id="disp-bp"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-bonds">éµçµçµ±è¨ˆ</span><span class="data-value" id="disp-bonds"></span></div>
                <div class="data-row"><span class="data-label" id="lbl-mass">åˆ†å­é‡</span><span class="data-value" id="disp-mass"></span></div>
            </div>
            <div class="spacer-60"></div>
            </div>

            <div class="tool-panel" data-tool="Elements" style="display:none">
                <div class="card"><div class="card-title">Elements</div><div class="card">Elements control panel placeholder (periodic table controls).</div></div>
            </div>

            <div class="tool-panel" data-tool="EquationBalancer" style="display:none">
                <div class="card"><div class="card-title">Equation Balancer</div><div class="card">Equation Balancer control panel placeholder (input equation / options).</div></div>
            </div>

        </div>
    </div>
</div>

<!-- [ä¿®æ­£ç‰ˆ] éš±è—çš„æµé‡è¨ˆæ•¸å™¨ (ä½¿ç”¨ Hits.sh) -->
<!-- ID å·²ä¿®æ­£ç‚ºç¶²åŸŸæ ¼å¼ä»¥ç¬¦åˆæœå‹™è¦æ±‚: weiwei-molecular-lab.app -->
<div style="display:none;">
    <img id="site_counter_img" 
         src="https://hits.sh/weiwei-molecular-lab.app.svg?label=Views&color=10b981&labelColor=2d3748" 
         alt="Page Views">
</div>

<div class="creator-credit">F6S 22 35</div>

<!-- â˜…â˜…â˜… è«‹åœ¨ä¸­é–“æ’å…¥ä»¥ä¸‹ä»£ç¢¼ (Modal è¦–çª—) â˜…â˜…â˜… -->

<script>
/*
 ==========================================================================
 â˜… è¦–è¦ºéµé•·æ¨™æº–åƒè€ƒè¡¨ (Visual Bond Length Standards) v16.2
 ==========================================================================
 åŸºæº–ï¼šä»¥ 1,2-äºŒæ°¯ä¸™çƒ·ç‚ºéŒ¨é» (C-C ~ 70, C-H ~ 50, C-Cl ~ 75)
 
 [1] åŸå­è¦–è¦ºåŠå¾‘è²¢ç» (Base Radius Contribution)
 --------------------------------------------------------------------------
  - H (æ°«) .................... 15  (æœ€å°ï¼Œç¢ºä¿ç·Šæ¹Š)
  - Row 2 (C, N, O, F) ........ 35  (åŸºæº–)
  - Row 3 (Si, P, S, Cl) ...... 40  (ç•¥å¤§)
  - Row 4 (Br) ................ 45
  - Row 5 (I, Xe) ............. 50  (æœ€å¤§)

 [2] éµç´šä¿®æ­£ä¿‚æ•¸ (Bond Order Multiplier)
 --------------------------------------------------------------------------
  - å–®éµ (Single) ............. x 1.00
  - é›™éµ (Double) ............. x 0.90
  - åƒéµ (Triple) ............. x 0.85

 [3] å¸¸è¦‹éµé•·è¨ˆç®—ç¯„ä¾‹ (Calculated Examples)
 --------------------------------------------------------------------------
  Type      Calc (R1 + R2) * Multiplier      Final Value
  -------   ---------------------------      -----------
  H-H       (15 + 15) * 1.0                  30
  C-H       (35 + 15) * 1.0                  50  (åŸºæº–)
  N-H       (35 + 15) * 1.0                  50
  O-H       (35 + 15) * 1.0                  50
  P-H       (40 + 15) * 1.0                  55

  C-C       (35 + 35) * 1.0                  70  (åŸºæº–)
  C=C       (35 + 35) * 0.9                  63
  Câ‰¡C       (35 + 35) * 0.85                 60
  
  C-O       (35 + 35) * 1.0                  70
  C=O       (35 + 35) * 0.9                  63

  S-O       (40 + 35) * 1.0                  75
  S=O       (40 + 35) * 0.9                  68  (SO4, SO3)
  
  P-Cl      (40 + 40) * 1.0                  80  (PCl3)
  Xe=O      (50 + 35) * 0.9                  76  (XeO3)
  
  F-F       (35 + 35) * 1.0                  70
  Cl-Cl     (40 + 40) * 1.0                  80
  I-I       (50 + 50) * 1.0                  100
 ==========================================================================
*/


const ELEMENT_PROPS = {
    // --- ç¬¬ 1 é€±æœŸ ---
    "H":  { ve: 1, c3d: "#F0F0F0", r3d: 12, lp: 0, mass: 1.008, en: 2.20 }, // [ä¿ç•™] ç™½ç°
    "He": { ve: 2, c3d: "#A5F3FC", r3d: 11, lp: 1, mass: 4.002, en: 0 },    // [ä¿ç•™] æ·¡é’

    // --- ç¬¬ 2 é€±æœŸ (åŠå¾‘æ¼¸å°: Li > Be > B > C > N > O > F) ---
    "Li": { ve: 1, c3d: "#E879F9", r3d: 26, lp: 0, mass: 6.94, en: 0.98 },  // [ä¿ç•™] ç²‰ç´«
    "Be": { ve: 2, c3d: "#C2F970", r3d: 22, lp: 0, mass: 9.012, en: 1.57 }, // [ä¿ç•™] èŠå§†ç¶ 
    "B":  { ve: 3, c3d: "#FDBA74", r3d: 20, lp: 0, mass: 10.81, en: 2.04 }, // [ä¿ç•™] èœœæ¡ƒæ©˜ (æ‚¨å–œæ­¡çš„é¡è‰²)
    "C":  { ve: 4, c3d: "#94A3B8", r3d: 19, lp: 0, mass: 12.011, en: 2.55 },// [ä¿ç•™] è—ç°
    "N":  { ve: 5, c3d: "#3B82F6", r3d: 18, lp: 1, mass: 14.007, en: 3.04 },// [ä¿ç•™] äº®è—
    "O":  { ve: 6, c3d: "#EF4444", r3d: 17, lp: 2, mass: 15.999, en: 3.44 },// [ä¿ç•™] ç´…
    "F":  { ve: 7, c3d: "#90E050", r3d: 16, lp: 3, mass: 18.998, en: 3.98 },// [ä¿ç•™] é®®ç¶ 
    "Ne": { ve: 8, c3d: "#67E8F9", r3d: 15, lp: 4, mass: 20.180, en: 0 },   // [ä¿ç•™] é’

    // --- ç¬¬ 3 é€±æœŸ (åŠå¾‘æ¼¸å°: Na > Mg > Al > Si > P > S > Cl) ---
    "Na": { ve: 1, c3d: "#C084FC", r3d: 30, lp: 0, mass: 22.990, en: 0.93 },// [ä¿ç•™] ç´«
    "Mg": { ve: 2, c3d: "#10B981", r3d: 26, lp: 0, mass: 24.305, en: 1.31 },// [ä¿ç•™] ç¿¡ç¿ ç¶ 
    "Al": { ve: 3, c3d: "#E2E8F0", r3d: 24, lp: 0, mass: 26.982, en: 1.61 },// [ä¿ç•™] æ·ºç°
    "Si": { ve: 4, c3d: "#CBD5E1", r3d: 22, lp: 0, mass: 28.085, en: 1.90 },// [ä¿ç•™] ç°
    "P":  { ve: 5, c3d: "#F97316", r3d: 21, lp: 0, mass: 30.974, en: 2.19 },// [ä¿ç•™] æ©˜
    "S":  { ve: 6, c3d: "#FACC15", r3d: 20, lp: 0, mass: 32.06, en: 2.58 }, // [ä¿ç•™] é»ƒ
    "Cl": { ve: 7, c3d: "#22C55E", r3d: 19, lp: 3, mass: 35.45, en: 3.16 }, // [ä¿ç•™] æ·±ç¶  (æ¯”Fæ·±ï¼Œç¬¦åˆè¦–è¦ºé‚è¼¯)
    "Ar": { ve: 8, c3d: "#38BDF8", r3d: 18, lp: 4, mass: 39.948, en: 0 },   // [ä¿ç•™] å¤©è—

    // --- ç¬¬ 4 é€±æœŸ (K > Ca > Sc ... > Br) ---
    "K":  { ve: 1, c3d: "#8B5CF6", r3d: 36, lp: 0, mass: 39.098, en: 0.82 },// [ä¿ç•™] é›ç´«
    "Ca": { ve: 2, c3d: "#4ADE80", r3d: 32, lp: 0, mass: 40.078, en: 1.00 },// [ä¿ç•™] æ·ºç¶ 
    "Sc": { ve: 3, c3d: "#E6E6E6", r3d: 28, lp: 0, mass: 44.96, en: 1.36 }, // [æ–°å¢] CPK éŠ€ç™½
    "Ti": { ve: 4, c3d: "#BFC2C7", r3d: 26, lp: 0, mass: 47.87, en: 1.54 }, // [æ–°å¢] CPK éˆ¦ç°
    "V":  { ve: 5, c3d: "#A6A6AB", r3d: 25, lp: 0, mass: 50.94, en: 1.63 }, // [æ–°å¢] ç°
    "Cr": { ve: 6, c3d: "#94A3B8", r3d: 24, lp: 0, mass: 51.996, en: 1.66 },// [ä¿ç•™] é‰»ç°
    "Mn": { ve: 7, c3d: "#D946EF", r3d: 24, lp: 0, mass: 54.938, en: 1.55 },// [ä¿ç•™] ç´«ç´… (å¾ˆé©åˆMn)
    "Fe": { ve: 8, c3d: "#EA580C", r3d: 24, lp: 0, mass: 55.845, en: 1.83 },// [ä¿ç•™] éµé½æ©˜
    "Co": { ve: 9, c3d: "#F472B6", r3d: 23, lp: 0, mass: 58.93, en: 1.88 }, // [æ–°å¢] CPK ç²‰ç´… (éˆ·)
    "Ni": { ve: 10, c3d: "#50D050", r3d: 23, lp: 0, mass: 58.69, en: 1.91 },// [æ–°å¢] CPK ç¶  (é³)
    "Cu": { ve: 11, c3d: "#D97706", r3d: 23, lp: 0, mass: 63.546, en: 1.90 },// [ä¿ç•™] éŠ…è‰²
    "Zn": { ve: 12, c3d: "#78716C", r3d: 23, lp: 0, mass: 65.38, en: 1.65 },// [ä¿ç•™] é‹…ç°
    "Ga": { ve: 3, c3d: "#C28F8F", r3d: 23, lp: 0, mass: 69.72, en: 1.81 }, // [æ–°å¢] ç´…è¤
    "Ge": { ve: 4, c3d: "#668F8F", r3d: 23, lp: 0, mass: 72.63, en: 2.01 }, // [æ–°å¢] ç°ç¶ 
    "As": { ve: 5, c3d: "#BD80E3", r3d: 22, lp: 0, mass: 74.92, en: 2.18 }, // [ä¿®æ­£] ç´«è‰² (å€åˆ† Na)
    "Se": { ve: 6, c3d: "#FFA100", r3d: 22, lp: 0, mass: 78.96, en: 2.55 }, // [ä¿®æ­£] æ·±æ©˜ (å€åˆ† P)
    "Br": { ve: 7, c3d: "#B91C1C", r3d: 21, lp: 3, mass: 79.904, en: 2.96 },// [ä¿ç•™] æ·±ç´…
    "Kr": { ve: 8, c3d: "#5CB8D1", r3d: 20, lp: 4, mass: 83.80, en: 3.00 }, // [æ–°å¢] é’

    // --- å…¶ä»–å¸¸ç”¨å…ƒç´  (ç¬¬ 5, 6 é€±æœŸ) ---
    "Rb": { ve: 1, c3d: "#702EB0", r3d: 38, lp: 0, mass: 85.47, en: 0.82 }, // CPK ç´«
    "Sr": { ve: 2, c3d: "#00FF00", r3d: 34, lp: 0, mass: 87.62, en: 0.95 }, // CPK ç¶ 
    "Ag": { ve: 11, c3d: "#F1F5F9", r3d: 25, lp: 0, mass: 107.87, en: 1.93 },// [ä¿ç•™] éŠ€ç™½
    "Sn": { ve: 4, c3d: "#668080", r3d: 25, lp: 0, mass: 118.7, en: 1.96 }, // ç°
    "Sb": { ve: 5, c3d: "#A855F7", r3d: 25, lp: 0, mass: 121.76, en: 2.05 },// [ä¿ç•™] ç´«
    "Te": { ve: 6, c3d: "#EA580C", r3d: 25, lp: 0, mass: 127.60, en: 2.10 },// [ä¿ç•™] æ©˜è¤
    "I":  { ve: 7, c3d: "#A855F7", r3d: 24, lp: 3, mass: 126.90, en: 2.66 },// [ä¿ç•™] ç´«
    "Xe": { ve: 8, c3d: "#818CF8", r3d: 24, lp: 3, mass: 131.29, en: 2.60 },// [ä¿ç•™] è—ç´«
    "Cs": { ve: 1, c3d: "#57178F", r3d: 42, lp: 0, mass: 132.9, en: 0.79 }, // CPK æ·±ç´«
    "Ba": { ve: 2, c3d: "#00C900", r3d: 38, lp: 0, mass: 137.3, en: 0.89 }, // CPK æ·±ç¶ 
    "Pt": { ve: 10, c3d: "#D0D0E0", r3d: 25, lp: 0, mass: 195.1, en: 2.28 },// é‰‘
    "Au": { ve: 11, c3d: "#F59E0B", r3d: 25, lp: 0, mass: 196.97, en: 2.54 },// [ä¿ç•™] é‡‘é»ƒ
    "Hg": { ve: 12, c3d: "#B8B8D0", r3d: 24, lp: 0, mass: 200.6, en: 2.00 },// æ±
    "Pb": { ve: 4, c3d: "#575961", r3d: 26, lp: 0, mass: 207.2, en: 2.33 }, // é‰›

    // --- [è£œé½Š] é‡‘å±¬èˆ‡æ”¾å°„æ€§å…ƒç´  (æ»¿è¶³æ™¶é«”çµæ§‹éœ€æ±‚) ---
    "Po": { ve: 6, c3d: "#AB5C00", r3d: 26, lp: 0, mass: 209, en: 2.0 },    // [æ–°å¢] é‡™ (é‡‘å±¬) - æ·±æ©˜è¤
    "Fr": { ve: 1, c3d: "#420066", r3d: 44, lp: 0, mass: 223, en: 0.7 },    // [æ–°å¢] é… (1A) - æ¥µæ·±ç´«
    "Ra": { ve: 2, c3d: "#006400", r3d: 40, lp: 0, mass: 226, en: 0.9 },    // [æ–°å¢] é³ (2A) - æ·±ç¶ 
// --- é›»å­è»ŒåŸŸå°ˆç”¨æè³ª (ç„¡æ–‡å­—ç‰ˆ) ---
    // æŠ€å·§ï¼šä½¿ç”¨ä¸åŒæ•¸é‡çš„ç©ºç™½éµä½œç‚º IDï¼Œé€™æ¨£ç•«é¢ä¸Šå°±ä¸æœƒæœ‰æ–‡å­—ï¼Œä½†èƒ½å€åˆ†é¡è‰²
    " ":      { ve: 0, c3d: "#3B82F6", r3d: 0 }, // s (è—)
    "  ":     { ve: 0, c3d: "#10B981", r3d: 0 }, // p (å‚™ç”¨)
    "   ":    { ve: 0, c3d: "#F59E0B", r3d: 0 }, // d (æ©˜)
    
    // --- åº§æ¨™è»¸ç³»çµ± ---
    "Origin": { ve: 0, c3d: "#000000", r3d: 0,    lp: 0, mass: 0, en: 0 }, // éš±è—åŸé»
    "Axis":   { ve: 0, c3d: "#444444", r3d: 1.0,  lp: 0, mass: 0, en: 0 }, // æ¥µç´°æ·±ç°è»¸
    "X":      { ve: 0, c3d: "#EF4444", r3d: 0,    lp: 0, mass: 0, en: 0 }, // ç´…è‰² X
    "Y":      { ve: 0, c3d: "#22C55E", r3d: 0,    lp: 0, mass: 0, en: 0 }, // ç¶ è‰² Y
    "Z":      { ve: 0, c3d: "#3B82F6", r3d: 0,    lp: 0, mass: 0, en: 0 }  // è—è‰² Z
};

// ========== [è«‹æ’å…¥é€™æ®µ JS] é›»å­çµ„æ…‹é‚è¼¯ ==========
    const ELECTRON_DATA = [
    // Period 1
    { z: 1, s: "H", n: "Hydrogen", cn: "æ°«", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-259Â°C", bp: "-253Â°C", p: 1, g: "1A", iupac: 1, c: "1s1", noble: "1s1" },
    { z: 2, s: "He", n: "Helium", cn: "æ°¦", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-272Â°C", bp: "-269Â°C", p: 1, g: "8A", iupac: 18, c: "1s2", noble: "1s2" },
    // Period 2
    { z: 3, s: "Li", n: "Lithium", cn: "é‹°", type: "é‡‘å±¬", state: "å›ºé«”", mp: "180Â°C", bp: "1342Â°C", p: 2, g: "1A", iupac: 1, c: "1s2 2s1", noble: "[He] 2s1" },
    { z: 4, s: "Be", n: "Beryllium", cn: "éˆ¹", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1287Â°C", bp: "2469Â°C", p: 2, g: "2A", iupac: 2, c: "1s2 2s2", noble: "[He] 2s2" },
    { z: 5, s: "B", n: "Boron", cn: "ç¡¼", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "2076Â°C", bp: "3927Â°C", p: 2, g: "3A", iupac: 13, c: "1s2 2s2 2p1", noble: "[He] 2s2 2p1" },
    { z: 6, s: "C", n: "Carbon", cn: "ç¢³", type: "éé‡‘å±¬", state: "å›ºé«”", mp: "3550Â°C", bp: "4027Â°C", p: 2, g: "4A", iupac: 14, c: "1s2 2s2 2p2", noble: "[He] 2s2 2p2" },
    { z: 7, s: "N", n: "Nitrogen", cn: "æ°®", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-210Â°C", bp: "-196Â°C", p: 2, g: "5A", iupac: 15, c: "1s2 2s2 2p3", noble: "[He] 2s2 2p3" },
    { z: 8, s: "O", n: "Oxygen", cn: "æ°§", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-218Â°C", bp: "-183Â°C", p: 2, g: "6A", iupac: 16, c: "1s2 2s2 2p4", noble: "[He] 2s2 2p4" },
    { z: 9, s: "F", n: "Fluorine", cn: "æ°Ÿ", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-220Â°C", bp: "-188Â°C", p: 2, g: "7A", iupac: 17, c: "1s2 2s2 2p5", noble: "[He] 2s2 2p5" },
    { z: 10, s: "Ne", n: "Neon", cn: "æ°–", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-249Â°C", bp: "-246Â°C", p: 2, g: "8A", iupac: 18, c: "1s2 2s2 2p6", noble: "[He] 2s2 2p6" },
    // Period 3
    { z: 11, s: "Na", n: "Sodium", cn: "éˆ‰", type: "é‡‘å±¬", state: "å›ºé«”", mp: "98Â°C", bp: "883Â°C", p: 3, g: "1A", iupac: 1, c: "1s2 2s2 2p6 3s1", noble: "[Ne] 3s1" },
    { z: 12, s: "Mg", n: "Magnesium", cn: "é‚", type: "é‡‘å±¬", state: "å›ºé«”", mp: "650Â°C", bp: "1090Â°C", p: 3, g: "2A", iupac: 2, c: "1s2 2s2 2p6 3s2", noble: "[Ne] 3s2" },
    { z: 13, s: "Al", n: "Aluminium", cn: "é‹", type: "é‡‘å±¬", state: "å›ºé«”", mp: "660Â°C", bp: "2519Â°C", p: 3, g: "3A", iupac: 13, c: "1s2 2s2 2p6 3s2 3p1", noble: "[Ne] 3s2 3p1" },
    { z: 14, s: "Si", n: "Silicon", cn: "çŸ½", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "1414Â°C", bp: "3265Â°C", p: 3, g: "4A", iupac: 14, c: "1s2 2s2 2p6 3s2 3p2", noble: "[Ne] 3s2 3p2" },
    { z: 15, s: "P", n: "Phosphorus", cn: "ç£·", type: "éé‡‘å±¬", state: "å›ºé«”", mp: "44Â°C", bp: "280Â°C", p: 3, g: "5A", iupac: 15, c: "1s2 2s2 2p6 3s2 3p3", noble: "[Ne] 3s2 3p3" },
    { z: 16, s: "S", n: "Sulfur", cn: "ç¡«", type: "éé‡‘å±¬", state: "å›ºé«”", mp: "115Â°C", bp: "445Â°C", p: 3, g: "6A", iupac: 16, c: "1s2 2s2 2p6 3s2 3p4", noble: "[Ne] 3s2 3p4" },
    { z: 17, s: "Cl", n: "Chlorine", cn: "æ°¯", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-101Â°C", bp: "-34Â°C", p: 3, g: "7A", iupac: 17, c: "1s2 2s2 2p6 3s2 3p5", noble: "[Ne] 3s2 3p5" },
    { z: 18, s: "Ar", n: "Argon", cn: "æ°¬", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-189Â°C", bp: "-186Â°C", p: 3, g: "8A", iupac: 18, c: "1s2 2s2 2p6 3s2 3p6", noble: "[Ne] 3s2 3p6" },
    // Period 4
    { z: 19, s: "K", n: "Potassium", cn: "é‰€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "63Â°C", bp: "759Â°C", p: 4, g: "1A", iupac: 1, c: "1s2 2s2 2p6 3s2 3p6 4s1", noble: "[Ar] 4s1" },
    { z: 20, s: "Ca", n: "Calcium", cn: "éˆ£", type: "é‡‘å±¬", state: "å›ºé«”", mp: "842Â°C", bp: "1484Â°C", p: 4, g: "2A", iupac: 2, c: "1s2 2s2 2p6 3s2 3p6 4s2", noble: "[Ar] 4s2" },
    { z: 21, s: "Sc", n: "Scandium", cn: "éˆ§", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1541Â°C", bp: "2836Â°C", p: 4, g: "3B", iupac: 3, c: "1s2 2s2 2p6 3s2 3p6 3d1 4s2", noble: "[Ar] 3d1 4s2" },
    { z: 22, s: "Ti", n: "Titanium", cn: "éˆ¦", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1668Â°C", bp: "3287Â°C", p: 4, g: "4B", iupac: 4, c: "1s2 2s2 2p6 3s2 3p6 3d2 4s2", noble: "[Ar] 3d2 4s2" },
    { z: 23, s: "V", n: "Vanadium", cn: "é‡©", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1910Â°C", bp: "3407Â°C", p: 4, g: "5B", iupac: 5, c: "1s2 2s2 2p6 3s2 3p6 3d3 4s2", noble: "[Ar] 3d3 4s2" },
    { z: 24, s: "Cr", n: "Chromium", cn: "é‰»", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1907Â°C", bp: "2671Â°C", p: 4, g: "6B", iupac: 6, c: "1s2 2s2 2p6 3s2 3p6 3d5 4s1", noble: "[Ar] 3d5 4s1", ex: true },    
    { z: 25, s: "Mn", n: "Manganese", cn: "éŒ³", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1246Â°C", bp: "2061Â°C", p: 4, g: "7B", iupac: 7, c: "1s2 2s2 2p6 3s2 3p6 3d5 4s2", noble: "[Ar] 3d5 4s2" },
    { z: 26, s: "Fe", n: "Iron", cn: "éµ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1538Â°C", bp: "2861Â°C", p: 4, g: "8B", iupac: 8, c: "1s2 2s2 2p6 3s2 3p6 3d6 4s2", noble: "[Ar] 3d6 4s2" },
    { z: 27, s: "Co", n: "Cobalt", cn: "éˆ·", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1495Â°C", bp: "2927Â°C", p: 4, g: "8B", iupac: 9, c: "1s2 2s2 2p6 3s2 3p6 3d7 4s2", noble: "[Ar] 3d7 4s2" },
    { z: 28, s: "Ni", n: "Nickel", cn: "é³", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1455Â°C", bp: "2730Â°C", p: 4, g: "8B", iupac: 10, c: "1s2 2s2 2p6 3s2 3p6 3d8 4s2", noble: "[Ar] 3d8 4s2" },
    { z: 29, s: "Cu", n: "Copper", cn: "éŠ…", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1085Â°C", bp: "2562Â°C", p: 4, g: "1B", iupac: 11, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s1", noble: "[Ar] 3d10 4s1", ex: true },
    { z: 30, s: "Zn", n: "Zinc", cn: "é‹…", type: "é‡‘å±¬", state: "å›ºé«”", mp: "420Â°C", bp: "907Â°C", p: 4, g: "2B", iupac: 12, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2", noble: "[Ar] 3d10 4s2" },
    { z: 31, s: "Ga", n: "Gallium", cn: "éµ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "30Â°C", bp: "2204Â°C", p: 4, g: "3A", iupac: 13, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p1", noble: "[Ar] 3d10 4s2 4p1" },
    { z: 32, s: "Ge", n: "Germanium", cn: "éº", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "938Â°C", bp: "2833Â°C", p: 4, g: "4A", iupac: 14, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p2", noble: "[Ar] 3d10 4s2 4p2" },
    { z: 33, s: "As", n: "Arsenic", cn: "ç ·", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "817Â°C", bp: "614Â°C", p: 4, g: "5A", iupac: 15, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p3", noble: "[Ar] 3d10 4s2 4p3" },
    { z: 34, s: "Se", n: "Selenium", cn: "ç¡’", type: "éé‡‘å±¬", state: "å›ºé«”", mp: "221Â°C", bp: "685Â°C", p: 4, g: "6A", iupac: 16, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p4", noble: "[Ar] 3d10 4s2 4p4" },
    { z: 35, s: "Br", n: "Bromine", cn: "æº´", type: "éé‡‘å±¬", state: "æ¶²é«”", mp: "-7Â°C", bp: "59Â°C", p: 4, g: "7A", iupac: 17, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p5", noble: "[Ar] 3d10 4s2 4p5" },
    { z: 36, s: "Kr", n: "Krypton", cn: "æ°ª", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-157Â°C", bp: "-153Â°C", p: 4, g: "8A", iupac: 18, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6", noble: "[Ar] 3d10 4s2 4p6" },
    // Period 5
    { z: 37, s: "Rb", n: "Rubidium", cn: "éŠ£", type: "é‡‘å±¬", state: "å›ºé«”", mp: "39Â°C", bp: "688Â°C", p: 5, g: "1A", iupac: 1, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 5s1", noble: "[Kr] 5s1" },
    { z: 38, s: "Sr", n: "Strontium", cn: "é¶", type: "é‡‘å±¬", state: "å›ºé«”", mp: "777Â°C", bp: "1382Â°C", p: 5, g: "2A", iupac: 2, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 5s2", noble: "[Kr] 5s2" },
    { z: 39, s: "Y", n: "Yttrium", cn: "é‡”", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1526Â°C", bp: "3338Â°C", p: 5, g: "3B", iupac: 3, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d1 5s2", noble: "[Kr] 4d1 5s2" },
    { z: 40, s: "Zr", n: "Zirconium", cn: "é‹¯", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1855Â°C", bp: "4409Â°C", p: 5, g: "4B", iupac: 4, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d2 5s2", noble: "[Kr] 4d2 5s2" },
    { z: 41, s: "Nb", n: "Niobium", cn: "éˆ®", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2477Â°C", bp: "4744Â°C", p: 5, g: "5B", iupac: 5, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d4 5s1", noble: "[Kr] 4d4 5s1", ex: true },    
    { z: 42, s: "Mo", n: "Molybdenum", cn: "é‰¬", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2623Â°C", bp: "4639Â°C", p: 5, g: "6B", iupac: 6, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d5 5s1", noble: "[Kr] 4d5 5s1", ex: true },    
    { z: 43, s: "Tc", n: "Technetium", cn: "é", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2157Â°C", bp: "4265Â°C", p: 5, g: "7B", iupac: 7, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d5 5s2", noble: "[Kr] 4d5 5s2" },
    { z: 44, s: "Ru", n: "Ruthenium", cn: "é‡•", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2334Â°C", bp: "4150Â°C", p: 5, g: "8B", iupac: 8, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d7 5s1", noble: "[Kr] 4d7 5s1" },
    { z: 45, s: "Rh", n: "Rhodium", cn: "éŠ ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1964Â°C", bp: "3695Â°C", p: 5, g: "8B", iupac: 9, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d8 5s1", noble: "[Kr] 4d8 5s1", ex: true },    
    { z: 46, s: "Pd", n: "Palladium", cn: "éˆ€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1555Â°C", bp: "2963Â°C", p: 5, g: "8B", iupac: 10, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10", noble: "[Kr] 4d10", ex: true },    
    { z: 47, s: "Ag", n: "Silver", cn: "éŠ€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "962Â°C", bp: "2162Â°C", p: 5, g: "1B", iupac: 11, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s1", noble: "[Kr] 4d10 5s1", ex: true },    
    { z: 48, s: "Cd", n: "Cadmium", cn: "é˜", type: "é‡‘å±¬", state: "å›ºé«”", mp: "321Â°C", bp: "767Â°C", p: 5, g: "2B", iupac: 12, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2", noble: "[Kr] 4d10 5s2" },
    { z: 49, s: "In", n: "Indium", cn: "éŠ¦", type: "é‡‘å±¬", state: "å›ºé«”", mp: "157Â°C", bp: "2072Â°C", p: 5, g: "3A", iupac: 13, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p1", noble: "[Kr] 4d10 5s2 5p1" },
    { z: 50, s: "Sn", n: "Tin", cn: "éŒ«", type: "é‡‘å±¬", state: "å›ºé«”", mp: "232Â°C", bp: "2602Â°C", p: 5, g: "4A", iupac: 14, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p2", noble: "[Kr] 4d10 5s2 5p2" },
    { z: 51, s: "Sb", n: "Antimony", cn: "éŠ»", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "631Â°C", bp: "1587Â°C", p: 5, g: "5A", iupac: 15, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p3", noble: "[Kr] 4d10 5s2 5p3" },
    { z: 52, s: "Te", n: "Tellurium", cn: "ç¢²", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "450Â°C", bp: "988Â°C", p: 5, g: "6A", iupac: 16, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p4", noble: "[Kr] 4d10 5s2 5p4" },
    { z: 53, s: "I", n: "Iodine", cn: "ç¢˜", type: "éé‡‘å±¬", state: "å›ºé«”", mp: "114Â°C", bp: "184Â°C", p: 5, g: "7A", iupac: 17, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p5", noble: "[Kr] 4d10 5s2 5p5" },
    { z: 54, s: "Xe", n: "Xenon", cn: "æ°™", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-112Â°C", bp: "-108Â°C", p: 5, g: "8A", iupac: 18, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6", noble: "[Kr] 4d10 5s2 5p6" },
    // Period 6
    { z: 55, s: "Cs", n: "Cesium", cn: "éŠ«", type: "é‡‘å±¬", state: "å›ºé«”", mp: "28Â°C", bp: "671Â°C", p: 6, g: "1A", iupac: 1, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 6s1", noble: "[Xe] 6s1" },
    { z: 56, s: "Ba", n: "Barium", cn: "é‹‡", type: "é‡‘å±¬", state: "å›ºé«”", mp: "727Â°C", bp: "1897Â°C", p: 6, g: "2A", iupac: 2, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 6s2", noble: "[Xe] 6s2" },
    { z: 57, s: "La", n: "Lanthanum", cn: "é‘­", type: "é‡‘å±¬", state: "å›ºé«”", mp: "920Â°C", bp: "3464Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 5d1 6s2", noble: "[Xe] 5d1 6s2", ex: true },    
    { z: 58, s: "Ce", n: "Cerium", cn: "éˆ°", type: "é‡‘å±¬", state: "å›ºé«”", mp: "795Â°C", bp: "3443Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f1 5d1 6s2", noble: "[Xe] 4f1 5d1 6s2", ex: true },    
    { z: 59, s: "Pr", n: "Praseodymium", cn: "é ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "931Â°C", bp: "3520Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f3 6s2", noble: "[Xe] 4f3 6s2" },
    { z: 60, s: "Nd", n: "Neodymium", cn: "é‡¹", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1024Â°C", bp: "3074Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f4 6s2", noble: "[Xe] 4f4 6s2" },
    { z: 61, s: "Pm", n: "Promethium", cn: "é‰•", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1042Â°C", bp: "3000Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f5 6s2", noble: "[Xe] 4f5 6s2" },
    { z: 62, s: "Sm", n: "Samarium", cn: "é‡¤", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1072Â°C", bp: "1794Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f6 6s2", noble: "[Xe] 4f6 6s2" },
    { z: 63, s: "Eu", n: "Europium", cn: "éŠª", type: "é‡‘å±¬", state: "å›ºé«”", mp: "826Â°C", bp: "1529Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f7 6s2", noble: "[Xe] 4f7 6s2" },
    { z: 64, s: "Gd", n: "Gadolinium", cn: "é‡“", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1312Â°C", bp: "3273Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f7 5d1 6s2", noble: "[Xe] 4f7 5d1 6s2", ex: true },    
    { z: 65, s: "Tb", n: "Terbium", cn: "é‹±", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1356Â°C", bp: "3230Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f9 6s2", noble: "[Xe] 4f9 6s2" },
    { z: 66, s: "Dy", n: "Dysprosium", cn: "é‘", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1407Â°C", bp: "2567Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f10 6s2", noble: "[Xe] 4f10 6s2" },
    { z: 67, s: "Ho", n: "Holmium", cn: "éˆ¥", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1461Â°C", bp: "2720Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f11 6s2", noble: "[Xe] 4f11 6s2" },
    { z: 68, s: "Er", n: "Erbium", cn: "é‰º", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1529Â°C", bp: "2868Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f12 6s2", noble: "[Xe] 4f12 6s2" },
    { z: 69, s: "Tm", n: "Thulium", cn: "éŠ©", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1545Â°C", bp: "1950Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f13 6s2", noble: "[Xe] 4f13 6s2" },
    { z: 70, s: "Yb", n: "Ytterbium", cn: "é¿", type: "é‡‘å±¬", state: "å›ºé«”", mp: "824Â°C", bp: "1196Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 6s2", noble: "[Xe] 4f14 6s2" },
    { z: 71, s: "Lu", n: "Lutetium", cn: "é¦", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1663Â°C", bp: "3402Â°C", p: 6, g: "é‘­ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d1 6s2", noble: "[Xe] 4f14 5d1 6s2" },
    { z: 72, s: "Hf", n: "Hafnium", cn: "é‰¿", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2233Â°C", bp: "4603Â°C", p: 6, g: "4B", iupac: 4, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d2 6s2", noble: "[Xe] 4f14 5d2 6s2" },
    { z: 73, s: "Ta", n: "Tantalum", cn: "é‰­", type: "é‡‘å±¬", state: "å›ºé«”", mp: "3017Â°C", bp: "5458Â°C", p: 6, g: "5B", iupac: 5, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d3 6s2", noble: "[Xe] 4f14 5d3 6s2" },
    { z: 74, s: "W", n: "Tungsten", cn: "é¢", type: "é‡‘å±¬", state: "å›ºé«”", mp: "3422Â°C", bp: "5930Â°C", p: 6, g: "6B", iupac: 6, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d4 6s2", noble: "[Xe] 4f14 5d4 6s2" },
    { z: 75, s: "Re", n: "Rhenium", cn: "éŒ¸", type: "é‡‘å±¬", state: "å›ºé«”", mp: "3186Â°C", bp: "5596Â°C", p: 6, g: "7B", iupac: 7, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d5 6s2", noble: "[Xe] 4f14 5d5 6s2" },
    { z: 76, s: "Os", n: "Osmium", cn: "é‹¨", type: "é‡‘å±¬", state: "å›ºé«”", mp: "3033Â°C", bp: "5012Â°C", p: 6, g: "8B", iupac: 8, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d6 6s2", noble: "[Xe] 4f14 5d6 6s2" },
    { z: 77, s: "Ir", n: "Iridium", cn: "éŠ¥", type: "é‡‘å±¬", state: "å›ºé«”", mp: "2446Â°C", bp: "4428Â°C", p: 6, g: "8B", iupac: 9, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d7 6s2", noble: "[Xe] 4f14 5d7 6s2" },
    { z: 78, s: "Pt", n: "Platinum", cn: "é‰‘", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1768Â°C", bp: "3825Â°C", p: 6, g: "8B", iupac: 10, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d9 6s1", noble: "[Xe] 4f14 5d9 6s1", ex: true },    
    { z: 79, s: "Au", n: "Gold", cn: "é‡‘", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1064Â°C", bp: "2970Â°C", p: 6, g: "1B", iupac: 11, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s1", noble: "[Xe] 4f14 5d10 6s1", ex: true },    
    { z: 80, s: "Hg", n: "Mercury", cn: "æ±", type: "é‡‘å±¬", state: "æ¶²é«”", mp: "-39Â°C", bp: "357Â°C", p: 6, g: "2B", iupac: 12, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2", noble: "[Xe] 4f14 5d10 6s2" },
    { z: 81, s: "Tl", n: "Thallium", cn: "é‰ˆ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "304Â°C", bp: "1473Â°C", p: 6, g: "3A", iupac: 13, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p1", noble: "[Xe] 4f14 5d10 6s2 6p1" },
    { z: 82, s: "Pb", n: "Lead", cn: "é‰›", type: "é‡‘å±¬", state: "å›ºé«”", mp: "327Â°C", bp: "1749Â°C", p: 6, g: "4A", iupac: 14, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p2", noble: "[Xe] 4f14 5d10 6s2 6p2" },
    { z: 83, s: "Bi", n: "Bismuth", cn: "é‰", type: "é‡‘å±¬", state: "å›ºé«”", mp: "271Â°C", bp: "1564Â°C", p: 6, g: "5A", iupac: 15, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p3", noble: "[Xe] 4f14 5d10 6s2 6p3" },
    { z: 84, s: "Po", n: "Polonium", cn: "é‡™", type: "é‡‘å±¬", state: "å›ºé«”", mp: "254Â°C", bp: "962Â°C", p: 6, g: "6A", iupac: 16, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p4", noble: "[Xe] 4f14 5d10 6s2 6p4" },
    { z: 85, s: "At", n: "Astatine", cn: "ç ˆ", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "302Â°C", bp: "337Â°C", p: 6, g: "7A", iupac: 17, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p5", noble: "[Xe] 4f14 5d10 6s2 6p5" },
    { z: 86, s: "Rn", n: "Radon", cn: "æ°¡", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-71Â°C", bp: "-62Â°C", p: 6, g: "8A", iupac: 18, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6", noble: "[Xe] 4f14 5d10 6s2 6p6" },
    // Period 7
    { z: 87, s: "Fr", n: "Francium", cn: "é…", type: "é‡‘å±¬", state: "å›ºé«”", mp: "27Â°C", bp: "677Â°C", p: 7, g: "1A", iupac: 1, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 7s1", noble: "[Rn] 7s1" },
    { z: 88, s: "Ra", n: "Radium", cn: "é³", type: "é‡‘å±¬", state: "å›ºé«”", mp: "700Â°C", bp: "1737Â°C", p: 7, g: "2A", iupac: 2, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 7s2", noble: "[Rn] 7s2" },
    { z: 89, s: "Ac", n: "Actinium", cn: "éŒ’", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1050Â°C", bp: "3198Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 6d1 7s2", noble: "[Rn] 6d1 7s2", ex: true },
    { z: 90, s: "Th", n: "Thorium", cn: "é‡·", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1750Â°C", bp: "4788Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 6d2 7s2", noble: "[Rn] 6d2 7s2", ex: true },
    { z: 91, s: "Pa", n: "Protactinium", cn: "é·", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1568Â°C", bp: "4027Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f2 6d1 7s2", noble: "[Rn] 5f2 6d1 7s2", ex: true },
    { z: 92, s: "U", n: "Uranium", cn: "éˆ¾", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1132Â°C", bp: "4131Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f3 6d1 7s2", noble: "[Rn] 5f3 6d1 7s2", ex: true },
    { z: 93, s: "Np", n: "Neptunium", cn: "éŒ¼", type: "é‡‘å±¬", state: "å›ºé«”", mp: "644Â°C", bp: "3902Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f4 6d1 7s2", noble: "[Rn] 5f4 6d1 7s2", ex: true },
    { z: 94, s: "Pu", n: "Plutonium", cn: "éˆ½", type: "é‡‘å±¬", state: "å›ºé«”", mp: "640Â°C", bp: "3228Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f6 7s2", noble: "[Rn] 5f6 7s2" },
    { z: 95, s: "Am", n: "Americium", cn: "é‹‚", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1176Â°C", bp: "2607Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f7 7s2", noble: "[Rn] 5f7 7s2" },
    { z: 96, s: "Cm", n: "Curium", cn: "é‹¦", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1340Â°C", bp: "3110Â°C", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f7 6d1 7s2", noble: "[Rn] 5f7 6d1 7s2", ex: true },    
    { z: 97, s: "Bk", n: "Berkelium", cn: "é‰³", type: "é‡‘å±¬", state: "å›ºé«”", mp: "986Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f9 7s2", noble: "[Rn] 5f9 7s2" },
    { z: 98, s: "Cf", n: "Californium", cn: "é‰²", type: "é‡‘å±¬", state: "å›ºé«”", mp: "900Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f10 7s2", noble: "[Rn] 5f10 7s2" },
    { z: 99, s: "Es", n: "Einsteinium", cn: "é‘€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "860Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f11 7s2", noble: "[Rn] 5f11 7s2" },
    { z: 100, s: "Fm", n: "Fermium", cn: "é¨", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1527Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f12 7s2", noble: "[Rn] 5f12 7s2" },
    { z: 101, s: "Md", n: "Mendelevium", cn: "é†", type: "é‡‘å±¬", state: "å›ºé«”", mp: "827Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f13 7s2", noble: "[Rn] 5f13 7s2" },
    { z: 102, s: "No", n: "Nobelium", cn: "é©", type: "é‡‘å±¬", state: "å›ºé«”", mp: "827Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 7s2", noble: "[Rn] 5f14 7s2" },
    { z: 103, s: "Lr", n: "Lawrencium", cn: "é’", type: "é‡‘å±¬", state: "å›ºé«”", mp: "1627Â°C", bp: "-", p: 7, g: "éŒ’ç³»", iupac: "-", c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 7s2 7p1", noble: "[Rn] 5f14 7s2 7p1" },
    { z: 104, s: "Rf", n: "Rutherfordium", cn: "é‘ª", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "4B", iupac: 4, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d2 7s2", noble: "[Rn] 5f14 6d2 7s2" },
    { z: 105, s: "Db", n: "Dubnium", cn: "ğ¨§€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "5B", iupac: 5, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d3 7s2", noble: "[Rn] 5f14 6d3 7s2" },
    { z: 106, s: "Sg", n: "Seaborgium", cn: "ğ¨­", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "6B", iupac: 6, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d4 7s2", noble: "[Rn] 5f14 6d4 7s2" },
    { z: 107, s: "Bh", n: "Bohrium", cn: "ğ¨¨", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "7B", iupac: 7, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d5 7s2", noble: "[Rn] 5f14 6d5 7s2" },
    { z: 108, s: "Hs", n: "Hassium", cn: "ğ¨­†", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "8B", iupac: 8, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d6 7s2", noble: "[Rn] 5f14 6d6 7s2" },
    { z: 109, s: "Mt", n: "Meitnerium", cn: "ä¥‘", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "8B", iupac: 9, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d7 7s2", noble: "[Rn] 5f14 6d7 7s2" },
    { z: 110, s: "Ds", n: "Darmstadtium", cn: "é½", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "8B", iupac: 10, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d8 7s2", noble: "[Rn] 5f14 6d8 7s2" },
    { z: 111, s: "Rg", n: "Roentgenium", cn: "éŒ€", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "1B", iupac: 11, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d9 7s2", noble: "[Rn] 5f14 6d9 7s2" },
    { z: 112, s: "Cn", n: "Copernicium", cn: "é¶", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "2B", iupac: 12, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2", noble: "[Rn] 5f14 6d10 7s2" },
    { z: 113, s: "Nh", n: "Nihonium", cn: "é‰¨", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "3A", iupac: 13, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p1", noble: "[Rn] 5f14 6d10 7s2 7p1" },
    { z: 114, s: "Fl", n: "Flerovium", cn: "éˆ‡", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "4A", iupac: 14, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p2", noble: "[Rn] 5f14 6d10 7s2 7p2" },
    { z: 115, s: "Mc", n: "Moscovium", cn: "éŒ", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "5A", iupac: 15, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p3", noble: "[Rn] 5f14 6d10 7s2 7p3" },
    { z: 116, s: "Lv", n: "Livermorium", cn: "é‰", type: "é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "6A", iupac: 16, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p4", noble: "[Rn] 5f14 6d10 7s2 7p4" },
    { z: 117, s: "Ts", n: "Tennessine", cn: "é¿¬", type: "é¡é‡‘å±¬", state: "å›ºé«”", mp: "-", bp: "-", p: 7, g: "7A", iupac: 17, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p5", noble: "[Rn] 5f14 6d10 7s2 7p5" },
    { z: 118, s: "Og", n: "Oganesson", cn: "é¿«", type: "éé‡‘å±¬", state: "æ°£é«”", mp: "-", bp: "-", p: 7, g: "8A", iupac: 18, c: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6 5f14 6d10 7s2 7p6", noble: "[Rn] 5f14 6d10 7s2 7p6" }
];

// ========== [æ¯æ—¥é‹å‹¢è³‡æ–™åº«ï¼šæœ€çµ‚ä¿®è¨‚ç‰ˆ] ==========

// ====== Cleanup: remove "æ¨¡å¼: è¤‡åˆ" / composite-mode artifacts if present ======
(function cleanupCompositeMode() {
    const candidateNames = [
        "æ¨¡å¼: è¤‡åˆ","æ¨¡å¼_è¤‡åˆ","è¤‡åˆæ¨¡å¼",
        "compositeMode","modeComposite","composite"
    ];

    function tryDeleteGlobal(name){
        try{
            if (typeof window !== 'undefined' && window.hasOwnProperty(name)) {
                try { delete window[name]; } catch(e) { window[name] = undefined; }
            }
        }catch(e){}
    }

    function removeDomReferences(){
        const attrSelectors = ['[data-mode]','[data-mode-name]','[data-mode-id]','[data-mode-type]'];
        document.querySelectorAll(attrSelectors.join(',')).forEach(el=>{
            const v = (el.getAttribute('data-mode') || el.getAttribute('data-mode-name') || el.getAttribute('data-mode-id') || el.getAttribute('data-mode-type') || '');
            if (v.indexOf('è¤‡åˆ') !== -1 || /composite/i.test(v)) el.remove();
        });
        // remove nodes whose text contains "æ¨¡å¼: è¤‡åˆ"
        document.querySelectorAll('body *').forEach(el=>{
            if (el.childElementCount === 0 && /æ¨¡å¼[:ï¼š]\s*è¤‡åˆ/.test((el.textContent||''))) el.remove();
        });
    }

    function removeByNamePatterns(){
        // attempt to clear any globally reachable variables/functions containing keywords
        Object.getOwnPropertyNames(window).forEach(k=>{
            if (/è¤‡åˆ|composite/i.test(k)) {
                try { delete window[k]; } catch(e) { window[k] = undefined; }
            }
        });
        // explicit list
        candidateNames.forEach(tryDeleteGlobal);
    }

    function run(){
        try { removeByNamePatterns(); } catch(e){}
        try { if (typeof document !== 'undefined') removeDomReferences(); } catch(e){}
        // As a last resort, try to null any likely variables we can find on window
        try {
            candidateNames.forEach(n=>{
                try {
                    if (window[n] !== undefined) window[n] = undefined;
                } catch(e){}
            });
        } catch(e){}
    }

    if (typeof document !== 'undefined' && document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', run);
    } else {
        // run ASAP
        setTimeout(run, 0);
    }
})();
</script>
<script>
// ==========================================
// data_molecules.js - åˆ†å­çµæ§‹å®šç¾©èˆ‡è¼”åŠ©å‡½å¼
// ==========================================

let MOLECULE_DB = {};
let MOLECULE_INDEX = {};

// å¹¾ä½•è¼”åŠ©å‡½å¼
const di = (e, dist=60) => [{elem:e,x:-dist,y:0,z:0},{elem:e,x:dist,y:0,z:0}];
const getLinear = (c, o, r=70) => [ {elem:c,x:0,y:0,z:0, lpCount:0}, {elem:o,x:-r,y:0,z:0}, {elem:o,x:r,y:0,z:0} ];
const getTrigPlanar = (c, o, r=70) => [ {elem:c,x:0,y:0,z:0, lpCount:0}, {elem:o,x:0,y:r,z:0}, {elem:o,x:r*0.866,y:-r*0.5,z:0}, {elem:o,x:-r*0.866,y:-r*0.5,z:0} ];
const getTetra = (c, o, d=60) => { const r = d / 1.73205; return [ {elem:c,x:0,y:0,z:0, lpCount:0}, {elem:o,x:r,y:-r,z:r}, {elem:o,x:-r,y:r,z:r}, {elem:o,x:-r,y:-r,z:-r}, {elem:o,x:r,y:r,z:-r} ]; };
const getOcta = (c, o, r=65) => [{elem:c,x:0,y:0,z:0, lpCount:0}, {elem:o,x:r,y:0,z:0}, {elem:o,x:-r,y:0,z:0}, {elem:o,x:0,y:r,z:0}, {elem:o,x:0,y:-r,z:0}, {elem:o,x:0,y:0,z:r}, {elem:o,x:0,y:0,z:-r}];
const benzBase=[{x:0,y:70,z:0},{x:60,y:35,z:0},{x:60,y:-35,z:0},{x:0,y:-70,z:0},{x:-60,y:-35,z:0},{x:-60,y:35,z:0}];
function getBenzH(i,s=35){const v=benzBase[i],l=Math.sqrt(v.x**2+v.y**2);return{x:v.x+v.x/l*s,y:v.y+v.y/l*s,z:0};}

// Common English names fallback for molecules/elements when not provided explicitly
const COMMON_EN_NAMES = {
    'H2O': 'Water', 'CH4': 'Methane', 'NH3': 'Ammonia', 'PH3': 'Phosphine', 'H2S': 'Hydrogen sulphide',
    'H2': 'Hydrogen', 'N2': 'Nitrogen', 'O2': 'Oxygen', 'F2': 'Fluorine', 'Cl2': 'Chlorine', 'Br2': 'Bromine', 'I2': 'Iodine',
    'CO': 'Carbon monoxide', 'NO': 'Nitric oxide', 'CN-': 'Cyanide', 'O22-': 'Peroxide',
    'H2O2': 'Hydrogen peroxide',
    'HF': 'Hydrogen fluoride', 'HCl': 'Hydrogen chloride', 'HBr': 'Hydrogen bromide', 'HI': 'Hydrogen iodide',
    'NaCl': 'Sodium chloride', 'CsCl': 'Cesium chloride', 'ZnS': 'Zinc sulphide', 'CuCl': 'Copper(I) chloride',
    'TiO2': 'Titanium dioxide', 'Cu2O': 'Copper(I) oxide', 'CO2': 'Carbon dioxide', 'CH3OH': 'Methanol',
    // Common ions and polyatomic ions (British spelling: sulph-)
    'NH4+': 'Ammonium ion', 'SO42-': 'Sulphate ion', 'HSO4-': 'hydrogensulphate', 'NO3-': 'Nitrate',
    'HSO3-': 'hydrogensulphite', 'HSO3': 'hydrogensulphite',
    'H3O+': 'Hydronium ion',
    'BRO3-': 'Bromate ion', 'BrO3-': 'Bromate ion', 'IO3-': 'Iodate ion',
    'S2O32-': 'Thiosulphate ion',
    'HS2O3-': 'hydrogenthiosulphate',
    'H2PO2-': 'Hypophosphite ion', 'H2PO3-': 'hydrogenphosphite', 'H2PO4-': 'dihydrogenphosphate',
    'HPO32-': 'Phosphite ion', 'HPO42-': 'hydrogenphosphate', 'HS-': 'hydrosulphide',
    'CO32-': 'Carbonate ion', 'OH-': 'Hydroxide', 'PO43-': 'Phosphate ion',
    // Sulphite (provide several common token forms)
    'SO3^2-': 'Sulphite ion', 'SO32-': 'Sulphite ion', 'SO3 2-': 'Sulphite ion', 'SO3-': 'Sulphite ion',
    'S2-': 'Sulphide ion', 'SO2': 'Sulphur dioxide', 'HCO3-': 'hydrogencarbonate'
};

// ä¸»è¨»å†Šå‡½å¼ (å·²ä¿®æ”¹ï¼šç›´æ¥ä½¿ç”¨å‚³å…¥çš„ hybrid å­—ä¸²ï¼Œä¸æ·»åŠ è´…å­—)
const addMol = (keysStr, center, hybrid, shape, angle, mp, bp, atoms, bonds, variants = null, desc = null, pg = null) => {
    if (typeof MOLECULE_INDEX === 'undefined') MOLECULE_INDEX = {};
    if (typeof MOLECULE_DB === 'undefined') MOLECULE_DB = {};
    const keys = keysStr.split('|').map(s=>s.trim());
    const mainKey = keys[0];
    const mainKeyUpper = mainKey.toUpperCase();
    keys.forEach(k => { MOLECULE_INDEX[k.trim().toUpperCase()] = { key: mainKey, variant: null }; });

    // derive Chinese / English names from the remaining key parts
    let nameCN = '';
    let nameEN = '';
    for (let i = 1; i < keys.length; i++) {
        const p = keys[i];
        if (/[A-Za-z]/.test(p) && !nameEN) nameEN = p;
        else if (!/[A-Za-z]/.test(p) && !nameCN) nameCN = p;
    }
    // prefer explicitly-provided English; otherwise try common name map
    if (!nameCN && nameEN) nameCN = nameEN;
    if (!nameEN) {
        nameEN = COMMON_EN_NAMES[mainKey.toUpperCase()] || '';
        if (!nameEN && nameCN && /[A-Za-z]/.test(nameCN)) nameEN = nameCN;
    }

    const baseData = { 
        center,
        hybrid: hybrid,
        // keep legacy `shape` for backward compatibility, but also store separated CN/EN
        shape: Array.isArray(shape) ? `${shape[0]} (${shape[1]})` : shape,
        shapeCN: Array.isArray(shape) ? shape[0] : shape,
        shapeEN: Array.isArray(shape) ? shape[1] : shape,
        angle, mp, bp, atomsRaw: atoms, bondsRaw: bonds, desc, fullKey: keysStr,
        nameCN: nameCN,
        nameEN: nameEN,
        isMetal: false,
        pg: pg // ç¢ºä¿é€™è£¡æœ‰æ¥æ”¶åˆ°å‚³å…¥çš„ pg
    };
    
    if (variants) {
        baseData.variants = {};
        for (let vKeyRaw in variants) {
            const uniqueID = vKeyRaw; 
            const vObj = variants[vKeyRaw];
            const vKeyParts = vKeyRaw.split('|');
            vKeyParts.forEach(vk => { 
                const cleanKey = vk.trim().toUpperCase();
                if (cleanKey !== mainKeyUpper) { MOLECULE_INDEX[cleanKey] = { key: mainKey, variant: uniqueID }; }
            });
            // allow variant to override names/shapes if provided
            const variantShape = vObj.shape !== undefined ? vObj.shape : shape;
            let vShapeCN = Array.isArray(variantShape) ? variantShape[0] : variantShape;
            let vShapeEN = Array.isArray(variantShape) ? variantShape[1] : variantShape;
                // derive names from variant key string if present
                const vKeys = vKeyRaw.split('|').map(s=>s.trim());
                let vNameCN = '';
                let vNameEN = '';
                const isEnglishWord = s => (/[A-Za-z]/.test(String(s))) && !(/^[A-Z0-9+\-]+$/.test(String(s).replace(/\s/g,'')));
                // prefer human-readable English words (not formula-like tokens)
                for (let i=1;i<vKeys.length;i++){
                    const p=vKeys[i];
                    if (!vNameEN && isEnglishWord(p)) vNameEN = p;
                    else if (!vNameCN && !/[A-Za-z]/.test(p)) vNameCN = p;
                }
                if(!vNameCN) vNameCN = baseData.nameCN;
                if(!vNameEN) {
                    const rawVariant = vKeys[0] ? String(vKeys[0]) : '';
                    const variantFormula = rawVariant.replace(/\s/g,'').replace(/\^/g,'').toUpperCase();
                    const tryVKeys = [variantFormula, rawVariant.replace(/\s/g,'').toUpperCase(), rawVariant.replace(/\^/g,'').toUpperCase()];
                    for (let tk of tryVKeys) {
                        if (!tk) continue;
                        if (COMMON_EN_NAMES[tk]) { vNameEN = COMMON_EN_NAMES[tk]; break; }
                    }
                    if(!vNameEN) vNameEN = COMMON_EN_NAMES[uniqueID] || COMMON_EN_NAMES[mainKey.toUpperCase()] || baseData.nameEN || '';
                }

            baseData.variants[uniqueID] = { 
                ...baseData, 
                atomsRaw: vObj.atoms, 
                bondsRaw: vObj.bonds,
                // æ ¸å¿ƒä¿®å¾©ï¼šç¢ºä¿ pg æ¨™ç±¤èƒ½å¾è³‡æ–™ä¸­è¢«è®€å–ä¸¦å‚³é
                pg: vObj.pg || baseData.pg || null,
                mp: vObj.mp !== undefined ? vObj.mp : baseData.mp,
                bp: vObj.bp !== undefined ? vObj.bp : baseData.bp,
                desc: vObj.desc !== undefined ? vObj.desc : baseData.desc,
                fullKey: vKeyRaw,
                shapeCN: vShapeCN,
                shapeEN: vShapeEN,
                nameCN: vNameCN,
                nameEN: vNameEN
            };
        }
    }
    MOLECULE_DB[mainKey] = baseData;
};

function markReps(atoms, bonds, cnA, elemA, cnB, elemB) {
    const counts = new Array(atoms.length).fill(0);
    bonds.forEach(b => { counts[b[0]]++; counts[b[1]]++; });
    atoms.forEach((a, i) => {
        if (a.elem === elemA && counts[i] === cnA) a.isRepresentative = true;
        else if (a.elem === elemB && counts[i] === cnB) a.isRepresentative = true;
        else a.isRepresentative = false;
    });
}

//NaClæ™¶é«”
(function(){
    const sa=[{elem:"Na",x:-40,y:0,z:0,r:20,lpCount:0},{elem:"Cl",x:40,y:0,z:0,r:35,lpCount:0}], sb=[[0,1,"ionic_thin"]];
    const ca=[], cb=[], s=120;
    for(let x=-1;x<=1;x++) for(let y=-1;y<=1;y++) for(let z=-1;z<=1;z++){
        const isNa=(Math.abs(x+y+z)%2!==0);
        ca.push({elem:isNa?"Na":"Cl",x:x*s,y:y*s,z:z*s,r:isNa?18:34,lpCount:0,gx:x,gy:y,gz:z,isRepresentative:(!x&&!y&&!z)});
    }
    for(let i=0;i<ca.length;i++) for(let j=i+1;j<ca.length;j++){
        const dist=Math.abs(ca[i].x-ca[j].x)+Math.abs(ca[i].y-ca[j].y)+Math.abs(ca[i].z-ca[j].z);
        if(Math.abs(dist-s)<1){
            const onFace=(Math.abs(ca[i].gx)===1&&ca[i].gx===ca[j].gx)||(Math.abs(ca[i].gy)===1&&ca[i].gy===ca[j].gy)||(Math.abs(ca[i].gz)===1&&ca[i].gz===ca[j].gz);
            cb.push([i,j,onFace?"ionic_thick":"ionic_thin"]);
        }
    }
    addMol("NaCl|æ°¯åŒ–éˆ‰|é£Ÿé¹½","Na","-","-","-","801","1465",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>æ°¯åŒ–éˆ‰ (NaCl)</strong><br>ä¿—ç¨±é£Ÿé¹½ã€‚ç´”æ·¨æ™‚ç‚ºç„¡è‰²é€æ˜æ™¶é«”ã€‚å®ƒæ˜¯ç”Ÿæ´»ä¸­æœ€é‡è¦çš„èª¿å‘³å“èˆ‡é˜²è…åŠ‘ã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (FCC)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"a = 2(r<sub>+</sub> + r<sub>-</sub>)",desc:'<div class="info-section"><div class="info-title">ğŸ§Š æ™¶é«”ç‰¹æ€§</div><div class="info-body"><strong>é¢å¿ƒç«‹æ–¹å †ç© (FCC)</strong><br>æ°¯åŒ–éˆ‰å…·æœ‰é«˜ç†”é» (801Â°C)ã€‚æ¯å€‹éˆ‰é›¢å­å‘¨åœéƒ½è¢«6å€‹æ°¯é›¢å­åŒ…åœï¼Œé…ä½æ•¸ç‚º 6ã€‚<br><span style="color:#facc15">â˜… é»æ“Šä¸­å¿ƒåŸå­å¯æŸ¥çœ‹é…ä½æ•¸ã€‚</span></div></div>'}
    },'<div class="info-section"><div class="info-title">ğŸ§‚ æ°¯åŒ–éˆ‰</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["NaCl"]?.variants){MOLECULE_DB["NaCl"].variants["Crystal|æ™¶é«”å †ç© (FCC)"].isIonic=true;MOLECULE_DB["NaCl"].variants["Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)"].isIonic=true;}
})();

//CsClæ™¶é«”
(function(){
    const sa=[{elem:"Cs",x:-45,y:0,z:0,r:26,lpCount:0},{elem:"Cl",x:45,y:0,z:0,r:34,lpCount:0}], sb=[[0,1,"ionic_thin"]];
    const ca=[], cb=[], s=200;
    ca.push({elem:"Cs",x:0,y:0,z:0,r:26,isRepresentative:true});
    [-1,1].forEach(x=>[-1,1].forEach(y=>[-1,1].forEach(z=>{ca.push({elem:"Cl",x:x*s*0.5,y:y*s*0.5,z:z*s*0.5,r:34,isCorner:true}); cb.push([0,ca.length-1,"ionic_thin"]);})));
    for(let i=1;i<ca.length;i++) for(let j=i+1;j<ca.length;j++) if(Math.abs((Math.abs(ca[i].x-ca[j].x)+Math.abs(ca[i].y-ca[j].y)+Math.abs(ca[i].z-ca[j].z))-s)<5) cb.push([i,j,"ionic_thick"]);
    addMol("CsCl|æ°¯åŒ–éŠ«|Cesium Chloride","Cs","-","-","-","645","1290",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">âš›ï¸ ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>æ°¯åŒ–éŠ« (CsCl)</strong><br>ç”±éŠ«é›¢å­ (Csâº) èˆ‡æ°¯é›¢å­ (Clâ») çµ„æˆã€‚éŠ«é›¢å­åŠå¾‘è¼ƒå¤§ï¼Œå½¢æˆé…ä½æ•¸ 8 çš„çµæ§‹ã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (SC)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"âˆš3 a = 2(râº+râ»)",desc:'<div class="info-section"><div class="info-title">ğŸ§Š æ™¶é«”çµæ§‹</div><div class="info-body"><strong>ç°¡å–®ç«‹æ–¹å †ç© (SC)</strong><br>æ°¯é›¢å­æ§‹æˆç°¡å–®ç«‹æ–¹ï¼ŒéŠ«é›¢å­å¡«å…¥é«”å¿ƒã€‚é…ä½æ•¸ç‚º 8ã€‚<br><span style="color:#facc15">â˜… é»æ“Šä¸­å¤® Cs é›¢å­å¯æŸ¥çœ‹é…ä½æ•¸ã€‚</span></div></div>'}
    },'<div class="info-section"><div class="info-title">ğŸ§Š æ°¯åŒ–éŠ«</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["CsCl"]?.variants){MOLECULE_DB["CsCl"].variants["Crystal|æ™¶é«”å †ç© (SC)"].isIonic=true;MOLECULE_DB["CsCl"].variants["Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)"].isIonic=true;}
})();

//ZnSæ™¶é«”
(function(){
    const sa=[{elem:"Zn",x:-45,y:0,z:0,r:18,lpCount:0},{elem:"S",x:45,y:0,z:0,r:30,lpCount:0}], sb=[[0,1,"ionic_thin"]];
    const ca=[], cb=[], scale=220, bondDist=scale*0.433; 
    const baseS=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0.5,0.5,0],[0.5,0,0.5],[0,0.5,0.5],[0.5,1,0.5],[1,0.5,0.5],[0.5,0.5,1]];
    const baseZn=[[0.25,0.25,0.25],[0.75,0.75,0.25],[0.75,0.25,0.75],[0.25,0.75,0.75]];
    let idx=0;
    baseS.forEach((p,i)=>ca.push({elem:"S",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:28,isCorner:(i<8),idx:idx++}));
    baseZn.forEach(p=>ca.push({elem:"Zn",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:12,isRepresentative:true}));
    for(let i=14;i<ca.length;i++) for(let j=0;j<14;j++) if(Math.abs(Math.sqrt((ca[i].x-ca[j].x)**2+(ca[i].y-ca[j].y)**2+(ca[i].z-ca[j].z)**2)-bondDist)<20) cb.push([i,j,"ionic_thin"]);
    for(let i=0;i<14;i++) for(let j=i+1;j<14;j++) if(ca[i].isCorner&&ca[j].isCorner&&Math.abs(Math.sqrt((ca[i].x-ca[j].x)**2+(ca[i].y-ca[j].y)**2+(ca[i].z-ca[j].z)**2)-scale)<5) cb.push([i,j,"ionic_thick"]);
    addMol("ZnS|é–ƒé‹…ç¤¦|ç¡«åŒ–é‹…|Zinc Blende","Zn","-","-","-","1185","æ˜‡è¯",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">ğŸ’¡ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¡«åŒ–é‹… (ZnS)</strong><br>ç™½è‰²æˆ–å¾®é»ƒè‰²ç²‰æœ«ã€‚å…·æœ‰è¢å…‰ç‰¹æ€§ï¼Œæ‘»é›œå¾®é‡é‡‘å±¬å¾Œå¯ç”¨æ–¼è£½ä½œå¤œå…‰å¡—æ–™ã€è¢å…‰å±ä»¥åŠé™°æ¥µå°„ç·šç®¡ã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (FCC)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"4(r<sub>+</sub> + r<sub>-</sub>) = âˆš3 a",desc:'<div class="info-section"><div class="info-title">ğŸ’ é–ƒé‹…ç¤¦ (ZnS)</div><div class="info-body">ç¡«é›¢å­(SÂ²â»)æ§‹æˆé¢å¿ƒç«‹æ–¹å †ç©ï¼Œé‹…é›¢å­(ZnÂ²âº)ä½æ–¼å››é¢é«”ç©ºéš™ã€‚<br><span style="color:#facc15">â˜… é»æ“Šä»»ä¸€å…§éƒ¨çš„ Zn é›¢å­å¯æŸ¥çœ‹é…ä½æ•¸ã€‚</span></div></div>'}
    },'<div class="info-section"><div class="info-title">ğŸ’¡ ç¡«åŒ–é‹…</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["ZnS"]?.variants){MOLECULE_DB["ZnS"].variants["Crystal|æ™¶é«”å †ç© (FCC)"].isIonic=true;MOLECULE_DB["ZnS"].variants["Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)"].isIonic=true;}
})();

//CuClæ™¶é«”
(function(){
    const sa=[{elem:"Cu",x:-45,y:0,z:0,r:13,lpCount:0},{elem:"Cl",x:45,y:0,z:0,r:27,lpCount:0}], sb=[[0,1,"ionic_thin"]];
    const ca=[], cb=[], scale=220, bondDist=scale*0.433;
    const baseCl=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0.5,0.5,0],[0.5,0,0.5],[0,0.5,0.5],[0.5,1,0.5],[1,0.5,0.5],[0.5,0.5,1]];
    const baseCu=[[0.25,0.25,0.25],[0.75,0.75,0.25],[0.75,0.25,0.75],[0.25,0.75,0.75]];
    let clIdx=0;
    baseCl.forEach((p,i)=>ca.push({elem:"Cl",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:27,isCorner:(i<8),idx:clIdx++}));
    baseCu.forEach(p=>ca.push({elem:"Cu",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:13,isRepresentative:true}));
    for(let i=14;i<ca.length;i++) for(let j=0;j<14;j++) if(Math.abs(Math.sqrt((ca[i].x-ca[j].x)**2+(ca[i].y-ca[j].y)**2+(ca[i].z-ca[j].z)**2)-bondDist)<20) cb.push([i,j,"ionic_thin"]);
    for(let i=0;i<14;i++) for(let j=i+1;j<14;j++) if(ca[i].isCorner&&ca[j].isCorner&&Math.abs(Math.sqrt((ca[i].x-ca[j].x)**2+(ca[i].y-ca[j].y)**2+(ca[i].z-ca[j].z)**2)-scale)<5) cb.push([i,j,"ionic_thick"]);
    addMol("CuCl|æ°¯åŒ–äºéŠ…|Nantokite","Cu","-","-","-","430","1490",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">ğŸ”¸ ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>æ°¯åŒ–äºéŠ… (CuCl)</strong><br>ç™½è‰²å›ºé«”ï¼Œé›£æº¶æ–¼æ°´ã€‚çµæ§‹èˆ‡é–ƒé‹…ç¤¦(ZnS)ç›¸åŒã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (FCC)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"4(r<sub>+</sub> + r<sub>-</sub>) = âˆš3 a",desc:'<div class="info-section"><div class="info-title">ğŸ§Š æ™¶é«”çµæ§‹</div><div class="info-body"><strong>é¢å¿ƒç«‹æ–¹å †ç© (FCC)</strong><br>çµæ§‹åŒé–ƒé‹…ç¤¦ã€‚æ°¯é›¢å­å †ç©ï¼ŒäºéŠ…é›¢å­å¡«å…¥å››é¢é«”ç©ºéš™ã€‚<br><span style="color:#facc15">â˜… é»æ“Šä»»ä¸€å…§éƒ¨ Cuâº å¯æŸ¥çœ‹é…ä½æ•¸ã€‚</span></div></div>'}
    },'<div class="info-section"><div class="info-title">ğŸ”¸ æ°¯åŒ–äºéŠ…</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["CuCl"]?.variants){MOLECULE_DB["CuCl"].variants["Crystal|æ™¶é«”å †ç© (FCC)"].isIonic=true;MOLECULE_DB["CuCl"].variants["Simple|åŸºæœ¬å–®å…ƒ (é›¢å­å°)"].isIonic=true;}
})();

//TiO2æ™¶é«”
(function(){
    const sa=[{elem:"Ti",x:0,y:0,z:0,r:11,lpCount:0},{elem:"O",x:50,y:0,z:0,r:21,lpCount:0},{elem:"O",x:-50,y:0,z:0,r:21,lpCount:0}], sb=[[0,1,"ionic_thin"],[0,2,"ionic_thin"]];
    const ca=[], cb=[], scale=180, c_ratio=0.65, u=0.3;
    const baseTi=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0.5,0.5,0.5]];
    const baseO=[[u,u,0],[1-u,1-u,0],[u,u,1],[1-u,1-u,1],[0.5+u,0.5-u,0.5],[0.5-u,0.5+u,0.5]];
    let tiIdx=0;
    baseTi.forEach((p,i)=>ca.push({elem:"Ti",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale*c_ratio,r:11,isCorner:(i<8),idx:tiIdx++,isRepresentative:(i===8)}));
    baseO.forEach(p=>ca.push({elem:"O",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale*c_ratio,r:21,isCorner:false}));
    for(let i=0;i<ca.length;i++) for(let j=i+1;j<ca.length;j++){
        if(ca[i].elem===ca[j].elem) continue;
        if(Math.sqrt((ca[i].x-ca[j].x)**2+(ca[i].y-ca[j].y)**2+(ca[i].z-ca[j].z)**2)<scale*0.75) cb.push([i,j,"ionic_thin"]);
    }
    for(let i=0;i<8;i++) for(let j=i+1;j<8;j++){
        const dx=Math.abs(ca[i].x-ca[j].x), dy=Math.abs(ca[i].y-ca[j].y), dz=Math.abs(ca[i].z-ca[j].z);
        if((Math.abs(dx-scale)<5&&dy<5&&dz<5)||(Math.abs(dy-scale)<5&&dx<5&&dz<5)||(Math.abs(dz-scale*c_ratio)<5&&dx<5&&dy<5)) cb.push([i,j,"ionic_thick"]);
    }
    addMol("TiO2|é‡‘ç´…çŸ³|äºŒæ°§åŒ–éˆ¦|Rutile","Ti","-","-","-","1843","2972",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">â¬œ ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>äºŒæ°§åŒ–éˆ¦ (TiOâ‚‚)</strong><br>ç™½è‰²ç²‰æœ«ï¼Œå»£æ³›ç”¨æ–¼ç™½è‰²é¡æ–™ã€é˜²æ›¬ä¹³åŠå…‰è§¸åª’ã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (Tetragonal)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"è¤‡é›œå¹¾ä½•",desc:'<div class="info-section"><div class="info-title">ğŸ§Š æ™¶é«”çµæ§‹</div><div class="info-body"><strong>å››æ–¹æ™¶ç³» (é‡‘ç´…çŸ³å‹)</strong><br>éˆ¦é›¢å­ä½æ–¼é«”å¿ƒèˆ‡é ‚é»ï¼Œæ°§é›¢å­ä½æ–¼é¢ä¸Šã€‚Tiâ´âº é…ä½æ•¸ç‚º 6 (å…«é¢é«”)ï¼ŒOÂ²â» é…ä½æ•¸ç‚º 3 (å¹³é¢ä¸‰è§’)ã€‚<br><span style="color:#facc15">â˜… é»æ“Šé«”å¿ƒ Tiâ´âº å¯æŸ¥çœ‹é…ä½æ•¸ã€‚</span></div></div>'}
    },'<div class="info-section"><div class="info-title">â¬œ é‡‘ç´…çŸ³</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["TiO2"]?.variants){MOLECULE_DB["TiO2"].variants["Crystal|æ™¶é«”å †ç© (Tetragonal)"].isIonic=true;MOLECULE_DB["TiO2"].variants["Simple|åŸºæœ¬å–®å…ƒ"].isIonic=true;}
})();

//Cu2Oæ™¶é«”
(function(){
    const scale=180, baseO=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0.5,0.5,0.5]], baseCu=[[0.25,0.25,0.25],[0.75,0.75,0.25],[0.75,0.25,0.75],[0.25,0.75,0.75]];
    const ca=[...baseO.map((p,i)=>({elem:"O",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:21,isCorner:i<8,isRepresentative:i===8})),...baseCu.map(p=>({elem:"Cu",x:(p[0]-0.5)*scale,y:(p[1]-0.5)*scale,z:(p[2]-0.5)*scale,r:13,isRepresentative:true}))];
    const cb=[];
    for(let i=0;i<ca.length;i++) for(let j=i+1;j<ca.length;j++){
        const d=Math.hypot(ca[i].x-ca[j].x,ca[i].y-ca[j].y,ca[i].z-ca[j].z);
        if(ca[i].elem!==ca[j].elem&&Math.abs(d-scale*0.433)<20) cb.push([i,j,"ionic_thin"]);
        if(ca[i].isCorner&&ca[j].isCorner&&Math.abs(d-scale)<5) cb.push([i,j,"ionic_thick"]);
    }
    const sa=[{elem:"O",x:0,y:0,z:0,r:21},{elem:"Cu",x:50,y:0,z:0,r:13},{elem:"Cu",x:-50,y:0,z:0,r:13}], sb=[[0,1,"ionic_thin"],[0,2,"ionic_thin"]];
    addMol("Cu2O|èµ¤éŠ…ç¤¦|æ°§åŒ–äºéŠ…|Cuprite","Cu","-","-","-","1235","1800",sa,sb,{
        "Simple|åŸºæœ¬å–®å…ƒ":{atoms:sa,bonds:sb,hybrid:"-",shape:"-",desc:'<div class="info-section"><div class="info-title">ğŸ”´ ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>æ°§åŒ–äºéŠ… (Cuâ‚‚O)</strong><br>ç´…è‰²å›ºé«”ã€‚Cuâº ç‚ºç›´ç·šå‹é…ä½ (CN=2)ï¼ŒOÂ²â» ç‚ºå››é¢é«”å‹é…ä½ (CN=4)ã€‚</div></div>'},
        "Crystal|æ™¶é«”å †ç© (Cubic)":{atoms:ca,bonds:cb,isIonic:true,edgeRelation:"è¤‡é›œå¹¾ä½•",desc:'<div class="info-section"><div class="info-title">ğŸ§Š æ™¶é«”çµæ§‹</div><div class="info-body"><strong>èµ¤éŠ…ç¤¦çµæ§‹</strong><br>æ°§é›¢å­(ç´…)æ§‹æˆé«”å¿ƒç«‹æ–¹ï¼ŒéŠ…é›¢å­(æ©˜)ä½æ–¼æ°§é›¢å­é€£ç·šä¸­é»ã€‚<br>â€¢ é»æ“Š<strong>ç´…è‰²æ°§é›¢å­</strong> (é«”å¿ƒ) å¯è¦‹é…ä½æ•¸ç‚º 4ã€‚<br>â€¢ é»æ“Šä»»ä¸€<strong>æ©˜è‰²éŠ…é›¢å­</strong> å¯è¦‹é…ä½æ•¸ç‚º 2ã€‚</div></div>'}
    },'<div class="info-section"><div class="info-title">ğŸ”´ èµ¤éŠ…ç¤¦</div><div class="info-body">è«‹åˆ‡æ›é¸é …æª¢è¦–ã€‚</div></div>');
    if(MOLECULE_DB["Cu2O"]?.variants){MOLECULE_DB["Cu2O"].variants["Crystal|æ™¶é«”å †ç© (Cubic)"].isIonic=true;MOLECULE_DB["Cu2O"].variants["Simple|åŸºæœ¬å–®å…ƒ"].isIonic=true;}
})();











// ==========================================
// é‡‘å±¬æ™¶é«”ç”Ÿæˆæ¨¡çµ„ (CN=12 å»¶ä¼¸å¢å¼·ç‰ˆ)
// ==========================================

function ensureElement(elem, defaultColor, defaultR) {
    if (typeof ELEMENT_PROPS !== 'undefined' && !ELEMENT_PROPS[elem]) {
        ELEMENT_PROPS[elem] = { ve: 1, c3d: defaultColor, r3d: defaultR, lp: 0, mass: 0, en: 0 };
    }
}

// 1. ç°¡å–®ç«‹æ–¹ (SC) 
function addMetal_SC(elem, name, mp, bp, scale=160) {
    ensureElement(elem, "#ab5c00", 28);
    const atoms = []; const bonds = [];
    for (let x = 0; x <= 1; x++) {
        for (let y = 0; y <= 1; y++) {
            for (let z = 0; z <= 1; z++) {
                atoms.push({ elem: elem, x: (x-0.5)*scale, y: (y-0.5)*scale, z: (z-0.5)*scale, r: 28, isRepresentative: true });
            }
        }
    }
    for (let i = 0; i < atoms.length; i++) {
        for (let j = i + 1; j < atoms.length; j++) {
            const d = Math.sqrt((atoms[i].x-atoms[j].x)**2 + (atoms[i].y-atoms[j].y)**2 + (atoms[i].z-atoms[j].z)**2);
            if (Math.abs(d - scale) < 10) bonds.push([i, j, "ionic_thick"]);
        }
    }
    addMol(`${elem}|${name}`, "Metal", "ç°¡å–®ç«‹æ–¹å †ç© (SC)", "52.4%", "6", mp, bp, atoms, bonds, null,
        `<div class="info-section"><div class="info-title">ğŸ“¦ ç°¡å–®ç«‹æ–¹ (SC)</div><div class="info-body">é‡‘å±¬ç¯„ä¾‹ï¼š<strong>${elem}</strong>ã€‚<br>ç©ºé–“åˆ©ç”¨ç‡ 52.4%ã€‚åŸå­åƒ…ä½æ–¼ç«‹æ–¹é«”é ‚é»ï¼Œæ²¿è‘—é‚Šé•·äº’ç›¸æ¥è§¸ã€‚</div></div>`);
    if(MOLECULE_DB[elem]) { MOLECULE_DB[elem].isIonic = true; MOLECULE_DB[elem].isMetal = true; MOLECULE_DB[elem].edgeRelation = "a = 2r"; }
}

// 2. é«”å¿ƒç«‹æ–¹ (BCC)
function addMetal_BCC(elem, name, mp, bp, scale=200) {
    ensureElement(elem, "#9ca3af", 24); 
    const atoms = []; const bonds = [];
    const h = scale / 2;
    atoms.push({ elem: elem, x: 0, y: 0, z: 0, r: 24, isRepresentative: true });
    const pts = [[-h,-h,-h],[h,-h,-h],[h,h,-h],[-h,h,-h],[-h,-h,h],[h,-h,h],[h,h,h],[-h,h,h]];
    pts.forEach(p => atoms.push({ elem: elem, x: p[0], y: p[1], z: p[2], r: 24 }));
    for(let i=1; i<=8; i++) bonds.push([0, i, "ionic_thin"]);
    const cubeEdges = [[1,2],[2,3],[3,4],[4,1],[5,6],[6,7],[7,8],[8,5],[1,5],[2,6],[3,7],[4,8]];
    cubeEdges.forEach(e => bonds.push([e[0], e[1], "ionic_thick"]));
    addMol(`${elem}|${name}`, "Metal", "é«”å¿ƒç«‹æ–¹å †ç© (BCC)", "68%", "8", mp, bp, atoms, bonds, null,
        `<div class="info-section"><div class="info-title">ğŸ§Š é«”å¿ƒç«‹æ–¹ (BCC)</div><div class="info-body">é‡‘å±¬ç¯„ä¾‹ï¼š<strong>${elem}</strong>ã€‚<br>ç©ºé–“åˆ©ç”¨ç‡ 68%ã€‚åŸå­ä½æ–¼è§’è½èˆ‡é«”ä¸­å¿ƒï¼Œæ²¿è‘—é«”å°è§’ç·šäº’ç›¸æ¥è§¸ã€‚</div></div>`);
    if(MOLECULE_DB[elem]) { MOLECULE_DB[elem].isIonic = true; MOLECULE_DB[elem].isMetal = true; MOLECULE_DB[elem].edgeRelation = "âˆš3 a = 4r"; }
}

// 3. é¢å¿ƒç«‹æ–¹ (FCC) - å‡ç´šç‚º 5-4-5-4 å †ç© (å±•ç¤º CN=12)
function addMetal_FCC(elem, name, mp, bp, scale=200) {
    ensureElement(elem, "#d1d5db", 22);
    const atoms = []; const bonds = [];
    const h = scale / 2;
    
    // å®šç¾©å››å±¤ï¼šL1(5) -> L2(4) -> L3(5) -> L4(4)
    // æˆ‘å€‘å°‡åº§æ¨™ä¸­å¿ƒè¨­åœ¨ L3 çš„ä¸­å¿ƒåŸå­ï¼Œæ–¹ä¾¿æ—‹è½‰è§€å¯Ÿ
    const addLayer5 = (z, isMain) => {
        const s = atoms.length;
        // ä¸­å¿ƒ
        atoms.push({ elem: elem, x: 0, y: 0, z: z, r: 22, isRepresentative: isMain });
        // å››å€‹è§’
        const corners = [[-h,-h,z],[h,-h,z],[h,h,z],[-h,h,z]];
        corners.forEach(p => atoms.push({ elem: elem, x: p[0], y: p[1], z: p[2], r: 22 }));
        // åªæœ‰ä¸»è¦æ™¶èƒå±¤ (L1åˆ°L3) æœ‰æ¡†
        if (isMain || z < scale) {
            bonds.push([s+1, s+2, "ionic_thick"], [s+2, s+3, "ionic_thick"], [s+3, s+4, "ionic_thick"], [s+4, s+1, "ionic_thick"]);
        }
    };

    const addLayer4 = (z, isExtended) => {
        const s = atoms.length;
        // å››å€‹é¢å¿ƒ
        const faces = [[0,-h,z],[h,0,z],[0,h,z],[-h,0,z]];
        faces.forEach(p => atoms.push({ elem: elem, x: p[0], y: p[1], z: p[2], r: 22 }));
        // å‚ç›´æŸ±å­ (åªé€£æ¥ L1-L3 æ ¸å¿ƒ)
        if (!isExtended) {
            // æ­¤è™•é‚è¼¯ç”±å¾ŒçºŒæ¥è§¸ç·šè™•ç†
        }
    };

    addLayer5(-scale, false); // L1 (åº•éƒ¨)
    addLayer4(-h, false);     // L2
    addLayer5(0, true);       // L3 (æ ¸å¿ƒå±¤ï¼Œè¨­ç‚ºåº§æ¨™ 0)
    addLayer4(h, true);       // L4 (å»¶ä¼¸å±¤)

    // å»ºç«‹æ‰€æœ‰åŸå­é–“çš„æ¥è§¸ç·š (è·é›¢ç‚º 0.707a)
    const contactDist = scale * 0.707;
    for (let i = 0; i < atoms.length; i++) {
        for (let j = i + 1; j < atoms.length; j++) {
            const d = Math.sqrt((atoms[i].x-atoms[j].x)**2 + (atoms[i].y-atoms[j].y)**2 + (atoms[i].z-atoms[j].z)**2);
            if (Math.abs(d - contactDist) < 10) {
                // åˆ¤æ–·æ˜¯å¦å±¬æ–¼å»¶ä¼¸å±¤ (L4) çš„é€£ç·š
                const isExt = (atoms[i].z > 5 || atoms[j].z > 5);
                bonds.push([i, j, isExt ? "ionic_thin" : "ionic_thin"]); 
            }
        }
    }

    // å»ºç«‹æ ¸å¿ƒæ™¶èƒçš„å‚ç›´ç²—æ¡†ç·š (L1 åˆ° L3)
    const coreCorners = [[1,10],[2,11],[3,12],[4,13]]; // L1 åˆ° L3 çš„é ‚é»å°æ‡‰
    coreCorners.forEach(e => bonds.push([e[0], e[1], "ionic_thick"]));

    addMol(`${elem}|${name}`, "Metal", "é¢å¿ƒç«‹æ–¹å †ç© (FCC)", "74%", "12", mp, bp, atoms, bonds, null,
        `<div class="info-section"><div class="info-title">âœ¨ é¢å¿ƒç«‹æ–¹ (FCC)</div><div class="info-body">é‡‘å±¬ç¯„ä¾‹ï¼š<strong>${elem}</strong>ã€‚<br>ç©ºé–“åˆ©ç”¨ç‡ 74%ã€‚æ¨¡å‹å±•ç¤ºäº† 5-4-5-4 çš„å››å±¤å †ç©ã€‚<br><span style="color:#facc15">â˜… é»æ“Šç¬¬ä¸‰å±¤ä¸­å¿ƒåŸå­ï¼Œå¯è¦‹å…¶é…ä½æ•¸ç‚º 12 (åŒå±¤4, ä¸‹å±¤4, ä¸Šå±¤4)ã€‚</span></div></div>`);
    if(MOLECULE_DB[elem]) { MOLECULE_DB[elem].isIonic = true; MOLECULE_DB[elem].isMetal = true; MOLECULE_DB[elem].edgeRelation = "âˆš2 a = 4r"; }
}

// 4. å…­æ–¹æœ€å¯†å †ç© (HCP) - ä¿®æ­£æ¯”ä¾‹èˆ‡é…ä½æ•¸ç‰ˆ
function addMetal_HCP(elem, name, mp, bp, scale=140) {
    ensureElement(elem, "#e5e7eb", 22);
    const atoms = []; const bonds = [];
    
    // a = scale (åŸå­é–“è·ï¼Œå³åº•é¢å…­è§’å½¢çš„é‚Šé•·)
    // h = å±¤èˆ‡å±¤ä¹‹é–“çš„å‚ç›´è·é›¢ (ç†æƒ³æ¯”ä¾‹ç‚º sqrt(2/3) * a â‰ˆ 0.8165a)
    const h = scale * 0.8165; 
    const r = 22;

    // A å±¤ç”Ÿæˆå™¨ (ä¸­å¿ƒ + 6 é¡†ç’°ç¹)
    const getLayerA = (z) => [
        {x:0, y:0, z:z}, // ä¸­å¿ƒ
        {x:scale, y:0, z:z}, {x:scale*0.5, y:scale*0.866, z:z}, {x:-scale*0.5, y:scale*0.866, z:z},
        {x:-scale, y:0, z:z}, {x:-scale*0.5, y:-scale*0.866, z:z}, {x:scale*0.5, y:-scale*0.866, z:z}
    ];

    // B å±¤ç”Ÿæˆå™¨ (å¡«å…¥ A å±¤ç©ºéš™çš„ 3 é¡†)
    const getLayerB = (z) => [
        {x:scale*0.5, y:scale*0.288, z:z}, 
        {x:-scale*0.5, y:scale*0.288, z:z}, 
        {x:0, y:-scale*0.577, z:z}
    ];

    // --- å»ºç«‹å››å±¤å †ç© A1-B1-A2-B2 ---
    // ç‚ºäº†è®“ä¸­å¿ƒåŸå­åœ¨åº§æ¨™åŸé»ï¼Œæˆ‘å€‘é€™æ¨£å°é½Šï¼š
    const l1 = getLayerA(-2 * h);   // Index 0-6 (A1 æœ€åº•å±¤)
    const l2 = getLayerB(-h);       // Index 7-9 (B1)
    const l3 = getLayerA(0);        // Index 10-16 (A2 æ ¸å¿ƒä¸»è§’å±¤)
    const l4 = getLayerB(h);        // Index 17-19 (B2 å»¶ä¼¸å±¤)

    [...l1, ...l2, ...l3, ...l4].forEach((p, i) => {
        atoms.push({
            elem: elem, ...p, r: r, lpCount: 0,
            // å°‡ç¬¬ä¸‰å±¤çš„ä¸­å¿ƒåŸå­ (Index 10) è¨­ç‚ºä¸»è§’
            isRepresentative: (i === 10) 
        });
    });

    // --- å»ºç«‹éµçµé‚è¼¯ ---
    for (let i = 0; i < atoms.length; i++) {
        for (let j = i + 1; j < atoms.length; j++) {
            const d = Math.sqrt((atoms[i].x-atoms[j].x)**2 + (atoms[i].y-atoms[j].y)**2 + (atoms[i].z-atoms[j].z)**2);
            
            // è·é›¢ç´„ç­‰æ–¼ scale (a) çš„åˆ¤å®šç‚ºé„°å±…
            if (d > 10 && d < scale * 1.1) {
                // åˆ¤æ–·æ˜¯å¦ç‚ºå»¶ä¼¸å±¤ (L4 / Index 17-19) çš„é€£ç·š
                const isExt = (atoms[i].z > h/2 || atoms[j].z > h/2);
                
                // 1. åŒå±¤å…§éƒ¨çš„é€£ç·š (å…­è§’å¤–æ¡†èˆ‡å…§éƒ¨è¼»å°„)
                if (Math.abs(atoms[i].z - atoms[j].z) < 1) {
                    const isCenter = (Math.abs(atoms[i].x) < 1 && Math.abs(atoms[i].y) < 1) || 
                                     (Math.abs(atoms[j].x) < 1 && Math.abs(atoms[j].y) < 1);
                    
                    if (isCenter) {
                        bonds.push([i, j, "ionic_thin"]); // å…§éƒ¨è¼»å°„ç”¨ç´°ç·š
                    } else {
                        // å¤–éƒ¨å…­è§’æ¡†ï¼šL1åˆ°L3ç”¨ç²—æ¡†ï¼Œå»¶ä¼¸å±¤L4ç”¨ç´°ç·š
                        bonds.push([i, j, isExt ? "ionic_thin" : "ionic_thick"]);
                    }
                } 
                // 2. å±¤èˆ‡å±¤ä¹‹é–“çš„é€£ç·š (CN=12 çš„æ–œå‘æ¥è§¸)
                else {
                    bonds.push([i, j, "ionic_thin"]);
                }
            }
        }
    }

    // --- æ ¸å¿ƒå…­è§’æŸ±çš„ã€Œå‚ç›´ã€ç¨œç·š (L1 é ‚é»å°æ‡‰åˆ° L3 é ‚é») ---
    // è®“ä¸»è¦çš„æ™¶èƒæ¡†æ¶çœ‹èµ·ä¾†åƒä¸€å€‹å®Œæ•´çš„å…­è§’æŸ±
    for (let i = 1; i <= 6; i++) {
        bonds.push([i, i + 10, "ionic_thick"]);
    }

    addMol(`${elem}|${name}`, "Metal", "å…­æ–¹æœ€å¯†å †ç© (HCP)", "74%", "12", mp, bp, atoms, bonds, null,
        `<div class="info-section"><div class="info-title">ğŸ›‘ å…­æ–¹æœ€å¯†å †ç© (HCP)</div><div class="info-body">é‡‘å±¬ç¯„ä¾‹ï¼š<strong>${elem} (å¦‚é‚ã€é‹…)</strong>ã€‚<br>åˆ©ç”¨ç‡ 74%ã€‚æ¨¡å‹å±•ç¤º A-B-A-B å››å±¤å †ç©ï¼Œå»¶ä¼¸å‡ºä¸€å±¤ä¸‰è§’å½¢ B å±¤ã€‚<br><span style="color:#facc15">â˜… é»æ“Šç¬¬ä¸‰å±¤ä¸­å¿ƒåŸå­ï¼Œå¯è¦‹é…ä½æ•¸ç‚º 12 (åŒå±¤6ï¼Œä¸‹å±¤3ï¼Œä¸Šå±¤3)ã€‚</span></div></div>`);
    
    if(MOLECULE_DB[elem]) { 
        MOLECULE_DB[elem].isIonic = true; 
        MOLECULE_DB[elem].isMetal = true; 
        MOLECULE_DB[elem].edgeRelation = "c â‰ˆ 1.633 a";
    }
}

// åŸ·è¡Œé‡‘å±¬ç”Ÿæˆ
// 1A æ— (BCC)
addMetal_BCC("Li", "é‹°", "180.5", "1342");
addMetal_BCC("Na", "éˆ‰", "97.8", "883");
addMetal_BCC("K",  "é‰€", "63.5", "759");
addMetal_BCC("Rb", "éŠ£", "39.3", "688");
addMetal_BCC("Cs", "éŠ«", "28.4", "671");

// 2A æ—
addMetal_HCP("Be", "éˆ¹", "1287", "2469"); // HCP
addMetal_HCP("Mg", "é‚", "650", "1090");  // HCP
addMetal_FCC("Ca", "éˆ£", "842", "1484");  // FCC
addMetal_FCC("Sr", "é¶", "777", "1382");  // FCC
addMetal_BCC("Ba", "é‹‡", "727", "1897");  // BCC

// å…¶ä»–
addMetal_SC("Po", "é‡™", "254", "962");
addMetal_BCC("Fe", "éµ (Î±)", "1538", "2861");
addMetal_FCC("Cu", "éŠ…", "1085", "2562");
addMetal_FCC("Ag", "éŠ€", "961.8", "2162");
addMetal_FCC("Au", "é‡‘", "1064", "2970");
addMetal_FCC("Al", "é‹", "660", "2519");
addMetal_HCP("Zn", "é‹…", "419.5", "907");
addMetal_HCP("Ti", "éˆ¦", "1668", "3287");






/*
 ==========================================================================
 â˜… è¦–è¦ºéµé•·æ¨™æº–åƒè€ƒè¡¨ (Visual Bond Length Standards) v16.2
 ==========================================================================
 åŸºæº–ï¼šä»¥ 1,2-äºŒæ°¯ä¸™çƒ·ç‚ºéŒ¨é» (C-C ~ 70, C-H ~ 50, C-Cl ~ 75)
 
 [1] åŸå­è¦–è¦ºåŠå¾‘è²¢ç» (Base Radius Contribution)
 --------------------------------------------------------------------------
  - H (æ°«) .................... 15  (æœ€å°ï¼Œç¢ºä¿ç·Šæ¹Š)
  - Row 2 (C, N, O, F) ........ 35  (åŸºæº–)
  - Row 3 (Si, P, S, Cl) ...... 40  (ç•¥å¤§)
  - Row 4 (Br) ................ 45
  - Row 5 (I, Xe) ............. 50  (æœ€å¤§)

 [2] éµç´šä¿®æ­£ä¿‚æ•¸ (Bond Order Multiplier)
 --------------------------------------------------------------------------
  - å–®éµ (Single) ............. x 1.00
  - é›™éµ (Double) ............. x 0.90
  - åƒéµ (Triple) ............. x 0.85

 [3] å¸¸è¦‹éµé•·è¨ˆç®—ç¯„ä¾‹ (Calculated Examples)
 --------------------------------------------------------------------------
  Type      Calc (R1 + R2) * Multiplier      Final Value
  -------   ---------------------------      -----------
  H-H       (15 + 15) * 1.0                  30
  C-H       (35 + 15) * 1.0                  50  (åŸºæº–)
  N-H       (35 + 15) * 1.0                  50
  O-H       (35 + 15) * 1.0                  50
  P-H       (40 + 15) * 1.0                  55

  C-C       (35 + 35) * 1.0                  70  (åŸºæº–)
  C=C       (35 + 35) * 0.9                  63
  Câ‰¡C       (35 + 35) * 0.85                 60
  
  C-O       (35 + 35) * 1.0                  70
  C=O       (35 + 35) * 0.9                  63

  S-O       (40 + 35) * 1.0                  75
  S=O       (40 + 35) * 0.9                  68  (SO4, SO3)
  
  P-Cl      (40 + 40) * 1.0                  80  (PCl3)
  Xe=O      (50 + 35) * 0.9                  76  (XeO3)
  
  F-F       (35 + 35) * 1.0                  70
  Cl-Cl     (40 + 40) * 1.0                  80
  I-I       (50 + 50) * 1.0                  100
 ==========================================================================
*/






// ==========================================
// [æ•´ç†å¾Œ] è³‡æ–™æ³¨å…¥å€ (v14.0 å«ç†”æ²¸é»æ•¸æ“š)
// ==========================================

/// --- 1. åŸºç¤å…ƒç´ èˆ‡é›™åŸå­åˆ†å­ (éµé•·ä¿®æ­£: H=15, 2nd=35, 3rd=40, 4th=45, 5th=50 | Double x0.9, Triple x0.85) ---
const diatomicNames = {'H': 'æ°«|æ°«æ°£', 'N': 'æ°®|æ°®æ°£', 'O': 'æ°§|æ°§æ°£', 'F': 'æ°Ÿ|æ°Ÿæ°£', 'Cl': 'æ°¯|æ°¯æ°£', 'Br': 'æº´', 'I': 'ç¢˜'};
const diatomicProps = {'H': {mp: "-259.2", bp: "-252.9"}, 'N': {mp: "-210.0", bp: "-195.8"}, 'O': {mp: "-218.8", bp: "-183.0"}, 'F': {mp: "-219.7", bp: "-188.1"}, 'Cl': {mp: "-101.5", bp: "-34.0"}, 'Br': {mp: "-7.2", bp: "58.8"}, 'I': {mp: "113.7", bp: "184.3"}};
addMol("H2|æ°«æ°£|æ°«", "é›™åŸå­", "s-s", ["ç›´ç·šå‹", "Linear"], "-", "-259.2", "-252.9", [{elem:"H",x:-15,y:0,z:0},{elem:"H",x:15,y:0,z:0}], [[0,1,"single"]]);
addMol("N2|æ°®æ°£|æ°®", "é›™åŸå­", "sp", ["ç›´ç·šå‹", "Linear"], "-", "-210.0", "-195.8", [{elem:"N",x:-30,y:0,z:0},{elem:"N",x:30,y:0,z:0}], [[0,1,"triple"]]);
addMol("O2|æ°§æ°£|æ°§", "é›™åŸå­", "spÂ²", ["ç›´ç·šå‹", "Linear"], "-", "-218.8", "-183.0", [{elem:"O",x:-32,y:0,z:0},{elem:"O",x:32,y:0,z:0}], [[0,1,"double"]]);
addMol("F2|æ°Ÿæ°£|æ°Ÿ", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹", "Linear"], "-", "-219.7", "-188.1", [{elem:"F",x:-35,y:0,z:0},{elem:"F",x:35,y:0,z:0}], [[0,1,"single"]]);
addMol("Cl2|æ°¯æ°£|æ°¯", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹", "Linear"], "-", "-101.5", "-34.0", [{elem:"Cl",x:-40,y:0,z:0},{elem:"Cl",x:40,y:0,z:0}], [[0,1,"single"]]);
addMol("Br2|æº´", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹", "Linear"], "-", "-7.2", "58.8", [{elem:"Br",x:-45,y:0,z:0},{elem:"Br",x:45,y:0,z:0}], [[0,1,"single"]]);
addMol("I2|ç¢˜", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹", "Linear"], "-", "113.7", "184.3", [{elem:"I",x:-50,y:0,z:0},{elem:"I",x:50,y:0,z:0}], [[0,1,"single"]]);
["H2", "N2", "O2", "F2", "Cl2", "Br2", "I2"].forEach(key => {
    if (MOLECULE_DB[key]) MOLECULE_DB[key].pg = "Dinfh";
});

addMol("CO|ä¸€æ°§åŒ–ç¢³", "é›™åŸå­", "sp", ["ç›´ç·šå‹","Linear"], "-", "-205.0", "-191.5", [{elem:"C",x:-30,y:0,z:0,lp3d:[{x:-1,y:0,z:0}]}, {elem:"O",x:33,y:0,z:0,lp3d:[{x:1,y:0,z:0}]}], [[1,0,"coordinate_triple"]]);
addMol("NO|ä¸€æ°§åŒ–æ°®", "é›™åŸå­", "spÂ²", ["ç›´ç·šå‹","Linear"], "-", "-164", "-152", [{elem:"N",x:-32,y:0,z:0,radical:true,lp3d:[{x:-1.2,y:1.0,z:0.35},{x:-1.2,y:1.0,z:-0.35},{x:-1.2,y:-1.0,z:0}]},{elem:"O",x:32,y:0,z:0}], [[0,1,"double"]]);
addMol("CN-|æ°°æ ¹|æ°°é›¢å­", "é›™åŸå­", "sp", ["ç›´ç·šå‹","Linear"], "-", "-", "-", [{elem:"C",x:-30,y:0,z:0,lp3d:[{x:-1,y:0,z:0}]},{elem:"N",x:30,y:0,z:0,lp3d:[{x:1,y:0,z:0}]}], [[0,1,"triple"]]);
addMol("O22-|éæ°§æ ¹é›¢å­", "O", "spÂ³", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"O",x:-35,y:0,z:0,lp3d:[{x:-1,y:1.5,z:0},{x:-1,y:-0.75,z:1.3},{x:-1,y:-0.75,z:-1.3}]}, {elem:"O",x:35,y:0,z:0,lp3d:[{x:1,y:1.5,z:0},{x:1,y:-0.75,z:1.3},{x:1,y:-0.75,z:-1.3}]}], [[0,1]]);
addMol("C22-|ç¢³åŒ–ç‰©é›¢å­", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"C",x:-30,y:0,z:0,lp3d:[{x:-1,y:0,z:0}]}, {elem:"C",x:30,y:0,z:0,lp3d:[{x:1,y:0,z:0}]}], [[0,1,"triple"]]);

// --- 2. é¹µåŒ–æ°« (HX) ---
addMol("HF|æ°ŸåŒ–æ°«", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹","Linear"], "-", "-83.6", "19.5", [{elem:"F",x:-25,y:0,z:0}, {elem:"H",x:25,y:0,z:0}], [[0,1]]);
addMol("HCl|æ°¯åŒ–æ°«", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹","Linear"], "-", "-114.2", "-85.1", [{elem:"Cl",x:-28,y:0,z:0}, {elem:"H",x:28,y:0,z:0}], [[0,1]]);
addMol("HBr|æº´åŒ–æ°«", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹","Linear"], "-", "-86.8", "-66.4", [{elem:"Br",x:-30,y:0,z:0}, {elem:"H",x:30,y:0,z:0}], [[0,1]]);
addMol("HI|ç¢˜åŒ–æ°«", "é›™åŸå­", "spÂ³", ["ç›´ç·šå‹","Linear"], "-", "-50.8", "-35.4", [{elem:"I",x:-33,y:0,z:0}, {elem:"H",x:33,y:0,z:0}], [[0,1]]);

// æ‰¹æ¬¡è¨­å®šç•°æ ¸é›™åŸå­åˆ†å­/é›¢å­ç‚º Cinfv (ç›´ç·šéå°ç¨±)
["CO", "NO", "CN-", "HF", "HCl", "HBr", "HI"].forEach(key => {
    if (MOLECULE_DB[key]) MOLECULE_DB[key].pg = "Cinfv";
});

// æ‰¹æ¬¡è¨­å®šåŒæ ¸é›™åŸå­é›¢å­ç‚º Dinfh (ç›´ç·šä¸­å¿ƒå°ç¨±)
["O22-", "C22-"].forEach(key => {
    if (MOLECULE_DB[key]) MOLECULE_DB[key].pg = "Dinfh";
});

// --- 3. å¸¸è¦‹ç„¡æ©Ÿåˆ†å­ (H2O, NH3, CH4 ç­‰) ---
addMol("CH4|ç”²çƒ·", "C", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-182.5", "-161.5", getTetra("C","H", 50), [[0,1],[0,2],[0,3],[0,4]], null, 
    `<div class="info-section">
        <div class="info-title">âš—ï¸ ç‰©è³ªæ€§è³ª</div>
        <div class="info-body">
            <span class="highlight-title">1. ç«‹é«”çµæ§‹ï¼š</span>ä¸­å¿ƒç¢³åŸå­æ¡å– <strong>spÂ³ æ··æˆè»ŒåŸŸ</strong>ã€‚ç”±æ–¼å‘¨åœé€£æ¥å››å€‹ç›¸åŒçš„æ°«åŸå­ä¸”ç„¡å­¤å°é›»å­ï¼Œå››å€‹ C-H éµä¹‹é–“çš„é›»å­æ–¥åŠ›å®Œå…¨å‡ç­‰ï¼Œæ§‹æˆäº†å®Œç¾çš„<strong>æ­£å››é¢é«”</strong>çµæ§‹ï¼Œéµè§’ç‚º <strong>109.5Â°</strong>ã€‚<br>
            <span class="highlight-title">2. ç‰©ç†æ€§è³ªï¼š</span>å¸¸æº«å¸¸å£“ä¸‹ç‚ºç„¡è‰²ã€ç„¡å‘³ã€ç„¡æ¯’çš„æ°£é«”ï¼ˆå®¶ç”¨å¤©ç„¶æ°£çš„è‡­å‘³æ˜¯ç‚ºäº†å®‰å…¨è€Œæ·»åŠ çš„ç¡«é†‡ï¼‰ã€‚å±¬æ–¼å®Œå…¨å°ç¨±çš„<strong>éæ¥µæ€§åˆ†å­</strong>ï¼Œé›£æº¶æ–¼æ°´ã€‚ç”±æ–¼åˆ†å­é‡å°ä¸”åˆ†å­é–“åƒ…æœ‰å¾®å¼±çš„<strong>å‡¡å¾—ç“¦åŠ›</strong>ï¼ˆå€«æ•¦åˆ†æ•£åŠ›ï¼‰ï¼Œå› æ­¤ç†”æ²¸é»æ¥µä½ã€‚<br>
            <span class="highlight-title">3. åŒ–å­¸æ€§è³ªï¼š</span>åŒ–å­¸æ€§è³ªç›¸ç•¶ç©©å®šï¼Œåœ¨ä¸€èˆ¬æ¢ä»¶ä¸‹ä¸èˆ‡å¼·é…¸ã€å¼·é¹¼æˆ–å¼·æ°§åŒ–åŠ‘åæ‡‰ã€‚å…·æœ‰å¯ç‡ƒæ€§ï¼Œåœ¨ç©ºæ°£ä¸­å®Œå…¨ç‡ƒç‡’ç”ŸæˆäºŒæ°§åŒ–ç¢³èˆ‡æ°´ï¼›åœ¨ç´«å¤–ç·šå…‰ç…§ä¸‹ï¼Œå¯èˆ‡é¹µç´ ï¼ˆå¦‚æ°¯æ°£ï¼‰ç™¼ç”Ÿé€£é–çš„<strong>è‡ªç”±åŸºå–ä»£åæ‡‰</strong>ã€‚
        </div>
    </div>
    <div class="info-section" style="margin-top: 12px; border-top: 1px dashed rgba(255,255,255,0.2); padding-top: 10px;">
        <div class="info-title">ğŸ­ ç”Ÿæ´»æ‡‰ç”¨</div>
        <div class="info-body">
            <span class="highlight-title">1. æ½”æ·¨èƒ½æº (å¤©ç„¶æ°£)ï¼š</span>ç”²çƒ·æ˜¯<strong>å¤©ç„¶æ°£</strong>çš„ä¸»è¦æˆåˆ† (å«é‡ç´„ 90% ä»¥ä¸Š)ã€‚å…¶æ°«ç¢³æ¯” (H/C ratio) æ˜¯æ‰€æœ‰çƒ´é¡ä¸­æœ€é«˜çš„ï¼Œå› æ­¤ç‡ƒç‡’æ™‚ç”¢ç”Ÿçš„å–®ä½ç†±å€¼æ¥µé«˜ï¼Œä¸”ç¢³æ’æ”¾é‡é ä½æ–¼ç…¤ç‚­èˆ‡çŸ³æ²¹ï¼Œæ˜¯ç¾ä»£ç™¼é›»èˆ‡å®¶åº­çƒ¹é£ªçš„é‡è¦ç‡ƒæ–™ã€‚<br>
            <span class="highlight-title">2. æœªä¾†èƒ½æº (å¯ç‡ƒå†°)ï¼š</span>åœ¨æ·±æµ·é«˜å£“ä½æº«çš„ç’°å¢ƒä¸‹ï¼Œç”²çƒ·åˆ†å­æœƒè¢«æ°´åˆ†å­åŒ…è¦†ï¼Œå½¢æˆç± ç‹€çµæ™¶çµæ§‹çš„<strong>ã€Œç”²çƒ·æ°´åˆç‰©ã€</strong>ã€‚å¤–è§€æ™¶ç‘©å‰”é€åƒå†°å¡Šï¼Œå»å¯ä»¥ç›´æ¥é»ç«ç‡ƒç‡’ï¼Œå…¶è˜Šè—é‡æ¥µå¤§ï¼Œè¢«è¦–ç‚ºæœªä¾†æœ€å…·æ½›åŠ›çš„æˆ°ç•¥èƒ½æºã€‚<br>
            <span class="highlight-title">3. æº«å®¤æ°£é«”æ•ˆæ‡‰ï¼š</span>é›–ç„¶å¤§æ°£ä¸­å«é‡é ä½æ–¼äºŒæ°§åŒ–ç¢³ï¼Œä½†ç”²çƒ·çš„<strong>å…¨çƒæš–åŒ–æ½›å‹¢ (GWP)</strong> ç´„æ˜¯ COâ‚‚ çš„ 25 å€ã€‚é€™æ˜¯å› ç‚ºå…¶åˆ†å­çµæ§‹ä¸­ C-H éµçš„ç‰¹å®šéœ‡å‹•æ¨¡å¼ï¼Œèƒ½éå¸¸æœ‰æ•ˆåœ°å¸æ”¶åœ°è¡¨åå°„çš„ç´…å¤–ç·šè¼»å°„ç†±ï¼Œæ˜¯é€ æˆæ°£å€™è®Šé·çš„é—œéµæ°£é«”ä¹‹ä¸€ã€‚
        </div>
    </div>`, "Td");

addMol("SiH4|çŸ½çƒ·", "Si", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-185", "-112", getTetra("Si","H", 55), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td");
addMol("NH3|æ°¨ç³»åˆ—", "N", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "106.7Â°", "-77.7", "-33.3", [], [], { "NH3|æ°¨|æ°¨æ°£": {pg: "C3v", mp: "-77.7", bp: "-33.3", desc: "<strong>æ°¨ (Ammonia)</strong><br>ä¸‰è§’éŒå½¢ï¼Œå…·æœ‰ä¸€å°å­¤å°é›»å­ï¼Œç‚ºå¼±é¹¼ã€‚", atoms: [{elem:"N",x:0,y:10,z:0,lpCount:1}, {elem:"H",x:0,y:-25,z:40}, {elem:"H",x:35,y:-25,z:-20}, {elem:"H",x:-35,y:-25,z:-20}], bonds: [[0,1],[0,2],[0,3]] }, "NH4+|éŠ¨æ ¹é›¢å­|éŠ¨é›¢å­|éŠ¨æ ¹": {pg: "Td", mp: "-", bp: "-", desc: "<strong>éŠ¨é›¢å­</strong><br>æ­£å››é¢é«”çµæ§‹ï¼Œæ˜¯æ°¨æ°£èˆ‡æ°«é›¢å­çµåˆçš„ç”¢ç‰©ã€‚", atoms: getTetra("N","H", 50), bonds: [[0,1],[0,2],[0,3],[0,4]] }, "NH2-|èƒºåŸºé™°é›¢å­|èƒºåŸºè² é›¢å­": {pg: "C2v", mp: "-", bp: "-", desc: "<strong>èƒºåŸºè² é›¢å­</strong><br>æ°¨å¤±å»ä¸€å€‹è³ªå­å¾Œçš„å¼·é¹¼æ€§é™°é›¢å­ï¼ŒVå‹çµæ§‹ï¼Œæœ‰å…©å°å­¤å°é›»å­ã€‚", atoms: [{elem:"N",x:0,y:5,z:0,lpCount:2},{elem:"H",x:35,y:-30,z:0},{elem:"H",x:-35,y:-30,z:0}], bonds: [[0,1],[0,2]] }});
addMol("PH3|ç£·åŒ–æ°«ç³»åˆ—", "P", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "93.3Â°", "-133.8", "-87.7", [], [], { "PH3|ç£·åŒ–æ°«": {pg: "C3v", mp: "-133.8", bp: "-87.7", desc: "<strong>ç£·åŒ–æ°«</strong><br>åŠ‡æ¯’æ°£é«”ï¼Œéµè§’æ¥è¿‘90åº¦(pè»ŒåŸŸç‰¹æ€§)ï¼Œä½†VSEPRè¦–ç‚ºspÂ³ã€‚", atoms: [{elem:"P",x:0,y:15,z:0,lpCount:1}, {elem:"H",x:0,y:-30,z:45}, {elem:"H",x:39,y:-30,z:-22}, {elem:"H",x:-39,y:-30,z:-22}], bonds: [[0,1],[0,2],[0,3]] }, "PH4+|é»é›¢å­": {pg: "Td", mp: "-", bp: "-", desc: "<strong>é»é›¢å­</strong><br>çµæ§‹é¡ä¼¼éŠ¨æ ¹ï¼Œç”±è†¦èˆ‡æ°«é›¢å­å½¢æˆã€‚", atoms: getTetra("P","H", 55), bonds: [[0,1],[0,2],[0,3],[0,4]] }});
// AA
addMol("H2O|æ°´ç³»åˆ—", "O", "spÂ³", ["è§’å½¢","Bent"], "104.5Â°", "0.0", "100.0", [], [], { "H2O|æ°´|æ°´åˆ†å­": {pg: "C2v",mp: "0.0", bp: "100.0", desc: "<strong>æ°´</strong><br>ç”Ÿå‘½çš„åŸºçŸ³ï¼ŒVå‹çµæ§‹ï¼Œä¸­å¿ƒæ°§åŸå­æœ‰å…©å°å­¤å°é›»å­ã€‚", atoms: [{elem:"O",x:0,y:5,z:0,lpCount:2}, {elem:"H",x:38,y:-28,z:0}, {elem:"H",x:-38,y:-28,z:0}], bonds: [[0,1],[0,2]] }, "H3O+|æ°´åˆæ°«é›¢å­|é‹é›¢å­": { pg: "C3v",mp: "-", bp: "-", desc: "<strong>æ°´åˆæ°«é›¢å­</strong><br>æ°´ä¸­æ°«é›¢å­çš„å¯¦éš›å­˜åœ¨å½¢å¼ï¼Œä¸‰è§’éŒå½¢ã€‚", atoms: [{elem:"O",x:0,y:10,z:0,lpCount:1}, {elem:"H",x:0,y:-25,z:40}, {elem:"H",x:35,y:-25,z:-20}, {elem:"H",x:-35,y:-25,z:-20}], bonds: [[0,1],[0,2],[0,3]] }, "OH-|æ°«æ°§æ ¹|æ°«æ°§æ ¹é›¢å­": { pg: "Cinfv",mp: "-", bp: "-", desc: "<strong>æ°«æ°§æ ¹</strong><br>å¼·é¹¼çš„ç‰¹å¾µé›¢å­ï¼Œæ°§åŸå­å‘¨åœæœ‰ä¸‰å°å­¤å°é›»å­ï¼Œå¸¶è² é›»ã€‚", atoms: [{elem:"O",x:-20,y:0,z:0,lpCount:3},{elem:"H",x:25,y:0,z:0}], bonds: [[0,1]] }});


addMol("H2S|ç¡«åŒ–æ°«ç³»åˆ—", "S", "spÂ³", ["è§’å½¢","Bent"], "92.1Â°", "-85.5", "-60.3", [], [], { "H2S|ç¡«åŒ–æ°«|æ°«ç¡«é…¸": {pg: "C2v", mp: "-85.5", bp: "-60.3", desc: "<strong>ç¡«åŒ–æ°«</strong><br>å…·æœ‰è…æ•—é›è›‹å‘³çš„æ°£é«”ï¼ŒVå‹çµæ§‹ã€‚", atoms: [{elem:"S",x:0,y:5,z:0,lpCount:2}, {elem:"H",x:40,y:-35,z:0}, {elem:"H",x:-40,y:-35,z:0}], bonds: [[0,1],[0,2]] }, "HS-|ç¡«æ°«æ ¹": {pg: "Cinfv", mp: "-", bp: "-", desc: "<strong>æ°«ç¡«æ ¹</strong><br>ç¡«åŒ–æ°«çš„ä¸€ç´šè§£é›¢ç”¢ç‰©ï¼Œç¡«åŸå­æœ‰ä¸‰å°å­¤å°é›»å­ã€‚", atoms: [{elem:"S",x:-20,y:0,z:0,lpCount:3},{elem:"H",x:30,y:0,z:0}], bonds: [[0,1]] }});

// --- 4. é¹µåŒ–ç‰©ç³»åˆ— (å…¨è³‡æ–™è£œå®Œèˆ‡éµé•·ä¿®æ­£) ---
const halideProps = { "BF3": ["-126.8", "-100.3"], "BCl3": ["-107", "12.6"], "BBr3": ["-46", "91.3"], "BI3": ["49.9", "210"], "AlF3": ["1290 (æ˜‡è¯)", "-"], "AlCl3": ["192.4", "120 (æ˜‡è¯)"], "AlBr3": ["97.5", "255"], "AlI3": ["191", "360"], "CF4": ["-183.6", "-127.8"], "CCl4": ["-22.9", "76.7"], "CBr4": ["90.1", "189.5"], "CI4": ["171 (åˆ†è§£)", "-"], "SiF4": ["-90", "-86 (æ˜‡è¯)"], "SiCl4": ["-70", "57.7"], "SiBr4": ["5", "154"], "SiI4": ["120.5", "287.5"], "NF3": ["-206.8", "-129"], "NCl3": ["-40", "71"], "NBr3": ["-100", "çˆ†ç‚¸"], "NI3": ["-", "çˆ†ç‚¸"], "PF3": ["-151.5", "-101.8"], "PCl3": ["-93.6", "76.1"], "PBr3": ["-41.5", "173.2"], "PI3": ["61", "åˆ†è§£"], "OF2": ["-223.8", "-144.8"], "OCl2": ["-135", "2.0"], "OBr2": ["-", "-"], "OI2": ["-", "-"], "SF2": ["-", "-"], "SCl2": ["-121", "59 (åˆ†è§£)"], "SBr2": ["-", "-"], "SI2": ["-", "-"] };
const haloNames = {'F':'æ°Ÿ', 'Cl':'æ°¯', 'Br':'æº´', 'I':'ç¢˜'};

['F','Cl','Br','I'].forEach(X => {
    const hn = haloNames[X]; let rX = (X==='F'?35: (X==='Cl'?40: (X==='Br'?45:50)));
    
    // BX3 ç³»åˆ—
    let p = halideProps[`B${X}3`] || ["-","-"]; 
    addMol(`B${X}3|ä¸‰${hn}åŒ–ç¡¼`, "B", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", p[0], p[1], getTrigPlanar("B", X, 35+rX), [[0,1],[0,2],[0,3]], null, null, "D3h");
    
    // AlX3 ç³»åˆ—
    p = halideProps[`Al${X}3`] || ["-","-"]; 
    addMol(`Al${X}3|ä¸‰${hn}åŒ–é‹`, "Al", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", p[0], p[1], getTrigPlanar("Al", X, 40+rX), [[0,1],[0,2],[0,3]], null, null, "D3h");
    
    // CX4 ç³»åˆ—
    p = halideProps[`C${X}4`] || ["-","-"]; 
    addMol(`C${X}4|å››${hn}åŒ–ç¢³|å››${hn}ç”²çƒ·`, "C", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", p[0], p[1], getTetra("C", X, 35+rX), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td");
    
    // SiX4 ç³»åˆ—
    if(X !== 'Cl') { 
        p = halideProps[`Si${X}4`] || ["-","-"]; 
        addMol(`Si${X}4|å››${hn}åŒ–çŸ½`, "Si", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", p[0], p[1], getTetra("Si", X, 40+rX), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td"); 
    }
    
    // NX3 ç³»åˆ—
    p = halideProps[`N${X}3`] || ["-","-"]; 
    let dN = 35+rX, hN=dN*0.85, vN=dN*0.5; 
    addMol(`N${X}3|ä¸‰${hn}åŒ–æ°®`, "N", "spÂ³", ["è§’éŒå½¢","Pyramidal"], (X==='F'?"102.3Â°":(X==='Cl'?"107.1Â°":(X==='Br'?"108Â°":"110Â°"))), p[0], p[1], [{elem:"N",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:0}]},{elem:X,x:0,y:-10,z:hN},{elem:X,x:hN*0.866,y:-10,z:-hN*0.5},{elem:X,x:-hN*0.866,y:-10,z:-hN*0.5}], [[0,1],[0,2],[0,3]], null, null, "C3v");
    
    // PX3 ç³»åˆ—
    if(X !== 'Cl') { 
        p = halideProps[`P${X}3`] || ["-","-"]; 
        let dP = 40+rX, hP=dP*0.85, vP=dP*0.5; 
        addMol(`P${X}3|ä¸‰${hn}åŒ–ç£·`, "P", "spÂ³", ["è§’éŒå½¢","Pyramidal"], (X==='F'?"97.8Â°":(X==='Cl'?"100.3Â°":(X==='Br'?"101.5Â°":"102Â°"))), p[0], p[1], [{elem:"P",x:0,y:20,z:0,lp3d:[{x:0,y:1,z:0}]},{elem:X,x:0,y:-15,z:hP},{elem:X,x:hP*0.866,y:-15,z:-hP*0.5},{elem:X,x:-hP*0.866,y:-15,z:-hP*0.5}], [[0,1],[0,2],[0,3]], null, null, "C3v"); 
    }
    
    // OX2 ç³»åˆ—
    p = halideProps[`O${X}2`] || ["-","-"]; 
    let dO = 35+rX; 
    addMol(`O${X}2|äºŒ${hn}åŒ–æ°§`, "O", "spÂ³", ["è§’å½¢","Bent"], (X==='F'?"103.3Â°":(X==='Cl'?"110.9Â°":"114Â°")), p[0], p[1], [{elem:"O",x:0,y:0,z:0,lpCount:2},{elem:X,x:dO*0.8,y:-dO*0.6,z:0},{elem:X,x:-dO*0.8,y:-dO*0.6,z:0}], [[0,1],[0,2]], null, null, "C2v");
    
    // SX2 ç³»åˆ—
    p = halideProps[`S${X}2`] || ["-","-"]; 
    let dS = 40+rX; 
    addMol(`S${X}2|äºŒ${hn}åŒ–ç¡«`, "S", "spÂ³", ["è§’å½¢","Bent"], (X==='F'?"98.2Â°":(X==='Cl'?"102.7Â°":"104Â°")), p[0], p[1], [{elem:"S",x:0,y:0,z:0,lpCount:2},{elem:X,x:dS*0.85,y:-dS*0.55,z:0},{elem:X,x:-dS*0.85,y:-dS*0.55,z:0}], [[0,1],[0,2]], null, null, "C2v");
});


// [ä¿ç•™] SiCl4 è©³ç´°è³‡æ–™
addMol("SiCl4|å››æ°¯åŒ–çŸ½|Silicon Tetrachloride", "Si", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-70", "57.7", getTetra("Si", "Cl", 80), [[0,1],[0,2],[0,3],[0,4]], null,
    `<div class="info-section">
        <div class="info-title">âš—ï¸ ç‰©è³ªæ€§è³ª</div>
        <div class="info-body">
            <span class="highlight-title">1. ç«‹é«”çµæ§‹ï¼š</span>ä¸­å¿ƒçŸ½åŸå­æ¡å– <strong>spÂ³ æ··æˆ</strong>ï¼Œèˆ‡åŒæ—çš„å››æ°¯åŒ–ç¢³ (CClâ‚„) å…·æœ‰ç›¸åŒçš„<strong>æ­£å››é¢é«”</strong>å¹¾ä½•çµæ§‹ï¼Œéµè§’ç‚º <strong>109.5Â°</strong>ã€‚<br>
            <span class="highlight-title">2. ç‰©ç†æ€§è³ªï¼š</span>å¸¸æº«ä¸‹ç‚ºç„¡è‰²ã€æ˜“æ®ç™¼çš„æ¶²é«”ï¼Œå…·æœ‰å¼·çƒˆçš„åˆºé¼»æ°£å‘³ã€‚é›–ç„¶ Si-Cl éµæ˜¯æ¥µæ€§å…±åƒ¹éµï¼Œä½†ç”±æ–¼åˆ†å­å°ç¨±æ€§é«˜ï¼Œå¶æ¥µçŸ©äº’ç›¸æŠµéŠ·ï¼Œæ•´é«”ç‚º<strong>éæ¥µæ€§åˆ†å­</strong>ã€‚<br>
            <span class="highlight-title">3. åŒ–å­¸æ€§è³ªï¼š</span>èˆ‡åŒ–å­¸æ€§è³ªå®‰å®šçš„ CClâ‚„ ä¸åŒï¼ŒSiClâ‚„ æ¥µæ˜“ç™¼ç”Ÿ<strong>æ°´è§£åæ‡‰</strong>ã€‚é€™æ˜¯å› ç‚ºçŸ½åŸå­çš„åŸå­åŠå¾‘è¼ƒå¤§ï¼Œä¸”æ“æœ‰<strong>ç©º d è»ŒåŸŸ</strong>ï¼Œèƒ½æ¥å—æ°´åˆ†å­çš„æ°§åŸå­é€²è¡Œè¦ªæ ¸æ”»æ“Šï¼Œåæ‡‰å¾Œç”ŸæˆçŸ½é…¸ä¸¦ç”¢ç”Ÿå¤§é‡çš„æ°¯åŒ–æ°« (HCl) ç™½ç…™ã€‚
        </div>
    </div>
    <div class="info-section" style="margin-top: 12px; border-top: 1px dashed rgba(255,255,255,0.2); padding-top: 10px;">
        <div class="info-title">ğŸ­ ç”Ÿæ´»æ‡‰ç”¨</div>
        <div class="info-body">
            <span class="highlight-title">1. æ™¶ç‰‡è£½é€  (å¤šæ™¶çŸ½)ï¼š</span>å®ƒæ˜¯åŠå°é«”ç”¢æ¥­çš„åŸºçŸ³ã€‚é€é<strong>è¥¿é–€å­æ³• (Siemens process)</strong>ï¼Œå°‡é«˜ç´”åº¦çš„ SiClâ‚„ èˆ‡æ°«æ°£åœ¨ 1100Â°C é«˜æº«ä¸‹åæ‡‰é‚„åŸï¼Œå¯è£½é€ å‡ºç´”åº¦é«˜é” 99.9999999% (9N) çš„<strong>é›»å­ç´šå¤šæ™¶çŸ½</strong>ï¼Œç”¨æ–¼ç”Ÿç”¢é›»è…¦æ™¶ç‰‡èˆ‡å¤ªé™½èƒ½é›»æ± ã€‚<br>
            <span class="highlight-title">2. å…‰çº–é€šè¨Šæ ¸å¿ƒï¼š</span>åœ¨å…‰çº–è£½ç¨‹ä¸­ï¼ŒSiClâ‚„ æ˜¯æœ€é—œéµçš„åŸæ–™ã€‚é€éæ°£ç›¸æ²‰ç©æ³•å°‡å…¶é«˜æº«æ°§åŒ–ï¼Œèƒ½ç”ŸæˆæŠ˜å°„ç‡æ¥µé«˜ä¸”ç„¡é›œè³ªçš„äºŒæ°§åŒ–çŸ½ (SiOâ‚‚)ï¼Œæ§‹æˆå…‰çº–å…§å±¤å‚³è¼¸è¨Šè™Ÿçš„ç»ç’ƒæ ¸å¿ƒã€‚<br>
            <span class="highlight-title">3. è»äº‹ç…™éœ§å½ˆï¼š</span>æ—©æœŸè»äº‹ä¸Šåˆ©ç”¨å…¶ã€Œæ¥µæ˜“æ°´è§£ã€çš„ç‰¹æ€§è£½ä½œç…™éœ§å½ˆã€‚ç•¶æ¶²æ…‹ SiClâ‚„ ç‚¸é–‹æ¥è§¸ç©ºæ°£ä¸­çš„æ°´æ°£æ™‚ï¼Œæœƒç¬é–“ç”¢ç”Ÿæ¥µæ¿ƒå¯†çš„ç™½è‰²é…¸éœ§ (HCl)ï¼Œèƒ½æœ‰æ•ˆé®è”½è¦–ç·šï¼Œä½†å› å…·æœ‰æ¯’æ€§èˆ‡è…è•æ€§ï¼Œç¾ä»£å·²è¼ƒå°‘ä½¿ç”¨ã€‚
        </div>
    </div>`
,"Td");

// [ä¿ç•™] PCl3 è©³ç´°è³‡æ–™
addMol("PCl3|ä¸‰æ°¯åŒ–ç£·|Phosphorus Trichloride", "P", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "96-100Â°", "-93.6", "76.1", [{elem:"P",x:0,y:20,z:0,lp3d:[{x:0,y:1,z:0}]},{elem:"Cl",x:0,y:-15,z:68},{elem:"Cl",x:59,y:-15,z:-34},{elem:"Cl",x:-59,y:-15,z:-34}], [[0,1],[0,2],[0,3]], null,
    `<div class="info-section">
        <div class="info-title">âš—ï¸ ç‰©è³ªæ€§è³ª</div>
        <div class="info-body">
            <span class="highlight-title">1. ç«‹é«”çµæ§‹ï¼š</span>ä¸­å¿ƒç£·åŸå­æ¡å– <strong>spÂ³ æ··æˆ</strong>ã€‚ç”±æ–¼å…·æœ‰ä¸€å°æœªå…±ç”¨é›»å­å° (Lone Pair)ï¼Œå…¶å°éµçµé›»å­çš„æ–¥åŠ›è¼ƒå¤§ï¼Œå°è‡´ P-Cl éµè§’è¢«å£“ç¸®è‡³ç´„ <strong>100Â°</strong>ï¼Œå½¢æˆ<strong>ä¸‰è§’éŒå½¢</strong>çµæ§‹ã€‚<br>
            <span class="highlight-title">2. ç‰©ç†æ€§è³ªï¼š</span>å¸¸æº«ä¸‹ç‚ºç„¡è‰²æˆ–å¾®é»ƒè‰²çš„æ¶²é«”ï¼Œæœƒç™¼ç…™ã€‚å…·æœ‰è¼ƒä½çš„æ²¸é»èˆ‡å¼·çƒˆåˆºé¼»å‘³ï¼Œå¯æº¶æ–¼è‹¯ã€æ°¯ä»¿ç­‰æœ‰æ©Ÿæº¶åŠ‘ã€‚<br>
            <span class="highlight-title">3. åŒ–å­¸æ€§è³ªï¼š</span>P-Cl éµæ¥µæ€§å¤§ä¸”åæ‡‰æ€§æ¥µé«˜ï¼Œé‡æ°´æœƒåŠ‡çƒˆ<strong>æ°´è§£</strong>ä¸¦æ”¾ç†±ï¼Œç”Ÿæˆäºç£·é…¸ (Hâ‚ƒPOâ‚ƒ) èˆ‡é¹½é…¸éœ§ã€‚å› ç£·åŸå­ä¸Šæœ‰ä¸€å°å­¤å°é›»å­ï¼Œå¯ä½œç‚º<strong>è·¯æ˜“æ–¯é¹¼</strong>åƒèˆ‡é…ä½åæ‡‰ã€‚
        </div>
    </div>
    <div class="info-section" style="margin-top: 12px; border-top: 1px dashed rgba(255,255,255,0.2); padding-top: 10px;">
        <div class="info-title">ğŸ­ ç”Ÿæ´»æ‡‰ç”¨</div>
        <div class="info-body">
            <span class="highlight-title">1. é™¤è‰åŠ‘åŸæ–™ (å˜‰ç£·å¡)ï¼š</span>å·¥æ¥­ä¸Šæœ€å¤§å®—çš„ç”¨é€”æ˜¯ä½œç‚ºä¸­é–“é«”ï¼Œç”¨æ–¼åˆæˆå»£æ•ˆæ€§é™¤è‰åŠ‘<strong>å˜‰ç£·å¡ (Glyphosate)</strong>ï¼Œé€™æ˜¯ç›®å‰å…¨çƒè¾²æ¥­ä½¿ç”¨é‡æœ€å¤§çš„è¾²è—¥ä¹‹ä¸€ã€‚<br>
            <span class="highlight-title">2. æœ‰æ©Ÿåˆæˆ (æ°¯åŒ–åŠ‘)ï¼š</span>åœ¨è£½è—¥èˆ‡æœ‰æ©ŸåŒ–å­¸å¯¦é©—å®¤ä¸­ï¼Œå®ƒæ˜¯ä¸å¯æˆ–ç¼ºçš„è©¦åŠ‘ã€‚å°ˆé–€ç”¨ä¾†å°‡æœ‰æ©Ÿåˆ†å­ä¸­çš„<strong>ç¾¥åŸº (-OH)</strong> å–ä»£ç‚ºæ°¯åŸå­ï¼Œæˆ–æ˜¯å°‡ç¾§é…¸è½‰åŒ–ç‚ºæ´»æ€§æ¥µé«˜çš„é†¯æ°¯ï¼Œæ˜¯åˆæˆæŸ“æ–™èˆ‡è—¥ç‰©çš„é‡è¦æ­¥é©Ÿã€‚<br>
            <span class="highlight-title">3. å¡‘è† æ·»åŠ åŠ‘ï¼š</span>å¯ç”¨æ–¼è£½é€ å«ç£·çš„<strong>é˜»ç‡ƒåŠ‘</strong>èˆ‡å¡‘åŒ–åŠ‘ã€‚é€™äº›æ·»åŠ åŠ‘èƒ½è®“é›»å­ç”¢å“çš„å¡‘è† å¤–æ®¼åœ¨å—ç†±æ™‚ä¸æ˜“ç‡ƒç‡’ï¼Œå¤§å¹…æå‡ç”¢å“å®‰å…¨æ€§ã€‚
        </div>
    </div>`
,"C3v");




// --- 5. ç¢³èˆ‡å…¶ä»–æ°§åŒ–ç‰© (ç›´ç·šå‹/å¹³é¢å‹) ---
addMol("CO2|äºŒæ°§åŒ–ç¢³|ä¹¾å†°", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-78.5 (æ˜‡è¯)", "-56.6", getLinear("C","O", 70), [[0,1,"double"],[0,2,"double"]], null, null, "Dinfh");
addMol("CS2|äºŒç¡«åŒ–ç¢³", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-111.6", "46.2", getLinear("C","S", 75), [[0,1,"double"],[0,2,"double"]], null, null, "Dinfh");
addMol("BeCl2|äºŒæ°¯åŒ–éˆ¹", "Be", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "399", "482", getLinear("Be","Cl", 75), [[0,1], [0,2]], null, null, "Dinfh");
addMol("BCl3|ä¸‰æ°¯åŒ–ç¡¼", "B", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", "-107", "12.6", getTrigPlanar("B","Cl", 75), [[0,1], [0,2], [0,3]], null, null, "D3h");
addMol("SO2|äºŒæ°§åŒ–ç¡«", "S", "spÂ²", ["è§’å½¢","Bent"], "119Â°", "-72", "-10", 
    [
        {elem:"S", x:0, y:15, z:0, lpCount:1, lp3d:[{x:0,y:1,z:0}]}, 
        {elem:"O", x:55, y:-30, z:0}, 
        {elem:"O", x:-55, y:-30, z:0}
    ], 
    // é è¨­çµ¦å…©å€‹é›™éµ (æ“´å¤§å…«éš…é«”ç‹€æ…‹)ï¼Œè®“ç¨‹å¼å»åˆ‡æ›
    [[0,1,"double"], [0,2,"double"]], null, null, "C2v");
addMol("SO3|ä¸‰æ°§åŒ–ç¡«", "S", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", "16.9", "44.8", getTrigPlanar("S","O", 68), [[0,1,"double"],[0,2,"double"],[0,3,"double"]], null, null, "D3h");
addMol("O3|è‡­æ°§", "O", "spÂ²", ["è§’å½¢","Bent"], "117Â°", "-192.2", "-112", [{elem:"O",x:0,y:10,z:0,lp3d:[{x:0,y:1,z:0}]},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0,lpCount:3}], [[0,1,"double"],[0,2,"coordinate"]], null, null, "C2v");
addMol("NO2|äºŒæ°§åŒ–æ°®", "N", "spÂ²", ["è§’å½¢","Bent"], "134Â°", "-11.2", "21.2", [{elem:"N",x:0,y:10,z:0,lp3d:[{x:0,y:1,z:0}],radical:true},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0,lpCount:3}], [[0,1,"double"],[0,2,"coordinate"]], null, null, "C2v");
addMol("N2O|ä¸€æ°§åŒ–äºŒæ°®|ç¬‘æ°£", "N", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-90.8", "-88.5", [{elem:"N",x:0,y:0,z:0,lpCount:0},{elem:"N",x:-65,y:0,z:0,lp3d:[{x:-1,y:0,z:0}]},{elem:"O",x:65,y:0,z:0}], [[0,1,"triple"],[0,2,"coordinate"]], null, null, "Cinfv");
addMol("NO|ä¸€æ°§åŒ–æ°®", "é›™åŸå­", "spÂ²", ["ç›´ç·šå‹","Linear"], "-", "-164", "-152", [{elem:"N",x:-32,y:0,z:0,radical:true,lp3d:[{x:-1,y:1,z:0},{x:-1,y:-1,z:0.4},{x:-1,y:-1,z:-0.4}]},{elem:"O",x:32,y:0,z:0}], [[0,1,"double"]], null, null, "Cinfv");

// --- 6. é›¢å­èˆ‡ç‰¹æ®Šç„¡æ©Ÿåˆ†å­ (å«å…±æŒ¯çµæ§‹) ---
// --- SCN- å…±æŒ¯çµæ§‹å±•ç¤º (ä¿®æ”¹ï¼šä»¥ N=C=S ç‚ºé è¨­) ---
addMol("SCN-|ç¡«æ°°é…¸æ ¹", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [], [], {
    "SCN-|ä¸»è¦å…±æŒ¯çµæ§‹ (N=C=S)": {pg: "Cinfv", mp: "-", bp: "-", atoms: [{elem:"C", x:0, y:0, z:0}, {elem:"N", x:-65, y:0, z:0, lpCount:2},{elem:"S", x:85, y:0, z:0, lpCount:2}], bonds: [[0,1,"double"], [0,2,"double"]] },
    "SCN-|æ¬¡è¦å…±æŒ¯çµæ§‹ (Nâ‰¡C-S)": {pg: "Cinfv", mp: "-", bp: "-", atoms: [{elem:"C", x:0, y:0, z:0}, {elem:"N", x:-60, y:0, z:0, lpCount:1}, {elem:"S", x:90, y:0, z:0, lpCount:3}], bonds: [[0,1,"triple"], [0,2,"single"]] }
});
addMol("NO+|äºç¡é“é›¢å­", "N", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"N",x:-30,y:0,z:0,lpCount:1}, {elem:"O",x:30,y:0,z:0,lpCount:1}], [[0,1,"triple"]], null, null, "Cinfv");
addMol("NO2+|ç¡é“é›¢å­", "N", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"N",x:0,y:0,z:0}, {elem:"O",x:-65,y:0,z:0}, {elem:"O",x:65,y:0,z:0}], [[0,1,"double"],[0,2,"double"]], null, null, "Dinfh");
addMol("N3-|ç–Šæ°®é…¸æ ¹", "N", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [], [], {
    "N3-|ä¸»è¦å…±æŒ¯çµæ§‹ (N=N=N)": {pg: "Dinfh", atoms: [{elem:"N",x:0,y:0,z:0},{elem:"N",x:-65,y:0,z:0,lpCount:2},{elem:"N",x:65,y:0,z:0,lpCount:2}], bonds: [[0,1,"double"],[0,2,"double"]] },
    "N3-|ä¸»è¦å…±æŒ¯çµæ§‹ (Nâ‰¡N-N)": {pg: "Dinfh", atoms: [{elem:"N",x:0,y:0,z:0},{elem:"N",x:-60,y:0,z:0,lpCount:1},{elem:"N",x:85,y:0,z:0,lpCount:3}], bonds: [[0,1,"triple"],[0,2,"single"]] }
});
addMol("OCN-|æ°°é…¸æ ¹", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [], [], {
    "OCN-|ä¸»è¦å…±æŒ¯çµæ§‹ (Nâ‰¡C-O)": {pg: "Cinfv", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"N",x:-60,y:0,z:0,lpCount:1},{elem:"O",x:85,y:0,z:0,lpCount:3}], bonds: [[0,1,"triple"],[0,2,"single"]] },
    "OCN-|æ¬¡è¦å…±æŒ¯çµæ§‹ (N=C=O)": {pg: "Cinfv", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"N",x:-65,y:0,z:0,lpCount:2},{elem:"O",x:65,y:0,z:0,lpCount:2}], bonds: [[0,1,"double"],[0,2,"double"]] }
});
addMol("CNO-|é›·é…¸æ ¹", "N", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [], [], {
    "CNO-|ä¸»è¦å…±æŒ¯çµæ§‹ (Câ‰¡N-O)": {pg: "Cinfv", atoms: [{elem:"N",x:0,y:0,z:0},{elem:"C",x:-60,y:0,z:0,lpCount:1},{elem:"O",x:85,y:0,z:0,lpCount:3}], bonds: [[0,1,"triple"],[0,2,"single"]] },
    "CNO-|æ¬¡è¦å…±æŒ¯çµæ§‹ (C=N=O)": {pg: "Cinfv", atoms: [{elem:"N",x:0,y:0,z:0},{elem:"C",x:-65,y:0,z:0,lpCount:2},{elem:"O",x:65,y:0,z:0,lpCount:2}], bonds: [[0,1,"double"],[0,2,"double"]] }
});
addMol("HOCN|æ°°é…¸", "C", "sp", ["ç›´ç·š/è§’å½¢","Linear/Bent"], "180Â°/105Â°", "-86", "23.5", [{elem:"C",x:0,y:0,z:0}, {elem:"N",x:65,y:0,z:0,lpCount:1}, {elem:"O",x:-65,y:0,z:0,lpCount:2}, {elem:"H",x:-95,y:30,z:0}], [[0,1,"triple"], [0,2], [2,3]], null, null, "Cs");

// --- 7. æ“´å¤§å…«éš…é«”èˆ‡è¤‡é›œå¹¾ä½•æ§‹å‹ ---
// P-Cl=80, P-Br=85, S-F=75, S=O=68, Xe=O=76
addMol("PCl5|äº”æ°¯åŒ–ç£·", "P", "spÂ³d", ["é›™ä¸‰è§’éŒ","Trigonal Bipyramidal"], "90Â°, 120Â°", "160.5", "166.8", [{elem:"P",x:0,y:0,z:0},{elem:"Cl",x:0,y:0,z:85},{elem:"Cl",x:0,y:0,z:-85},{elem:"Cl",x:-80,y:0,z:0},{elem:"Cl",x:40,y:69,z:0},{elem:"Cl",x:40,y:-69,z:0}], [[0,1],[0,2],[0,3],[0,4],[0,5]], null, null, "D3h");
addMol("PBr5|äº”æº´åŒ–ç£·", "P", "spÂ³d", ["é›™ä¸‰è§’éŒ","Trigonal Bipyramidal"], "90Â°, 120Â°", "100 (åˆ†è§£)", "106 (åˆ†è§£)", [{elem:"P",x:0,y:0,z:0}, {elem:"Br",x:0,y:90,z:0}, {elem:"Br",x:0,y:-90,z:0}, {elem:"Br",x:85,y:0,z:0}, {elem:"Br",x:-42,y:0,z:74}, {elem:"Br",x:-42,y:0,z:-74}], [[0,1],[0,2],[0,3],[0,4],[0,5]], null, null, "D3h");
addMol("SF6|å…­æ°ŸåŒ–ç¡«", "S", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-50.8", "-63.8 (æ˜‡è¯)", getOcta("S","F", 75), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("SF4|å››æ°ŸåŒ–ç¡«", "S", "spÂ³d", ["ç¿¹ç¿¹æ¿å‹","Seesaw"], "<90Â°, <120Â°", "-121", "-38", [{elem:"S",x:0,y:0,z:0,lp3d:[{x:0,y:-1,z:0}]},{elem:"F",x:0,y:0,z:80},{elem:"F",x:0,y:0,z:-80},{elem:"F",x:45,y:65,z:0},{elem:"F",x:-45,y:65,z:0}], [[0,1],[0,2],[0,3],[0,4]], null, null, "C2v");
addMol("ClF3|ä¸‰æ°ŸåŒ–æ°¯", "Cl", "spÂ³d", ["Tå‹","T-shaped"], "<90Â°", "-76.3", "11.8", [{elem:"Cl",x:0,y:0,z:0,lp3d:[{x:-1,y:0.5,z:0}, {x:-1,y:-0.5,z:0}]}, {elem:"F",x:0,y:80,z:0}, {elem:"F",x:0,y:-80,z:0}, {elem:"F",x:70,y:0,z:0}], [[0,1],[0,2],[0,3]], null, null, "C2v");
addMol("XeF2|äºŒæ°ŸåŒ–æ°™", "Xe", "spÂ³d", ["ç›´ç·šå‹","Linear"], "180Â°", "128.6", "-", [{elem:"Xe",x:0,y:0,z:0,lp3d:[{x:0,y:1,z:0}, {x:0.866,y:-0.5,z:0}, {x:-0.866,y:-0.5,z:0}]}, {elem:"F",x:0,y:0,z:85}, {elem:"F",x:0,y:0,z:-85}], [[0,1],[0,2]], null, null, "Dinfh");

addMol("XeF4|å››æ°ŸåŒ–æ°™", "Xe", "spÂ³dÂ²", ["å¹³é¢å››é‚Šå½¢","Square Planar"], "90Â°", "117 (æ˜‡è¯)", "-", [
{elem:"Xe",x:0,y:0,z:0,lp3d:[{x:1,y:0,z:0}, {x:-1,y:0,z:0}]}, 
{elem:"F",x:0,y:85,z:0}, {elem:"F",x:0,y:-85,z:0}, 
{elem:"F",x:0,y:0,z:85}, {elem:"F",x:0,y:0,z:-85}
], [[0,1],[0,2],[0,3],[0,4]], null, null, "D4h");

addMol("BrF5|äº”æ°ŸåŒ–æº´", "Br", "spÂ³dÂ²", ["å››è§’éŒ","Square Pyramidal"], "<90Â°", "-61.3", "40.3", [{elem:"Br",x:0,y:0,z:0,lp3d:[{x:0,y:-1,z:0}]}, {elem:"F",x:0,y:80,z:0}, {elem:"F",x:70,y:0,z:0}, {elem:"F",x:-70,y:0,z:0}, {elem:"F",x:0,y:0,z:70}, {elem:"F",x:0,y:0,z:-70}], [[0,1],[0,2],[0,3],[0,4],[0,5]], null, null, "C4v");
addMol("IF7|ä¸ƒæ°ŸåŒ–ç¢˜", "I", "spÂ³dÂ³", ["äº”è§’é›™éŒ","Pentagonal Bipyramidal"], "72Â°, 90Â°", "4.8", "4.8 (æ˜‡è¯)", [{elem:"I",x:0,y:0,z:0,lpCount:0}, {elem:"F",x:0,y:90,z:0}, {elem:"F",x:0,y:-90,z:0}, {elem:"F",x:80,y:0,z:0}, {elem:"F",x:25,y:0,z:76}, {elem:"F",x:25,y:0,z:-76}, {elem:"F",x:-65,y:0,z:47}, {elem:"F",x:-65,y:0,z:-47}], [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7]], null, null, "D5h");
addMol("SeF6|å…­æ°ŸåŒ–ç¡’", "Se", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-34.6", "-46.6 (æ˜‡è¯)", getOcta("Se","F", 75), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("TeF6|å…­æ°ŸåŒ–ç¢²", "Te", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-37.6", "-38.9 (æ˜‡è¯)", getOcta("Te","F", 75), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("AsF5|äº”æ°ŸåŒ–ç ·", "As", "spÂ³d", ["é›™ä¸‰è§’éŒ","Trigonal Bipyramidal"], "90Â°, 120Â°", "-79.8", "-52.8", [{elem:"As",x:0,y:0,z:0}, {elem:"F",x:0,y:80,z:0}, {elem:"F",x:0,y:-80,z:0}, {elem:"F",x:70,y:0,z:0}, {elem:"F",x:-35,y:0,z:60}, {elem:"F",x:-35,y:0,z:-60}], [[0,1],[0,2],[0,3],[0,4],[0,5]], null, null, "D3h");
addMol("TeF4|å››æ°ŸåŒ–ç¢²", "Te", "spÂ³d", ["ç¿¹ç¿¹æ¿å‹","Seesaw"], "<90Â°, <120Â°", "129.6", "193", [{elem:"Te",x:0,y:0,z:0,lp3d:[{x:-1,y:0,z:0}]}, {elem:"F",x:0,y:85,z:0}, {elem:"F",x:0,y:-85,z:0}, {elem:"F",x:70,y:0,z:50}, {elem:"F",x:70,y:0,z:-50}], [[0,1],[0,2],[0,3],[0,4]], null, null, "C2v");
addMol("XeO3|ä¸‰æ°§åŒ–æ°™", "Xe", "spÂ³", ["è§’éŒå½¢","Trigonal Pyramidal"], "103Â°", "25 (çˆ†ç‚¸)", "-", [{elem:"Xe",x:0,y:20,z:0,lp3d:[{x:0,y:1,z:0}]},{elem:"O",x:0,y:-30,z:57},{elem:"O",x:49,y:-30,z:-28.5},{elem:"O",x:-49,y:-30,z:-28.5}], [[0,1,"double"],[0,2,"double"],[0,3,"double"]], null, null, "C3v");
addMol("XeO4|å››æ°§åŒ–æ°™", "Xe", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-35.9", "0 (åˆ†è§£)", getTetra("Xe","O", 76), [[0,1,"double"],[0,2,"double"],[0,3,"double"],[0,4,"double"]], null, null, "Td");
addMol("XeOF4|å››æ°Ÿæ°§åŒ–æ°™|XeOF4", "Xe", "spÂ³dÂ²", ["å››è§’éŒ","Square Pyramidal"], "<90Â°", "-46", "101", [{elem:"Xe",x:0,y:0,z:0,lp3d:[{x:0,y:-1,z:0}]}, {elem:"O",x:0,y:80,z:0}, {elem:"F",x:80,y:0,z:0}, {elem:"F",x:-80,y:0,z:0}, {elem:"F",x:0,y:0,z:80}, {elem:"F",x:0,y:0,z:-80}], [[0,1,"double"],[0,2],[0,3],[0,4],[0,5]], null, null, "C4v");
addMol("IOF5|äº”æ°Ÿæ°§åŒ–ç¢˜", "I", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "4.5", "110", [{elem:"I",x:0,y:0,z:0}, {elem:"O",x:0,y:85,z:0}, {elem:"F",x:0,y:-85,z:0}, {elem:"F",x:85,y:0,z:0}, {elem:"F",x:-85,y:0,z:0}, {elem:"F",x:0,y:0,z:85}, {elem:"F",x:0,y:0,z:-85}], [[0,1,"double"],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "C4v");
addMol("AsF3|ä¸‰æ°ŸåŒ–ç ·", "As", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "96Â°", "-6", "57.8", [{elem:"As",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:0}]}, {elem:"F",x:0,y:-45,z:55}, {elem:"F",x:48,y:-45,z:-28}, {elem:"F",x:-48,y:-45,z:-28}], [[0,1],[0,2],[0,3]], null, null, "C3v");
addMol("SbCl3|ä¸‰æ°¯åŒ–éŠ»", "Sb", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "97Â°", "73.4", "220.3", [{elem:"Sb",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:0}]}, {elem:"Cl",x:0,y:-55,z:65}, {elem:"Cl",x:55,y:-55,z:-35}, {elem:"Cl",x:-55,y:-55,z:-35}], [[0,1],[0,2],[0,3]], null, null, "C3v");
addMol("ICl3|ä¸‰æ°¯åŒ–ç¢˜|Iodine Trichloride", "I", "spÂ³d", ["Tå‹","T-shaped"], "<90Â°", "101 (åˆ†è§£)", "-", [{elem:"I",x:0,y:0,z:0,lpCount:2,lp3d:[{x:-1,y:0.5,z:0},{x:-1,y:-0.5,z:0}]},{elem:"Cl",x:90,y:0,z:0},{elem:"Cl",x:0,y:90,z:0},{elem:"Cl",x:0,y:-90,z:0}], [[0,1],[0,2],[0,3]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªç°¡ä»‹</div><div class="info-body"><strong>ä¸‰æ°¯åŒ–ç¢˜ (IClâ‚ƒ)</strong><br>ä¸­å¿ƒç¢˜åŸå­æ¡å– spÂ³d æ··æˆã€‚ç‚ºäº†æ¸›å°‘é›»å­é›²æ–¥åŠ›ï¼Œå…©å°å­¤å°é›»å­ä½”æ“šæ°´å¹³ä½ç½®ï¼Œä½¿åˆ†å­å‘ˆç¾ T å‹çµæ§‹ã€‚</div></div>', "C2v");
addMol("B2H6|ä¹™ç¡¼çƒ·|Diborane", "B", "spÂ³", ["ç‰¹æ®Š (å«æ°«æ©‹éµ)","Banana Bonds"], "120Â°(ç«¯)/97Â°(æ©‹)", "-164.8", "-92.5", [{elem:"B",x:-40,y:0,z:0,lpCount:0},{elem:"B",x:40,y:0,z:0,lpCount:0},{elem:"H",x:0,y:0,z:50},{elem:"H",x:0,y:0,z:-50},{elem:"H",x:-65,y:43,z:0},{elem:"H",x:-65,y:-43,z:0},{elem:"H",x:65,y:43,z:0},{elem:"H",x:65,y:-43,z:0}], [[0,2],[0,3],[1,2],[1,3],[0,4],[0,5],[1,6],[1,7]], null, '<div class="info-section"><div class="info-title">ğŸŒ çµæ§‹ç‰¹æ€§</div><div class="info-body"><strong>ä¹™ç¡¼çƒ· (Bâ‚‚Hâ‚†)</strong><br>å…·æœ‰ä¸‰ä¸­å¿ƒäºŒé›»å­éµã€‚æ¯å€‹ç¡¼åŸå­èˆ‡å››å€‹æ°«åŸå­é€£ç·šï¼Œå½¢æˆé¡ä¼¼ spÂ³ çš„å¹¾ä½•æ’åˆ—ã€‚</div></div>', "D2h");
// --- 8. é™°é›¢å­ç¾¤ (Complex Anions) ---
addMol("SiF62-|å…­æ°ŸçŸ½é…¸æ ¹", "Si", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-", "-", getOcta("Si","F", 75), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("PF6-|å…­æ°Ÿç£·é…¸æ ¹", "P", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-", "-", getOcta("P","F", 75), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("SbF6-|å…­æ°ŸéŠ»é…¸æ ¹", "Sb", "spÂ³dÂ²", ["å…«é¢é«”","Octahedral"], "90Â°", "-", "-", getOcta("Sb","F", 80), [[0,1],[0,2],[0,3],[0,4],[0,5],[0,6]], null, null, "Oh");
addMol("I3-|ä¸‰ç¢˜é™°é›¢å­|ä¸‰ç¢˜éŒ¯é›¢å­", "I", "spÂ³d", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"I",x:0,y:0,z:0,lp3d:[{x:0,y:1,z:0},{x:0,y:-0.5,z:0.866},{x:0,y:-0.5,z:-0.866}]},{elem:"I",x:-100,y:0,z:0},{elem:"I",x:100,y:0,z:0}], [[0,1],[0,2]], null, null, "Dinfh");
addMol("ICl2-|äºŒæ°¯ç¢˜é›¢å­", "I", "spÂ³d", ["ç›´ç·šå‹","Linear"], "180Â°", "-", "-", [{elem:"I",x:0,y:0,z:0,lp3d:[{x:0,y:1,z:0},{x:0,y:-0.5,z:0.866},{x:0,y:-0.5,z:-0.866}]}, {elem:"Cl",x:-90,y:0,z:0}, {elem:"Cl",x:90,y:0,z:0}], [[0,1],[0,2]], null, null, "Dinfh");
addMol("ICl4-|å››æ°¯ç¢˜é›¢å­", "I", "spÂ³dÂ²", ["å¹³é¢å››é‚Šå½¢","Square Planar"], "90Â°", "-", "-", [{elem:"I",x:0,y:0,z:0,lp3d:[{x:0,y:1,z:0}, {x:0,y:-1,z:0}]}, {elem:"Cl",x:90,y:0,z:0}, {elem:"Cl",x:-90,y:0,z:0}, {elem:"Cl",x:0,y:0,z:90}, {elem:"Cl",x:0,y:0,z:-90}], [[0,1],[0,2],[0,3],[0,4]], null, null, "D4h");
addMol("BF4-|å››æ°Ÿç¡¼é…¸æ ¹", "B", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-", "-", getTetra("B","F", 70), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td");
addMol("BBF4-|å››æ°Ÿç¡¼é…¸æ ¹", "B", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-", "-", getTetra("B","F", 70), [[0,1],[0,2],[0,3],[4,0,"coordinate"]], null, null, "Td");
addMol("AlCl4-|å››æ°¯é‹é…¸æ ¹", "Al", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-", "-", getTetra("Al","Cl", 80), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td");
addMol("BH4-|ç¡¼æ°«åŒ–é›¢å­", "B", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-", "-", getTetra("B","H", 50), [[0,1],[0,2],[0,3],[0,4]], null, null, "Td");

// --- 9. é…¸æ ¹èˆ‡å«æ°§é…¸ ---
// --- é…¸æ ¹èˆ‡å«æ°§é…¸ (ä¿®æ­£é›¢å­éµè·é›¢èˆ‡éµç´šé¡¯ç¤º) ---
addMol("H2SO4|ç¡«é…¸ç³»åˆ—", "S", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "10.3", "337", [], [], {
    "H2SO4|ç¡«é…¸": { pg: "C2", mp: "10.3", bp: "337", desc: "<strong>ç¡«é…¸</strong><br>å·¥æ¥­ä¹‹æ¯ï¼Œå…·å¼·è„«æ°´æ€§èˆ‡æ°§åŒ–æ€§ï¼Œç”±å…©å€‹é…ä½éµ (Sâ†’O) èˆ‡å…©å€‹ S-OH æ§‹æˆï¼Œåˆ†å­é›»ä¸­æ€§ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:2},{elem:"O",x:-60,y:-30,z:35,lpCount:2},{elem:"H",x:85,y:5,z:60},{elem:"H",x:-85,y:5,z:60}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"],[3,5],[4,6]] },
    "HSO4-|ç¡«é…¸æ°«æ ¹": { pg: "Cs", mp: "-", bp: "-", desc: "<strong>ç¡«é…¸æ°«æ ¹</strong><br>é…¸å¼é¹½é™°é›¢å­ï¼Œæ°´æº¶æ¶²å‘ˆå¼·é…¸æ€§ï¼ŒS-Oâ» ç«¯å¸¶æœ‰è² é›»è·ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:2},{elem:"H",x:-85,y:5,z:60}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"],[4,5]] },
    "SO42-|ç¡«é…¸æ ¹": { pg: "Td", mp: "-", bp: "-", desc: "<strong>ç¡«é…¸æ ¹</strong><br>æ­£å››é¢é«”çµæ§‹ï¼ŒåŒ–å­¸æ€§è³ªç©©å®šï¼Œå…©å€‹ S-Oâ» ç«¯é¡¯ç¤ºç²‰ç´…é›»å­ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "NaHSO4|ç¡«é…¸æ°«éˆ‰": { pg: "Cs", mp: "58 (åˆ†è§£)", bp: "-", desc: "<strong>ç¡«é…¸æ°«éˆ‰</strong><br>æº¶æ–¼æ°´å‘ˆå¼·é…¸æ€§ï¼Œå¸¸ç”¨æ–¼æ¸…æ½”åŠ‘æˆ–é™ä½ pH å€¼ã€‚", atoms: [{elem:"S",x:-20,y:0,z:0},{elem:"O",x:-20,y:68,z:0,lpCount:3},{elem:"O",x:-20,y:-25,z:-63,lpCount:3},{elem:"O",x:40,y:-30,z:35,lpCount:3},{elem:"O",x:-80,y:-30,z:35,lpCount:2},{elem:"H",x:-105,y:-5,z:60},{elem:"Na",x:100,y:40,z:0,r:15}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"],[4,5]] },
    "KHSO4|ç¡«é…¸æ°«é‰€": { pg: "Cs", mp: "197", bp: "-", desc: "<strong>ç¡«é…¸æ°«é‰€</strong><br>æ˜“æº¶æ–¼æ°´å‘ˆå¼·é…¸æ€§ï¼ŒåŠ ç†±å¤±æ°´å¯è£½å‚™ç„¦ç¡«é…¸é‰€ã€‚", atoms: [{elem:"S",x:-20,y:0,z:0},{elem:"O",x:-20,y:68,z:0,lpCount:3},{elem:"O",x:-20,y:-25,z:-63,lpCount:3},{elem:"O",x:40,y:-30,z:35,lpCount:3},{elem:"O",x:-80,y:-30,z:35,lpCount:2},{elem:"H",x:-105,y:-5,z:60},{elem:"K",x:110,y:40,z:0,r:22}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"],[4,5]] },
    "CaSO4|ç¡«é…¸éˆ£|çŸ³è†": { pg: "Td", mp: "1460", bp: "-", desc: "<strong>ç¡«é…¸éˆ£ (çŸ³è†)</strong><br>å¾®æº¶æ–¼æ°´ï¼Œå»£æ³›ç”¨æ–¼å»ºç¯‰ææ–™ã€æ¨¡å‹è£½ä½œèˆ‡ä½œç‚ºè±†è…å‡å›ºåŠ‘ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Ca",x:0,y:0,z:100,r:20,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "BaSO4|ç¡«é…¸é‹‡|é‡æ™¶çŸ³": { pg: "Td", mp: "1580", bp: "-", desc: "<strong>ç¡«é…¸é‹‡ (é‡æ™¶çŸ³)</strong><br>æ¥µé›£æº¶æ–¼æ°´èˆ‡é…¸ï¼Œç„¡æ¯’ä¸”å¯†åº¦å¤§ï¼Œé†«å­¸ä¸Šç”¨æ–¼æ¶ˆåŒ–é“Xå…‰æ”å½±(é‹‡é¤)ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Ba",x:0,y:0,z:110,r:25,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "CuSO4|ç¡«é…¸éŠ…": { pg: "Td", mp: "110 (å¤±æ°´)", bp: "-", desc: "<strong>ç¡«é…¸éŠ…</strong><br>ç„¡æ°´ç‰©ç‚ºç™½è‰²ï¼Œå¸æ°´å¾Œè®Šè—è‰²(äº”æ°´åˆ)ï¼Œå¸¸ç”¨æ–¼æ¸¸æ³³æ± æ®ºèŒã€æ³¢çˆ¾å¤šæ¶²åŸæ–™èˆ‡é›»éã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Cu",x:0,y:0,z:100,r:18,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "FeSO4|ç¡«é…¸äºéµ|ç¶ ç¤¬": { pg: "Td", mp: "64 (å¤±æ°´)", bp: "-", desc: "<strong>ç¡«é…¸äºéµ (ç¶ ç¤¬)</strong><br>æ·ºç¶ è‰²æ™¶é«”ï¼Œå¸¸ç”¨æ–¼é†«ç™‚è£œè¡€åŠ‘(éµåŠ‘)ã€æ°´è™•ç†çµ®å‡åŠ‘èˆ‡é‚„åŸåŠ‘ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Fe",x:0,y:0,z:100,r:18,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "ZnSO4|ç¡«é…¸é‹…|çš“ç¤¬": { pg: "Td", mp: "100 (å¤±æ°´)", bp: "500 (åˆ†è§£)", desc: "<strong>ç¡«é…¸é‹… (çš“ç¤¬)</strong><br>ç„¡è‰²é‡ç‹€æ™¶é«”ï¼Œç”¨æ–¼è£½é€ äººé€ çº–ç¶­ã€æœ¨æé˜²è…èˆ‡è¾²æ¥­å¾®é‡å…ƒç´ è‚¥æ–™ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Zn",x:0,y:0,z:100,r:18,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] },
    "MgSO4|ç¡«é…¸é‚|ç€‰é¹½": { pg: "Td", mp: "1124", bp: "-", desc: "<strong>ç¡«é…¸é‚ (ç€‰é¹½)</strong><br>æ˜“æº¶æ–¼æ°´ï¼Œé†«ç™‚ä¸Šä½œç‚ºç€‰åŠ‘æˆ–ç·©è§£å­ç™‡ï¼Œç”Ÿæ´»ä¸­å¸¸ç”¨æ–¼æ³¡æ¾¡æµ´é¹½æ”¾é¬†è‚Œè‚‰ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"O",x:0,y:68,z:0,lpCount:3},{elem:"O",x:0,y:-25,z:-63,lpCount:3},{elem:"O",x:60,y:-30,z:35,lpCount:3},{elem:"O",x:-60,y:-30,z:35,lpCount:3},{elem:"Mg",x:0,y:0,z:100,r:18,lpCount:0}], bonds: [[0,1,"coordinate"],[0,2,"coordinate"],[0,3,"single"],[0,4,"single"]] }
});

addMol("H2SO3|äºç¡«é…¸ç³»åˆ—", "S", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "106Â°", "-", "ä¸ç©©å®š", [], [], {
"H2SO3|äºç¡«é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>äºç¡«é…¸</strong><br>åƒ…å­˜åœ¨æ–¼æ°´æº¶æ¶²ä¸­çš„äºŒå…ƒå¼±é…¸ï¼Œæ¥µä¸ç©©å®šã€‚å…·æœ‰å¼·é‚„åŸæ€§èˆ‡æ¼‚ç™½èƒ½åŠ›ï¼Œå—ç†±æˆ–ä¹…ç½®æ˜“åˆ†è§£å‡ºäºŒæ°§åŒ–ç¡«æ°£é«”ã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30},{elem:"H",x:85,y:-10,z:30},{elem:"H",x:-85,y:-10,z:30}], bonds: [[0,1,"double"],[0,2],[0,3],[2,4],[3,5]] },
"HSO3-|äºç¡«é…¸æ°«æ ¹": { pg: "Cs", mp: "-", bp: "-", desc: "<strong>äºç¡«é…¸æ°«æ ¹</strong><br>äºç¡«é…¸çš„ç¬¬ä¸€ç´šé›»é›¢ç”¢ç‰©ï¼Œç‚ºå…©æ€§é›¢å­ã€‚åœ¨é…¸æ€§ç’°å¢ƒä¸­ä¸ç©©å®šï¼Œå»£æ³›å­˜åœ¨æ–¼äºç¡«é…¸æ°«é¹½æº¶æ¶²ä¸­ï¼Œå…·æŠ—æ°§åŒ–æ€§è³ªã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30},{elem:"H",x:85,y:-10,z:30}], bonds: [[0,1,"double"],[0,2],[0,3],[2,4]] },
"SO32-|äºç¡«é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>äºç¡«é…¸æ ¹</strong><br>äºç¡«é…¸çš„å®Œå…¨é›»é›¢ç”¢ç‰©ï¼Œä¸­å¿ƒç¡«åŸå­æœ‰ä¸€å°å­¤å°é›»å­ã€‚å…·æœ‰å¼·é‚„åŸæ€§ï¼Œæ˜“è¢«ç©ºæ°£ä¸­çš„æ°§æ°§åŒ–æˆç¡«é…¸æ ¹ã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
"Na2SO3|äºç¡«é…¸éˆ‰": { pg: "C3v", mp: "33.4 (åˆ†è§£)", bp: "-", desc: "<strong>äºç¡«é…¸éˆ‰</strong><br>å¸¸è¦‹çš„äºç¡«é…¸é¹½ï¼Œç‚ºç™½è‰²ç²‰æœ«ï¼Œæ˜“æº¶æ–¼æ°´ã€‚å¸¸ç”¨ä½œé‚„åŸåŠ‘ã€é˜²è…åŠ‘ä»¥åŠæ”å½±é¡¯å½±åŠ‘çš„ä¿è­·åŠ‘ã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30},{elem:"Na",x:100,y:20,z:0,r:15},{elem:"Na",x:-100,y:20,z:0,r:15}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"],[4,2,"ionic_thin"],[5,3,"ionic_thin"]] },
"NaHSO3|äºç¡«é…¸æ°«éˆ‰": { pg: "Cs", mp: "150 (åˆ†è§£)", bp: "-", desc: "<strong>äºç¡«é…¸æ°«éˆ‰</strong><br>äºç¡«é…¸çš„é…¸å¼é¹½ï¼Œç‚ºç™½è‰²çµæ™¶ç²‰æœ«ï¼Œæœ‰äºŒæ°§åŒ–ç¡«çš„åˆºæ¿€æ°£æ°£å‘³ã€‚å¸¸ç”¨æ–¼æ¼‚ç™½ç¹”ç‰©ã€é£Ÿå“é˜²è…åŠè™•ç†å·¥æ¥­å»¢æ°´ã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30},{elem:"H",x:85,y:-10,z:30},{elem:"Na",x:-100,y:0,z:0,r:15}], bonds: [[0,1,"double"],[0,2],[0,3],[2,4],[5,3,"ionic_thin"]] },
"CaSO3|äºç¡«é…¸éˆ£": { pg: "C3v", mp: "600 (åˆ†è§£)", bp: "-", desc: "<strong>äºç¡«é…¸éˆ£</strong><br>ç™½è‰²çµæ™¶ç²‰æœ«ï¼Œå¾®æº¶æ–¼æ°´ã€‚ä¸»è¦ç”¨ä½œé£Ÿå“é˜²è…åŠ‘ã€æ¶ˆæ¯’åŠ‘ï¼Œä¹Ÿæ˜¯ç…™æ°£è„«ç¡«å·¥è—ä¸­çš„å¸¸è¦‹ç”¢ç‰©ã€‚", atoms: [{elem:"S",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:80,z:0},{elem:"O",x:55,y:-30,z:30},{elem:"O",x:-55,y:-30,z:30},{elem:"Ca",x:0,y:0,z:90,r:20}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"],[4,2,"ionic_thin"],[4,3,"ionic_thin"]] }
});

addMol("H2S2O3|ç¡«ä»£ç¡«é…¸ç³»åˆ—", "S", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-78 (åˆ†è§£)", "-", [], [], {
    "H2S2O3|ç¡«ä»£ç¡«é…¸": { pg: "Cs", mp: "-78", bp: "-", desc: "<strong>ç¡«ä»£ç¡«é…¸</strong><br>ä¸ç©©å®šé…¸ï¼Œä¸­å¿ƒSé€£æ¥å¦ä¸€å€‹å¤–åœSåŸå­ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"S",x:0,y:80,z:0},{elem:"O",x:0,y:-25,z:-63},{elem:"O",x:60,y:-30,z:35},{elem:"O",x:-60,y:-30,z:35},{elem:"H",x:85,y:5,z:60},{elem:"H",x:-85,y:5,z:60}], bonds: [[0,1,"double"],[0,2,"double"],[0,3],[0,4],[3,5],[4,6]] },
    "HS2O3-|ç¡«ä»£ç¡«é…¸æ°«æ ¹": { pg: "Cs", mp: "-", bp: "-", desc: "<strong>ç¡«ä»£ç¡«é…¸æ°«æ ¹</strong><br>çµæ§‹é¡ä¼¼ç¡«é…¸æ°«æ ¹ä½†ä¸€å€‹Oè¢«Så–ä»£ã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"S",x:0,y:80,z:0},{elem:"O",x:0,y:-25,z:-63},{elem:"O",x:60,y:-30,z:35},{elem:"O",x:-60,y:-30,z:35},{elem:"H",x:85,y:5,z:60}], bonds: [[0,1,"double"],[0,2,"double"],[0,3],[0,4],[3,5]] },
    "S2O32-|ç¡«ä»£ç¡«é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>ç¡«ä»£ç¡«é…¸æ ¹</strong><br>å…·é‚„åŸæ€§ï¼Œä¸­å¿ƒç¡«åŸå­èˆ‡å¤–åœç¡«å½¢æˆé›™éµã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"S",x:0,y:80,z:0},{elem:"O",x:0,y:-25,z:-63},{elem:"O",x:60,y:-30,z:35},{elem:"O",x:-60,y:-30,z:35}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"],[0,4,"single"]] },
    "Na2S2O3|ç¡«ä»£ç¡«é…¸éˆ‰|å¤§è˜‡æ‰“|æµ·æ³¢": { pg: "C3v", mp: "48.3", bp: "100 (åˆ†è§£)", desc: "<strong>ç¡«ä»£ç¡«é…¸éˆ‰ (æµ·æ³¢)</strong><br>Naâº ä½æ–¼çµæ§‹å¤–å´ï¼Œç„¡å¯¦é«”éµé€£ç·šã€‚", atoms: [{elem:"S",x:0,y:0,z:0},{elem:"S",x:0,y:80,z:0},{elem:"O",x:0,y:-25,z:-63},{elem:"O",x:60,y:-30,z:35},{elem:"O",x:-60,y:-30,z:35},{elem:"Na",x:100,y:20,z:0,r:15},{elem:"Na",x:-100,y:20,z:0,r:15}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"],[0,4,"single"]] }
});

addMol("H2CO3|ç¢³é…¸ç³»åˆ—", "C", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", "-", "ä¸ç©©å®š", [], [], {
    "H2CO3|ç¢³é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>ç¢³é…¸</strong><br>äºŒè³ªå­å¼±é…¸ï¼Œå­˜åœ¨æ–¼æ±½æ°´ä¸­ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"H",x:90,y:-10,z:0},{elem:"H",x:-90,y:-10,z:0}], bonds: [[0,1,"double"],[0,2],[0,3],[2,4],[3,5]] },
    "HCO3-|ç¢³é…¸æ°«æ ¹": { pg: "Cs", mp: "-", bp: "-", desc: "<strong>ç¢³é…¸æ°«æ ¹</strong><br>å¸¶-1åƒ¹é›»è·ï¼Œå°è˜‡æ‰“çš„ä¸»è¦æˆåˆ†ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"H",x:-90,y:-10,z:0}], bonds: [[0,1,"double"],[0,2],[0,3],[3,4]] },
    "CO32-|ç¢³é…¸æ ¹": { pg: "D3h", mp: "-", bp: "-", desc: "<strong>ç¢³é…¸æ ¹</strong><br>å¸¶-2åƒ¹é›»è·ï¼Œå…±æŒ¯çµæ§‹ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
    "CaCO3|ç¢³é…¸éˆ£|ç°çŸ³": { pg: "D3h", mp: "825 (åˆ†è§£)", bp: "-", desc: "<strong>ç¢³é…¸éˆ£</strong><br>CaÂ²âº ä½æ–¼ç¢³é…¸æ ¹å¹³é¢ä¸Šæ–¹ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"Ca",x:0,y:0,z:90,r:20,lpCount:0}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
    "MgCO3|ç¢³é…¸é‚": { pg: "D3h", mp: "350 (åˆ†è§£)", bp: "-", desc: "<strong>ç¢³é…¸é‚</strong><br>MgÂ²âº ä½æ–¼ç¢³é…¸æ ¹å¹³é¢ä¸Šæ–¹ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"Mg",x:0,y:0,z:90,r:18,lpCount:0}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
    "Na2CO3|ç¢³é…¸éˆ‰|è˜‡æ‰“": { pg: "D3h", mp: "851", bp: "-", desc: "<strong>ç¢³é…¸éˆ‰ (è˜‡æ‰“)</strong><br>å…©å€‹ Naâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"Na",x:100,y:-20,z:0,r:15},{elem:"Na",x:-100,y:-20,z:0,r:15}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
    "K2CO3|ç¢³é…¸é‰€|è‰æœ¨ç°": { pg: "D3h", mp: "891", bp: "-", desc: "<strong>ç¢³é…¸é‰€</strong><br>å…©å€‹ Kâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"K",x:100,y:-20,z:0,r:22},{elem:"K",x:-100,y:-20,z:0,r:22}], bonds: [[0,1,"double"],[0,2,"single"],[0,3,"single"]] },
    "NaHCO3|ç¢³é…¸æ°«éˆ‰|å°è˜‡æ‰“": { pg: "Cs", mp: "50 (åˆ†è§£)", bp: "-", desc: "<strong>ç¢³é…¸æ°«éˆ‰</strong><br>Naâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:70,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"O",x:-60,y:-35,z:0},{elem:"H",x:-90,y:-10,z:0},{elem:"Na",x:100,y:-20,z:0,r:15}], bonds: [[0,1,"double"],[0,2],[0,3],[3,4]] }
});

addMol("HNO3|ç¡é…¸ç³»åˆ—", "N", "spÂ²", ["å¹³é¢ä¸‰è§’å½¢","Trigonal Planar"], "120Â°", "-42", "83", [], [], {
    "HNO3|ç¡é…¸": { pg: "Cs", mp: "-42", bp: "83", desc: "<strong>ç¡é…¸</strong><br>å¼·é…¸åŠå¼·æ°§åŒ–åŠ‘ã€‚å…‰ç…§æ˜“åˆ†è§£ç”¢ç”Ÿç´…æ£•è‰² NOâ‚‚ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:0}, {elem:"O",x:0,y:68,z:0}, {elem:"O",x:-59,y:-34,z:0}, {elem:"O",x:59,y:-34,z:0,lpCount:2}, {elem:"H",x:90,y:-15,z:0}], bonds: [[0,1,"double"], [0,2,"coordinate"], [0,3], [3,4]] },
    "NO3-|ç¡é…¸æ ¹": { pg: "D3h", mp: "-", bp: "-", desc: "<strong>ç¡é…¸æ ¹</strong><br>å…·æœ‰é«˜åº¦å°ç¨±çš„å¹³é¢çµæ§‹ (å…±æŒ¯)ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:0}, {elem:"O",x:0,y:68,z:0}, {elem:"O",x:-59,y:-34,z:0}, {elem:"O",x:59,y:-34,z:0}], bonds: [[0,1,"double"], [0,2,"coordinate"], [0,3]] },
    "KNO3|ç¡é…¸é‰€|ç¡çŸ³": { pg: "D3h", mp: "334", bp: "400 (åˆ†è§£)", desc: "<strong>ç¡é…¸é‰€</strong><br>ä¿—ç¨±ç¡çŸ³ã€‚Kâº ä½æ–¼çµæ§‹ä¸Šæ–¹ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:0}, {elem:"O",x:0,y:68,z:0}, {elem:"O",x:-59,y:-34,z:0}, {elem:"O",x:59,y:-34,z:0}, {elem:"K",x:0,y:0,z:90,r:22,lpCount:0}], bonds: [[0,1,"double"], [0,2,"coordinate"], [0,3]] },
    "NaNO3|ç¡é…¸éˆ‰|æ™ºåˆ©ç¡çŸ³": { pg: "D3h", mp: "308", bp: "380 (åˆ†è§£)", desc: "<strong>ç¡é…¸éˆ‰</strong><br>ä¿—ç¨±æ™ºåˆ©ç¡çŸ³ã€‚Naâº ä½æ–¼çµæ§‹ä¸Šæ–¹ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:0}, {elem:"O",x:0,y:68,z:0}, {elem:"O",x:-59,y:-34,z:0}, {elem:"O",x:59,y:-34,z:0}, {elem:"Na",x:0,y:0,z:85,r:15,lpCount:0}], bonds: [[0,1,"double"], [0,2,"coordinate"], [0,3]] },
    "AgNO3|ç¡é…¸éŠ€": { pg: "D3h", mp: "212", bp: "444 (åˆ†è§£)", desc: "<strong>ç¡é…¸éŠ€</strong><br>Agâº ä½æ–¼çµæ§‹ä¸Šæ–¹ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:0}, {elem:"O",x:0,y:68,z:0}, {elem:"O",x:-59,y:-34,z:0}, {elem:"O",x:59,y:-34,z:0}, {elem:"Ag",x:0,y:0,z:90,r:18,lpCount:0}], bonds: [[0,1,"double"], [0,2,"coordinate"], [0,3]] },
    "Cu(NO3)2|ç¡é…¸éŠ…": { pg: "D3h", mp: "114", bp: "170 (åˆ†è§£)", desc: "<strong>ç¡é…¸éŠ…</strong><br>è—è‰²æ™¶é«”ã€‚CuÂ²âº ã€‚", atoms: [{elem:"Cu",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"N",x:-90,y:0,z:0,lpCount:0}, {elem:"O",x:-145,y:0,z:0}, {elem:"O",x:-60,y:45,z:35}, {elem:"O",x:-60,y:-45,z:-35}, {elem:"N",x:90,y:0,z:0,lpCount:0}, {elem:"O",x:145,y:0,z:0}, {elem:"O",x:60,y:45,z:35}, {elem:"O",x:60,y:-45,z:-35}], bonds: [[1,2,"double"],[1,3,"coordinate"],[1,4,"single"], [5,6,"double"],[5,7,"coordinate"],[5,8,"single"]] }
});

addMol("HNO2|äºç¡é…¸ç³»åˆ—", "N", "spÂ²", ["è§’å½¢","Bent"], "111Â°", "-", "ä¸ç©©å®š", [], [], {
    "HNO2|äºç¡é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>äºç¡é…¸</strong><br>å¼±é…¸ï¼ŒNåŸå­ä¸Šæœ‰ä¸€å°å­¤å°é›»å­ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:1},{elem:"O",x:0,y:65,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"H",x:90,y:-10,z:0}], bonds: [[0,1,"double"],[0,2],[2,3]] },
    "NO2-|äºç¡é…¸æ ¹": { pg: "C2v", mp: "-", bp: "-", desc: "<strong>äºç¡é…¸æ ¹</strong><br>å¸¸è¦‹çš„é˜²è…åŠ‘æˆåˆ†(äºç¡é…¸é¹½)ï¼Œçµæ§‹å‘ˆVå‹ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:1},{elem:"O",x:0,y:65,z:0},{elem:"O",x:60,y:-35,z:0}], bonds: [[0,1,"double"],[0,2]] },
    "NaNO2|äºç¡é…¸éˆ‰": { pg: "C2v", mp: "271", bp: "320 (åˆ†è§£)", desc: "<strong>äºç¡é…¸éˆ‰</strong><br>Naâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:1},{elem:"O",x:0,y:65,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"Na",x:-80,y:0,z:0,r:15}], bonds: [[0,1,"double"],[0,2]] },
    "KNO2|äºç¡é…¸é‰€": { pg: "C2v", mp: "440 (åˆ†è§£)", bp: "-", desc: "<strong>äºç¡é…¸é‰€</strong><br>Kâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"N",x:0,y:0,z:0,lpCount:1},{elem:"O",x:0,y:65,z:0},{elem:"O",x:60,y:-35,z:0},{elem:"K",x:-85,y:0,z:0,r:22}], bonds: [[0,1,"double"],[0,2]] }
});

addMol("H3PO4|ç£·é…¸ç³»åˆ—", "P", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "42.4", "213 (åˆ†è§£)", [], [], {
    "H3PO4|ç£·é…¸": { pg: "Cs", mp: "42.4", bp: "213 (åˆ†è§£)", desc: "<strong>ç£·é…¸</strong><br>ä¸‰è³ªå­é…¸ï¼Œå«ä¸€å€‹ P=O èˆ‡ä¸‰å€‹ P-OHã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35,lpCount:2},{elem:"O",x:-55,y:-30,z:35,lpCount:2},{elem:"O",x:0,y:-30,z:-60,lpCount:2},{elem:"H",x:80,y:-10,z:55},{elem:"H",x:-80,y:-10,z:55},{elem:"H",x:0,y:-10,z:-90}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5],[3,6],[4,7]] },
    "H2PO4-|ç£·é…¸äºŒæ°«æ ¹": { pg: "C2v", mp: "-", bp: "-", desc: "<strong>ç£·é…¸äºŒæ°«æ ¹</strong><br>å¸¶ -1 åƒ¹é›»è·ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35,lpCount:2},{elem:"O",x:-55,y:-30,z:35,lpCount:2},{elem:"O",x:0,y:-30,z:-60},{elem:"H",x:80,y:-10,z:55},{elem:"H",x:-80,y:-10,z:55}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5],[3,6]] },
    "HPO42-|ç£·é…¸æ°«æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>ç£·é…¸æ°«æ ¹</strong><br>å¸¶ -2 åƒ¹é›»è·ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35,lpCount:2},{elem:"O",x:-55,y:-30,z:35},{elem:"O",x:0,y:-30,z:-60},{elem:"H",x:80,y:-10,z:55}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5]] },
    "PO43-|ç£·é…¸æ ¹": { pg: "Td", mp: "-", bp: "-", desc: "<strong>ç£·é…¸æ ¹</strong><br>æ­£å››é¢é«”çµæ§‹ï¼Œå››å€‹ P-O éµé•·å‡ç­‰ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35},{elem:"O",x:-55,y:-30,z:35},{elem:"O",x:0,y:-30,z:-60}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] },
    "Ca3(PO4)2|ç£·é…¸éˆ£": { pg: "Td", mp: "1670", bp: "-", desc: "<strong>ç£·é…¸éˆ£</strong><br>é›£æº¶æ–¼æ°´ï¼Œè®Šé‡åŸæ–™ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35},{elem:"O",x:-55,y:-30,z:35},{elem:"O",x:0,y:-30,z:-60},{elem:"Ca",x:100,y:40,z:0,r:20},{elem:"Ca",x:-100,y:40,z:0,r:20},{elem:"Ca",x:0,y:-100,z:0,r:20}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] },
    "Na3PO4|ç£·é…¸éˆ‰": { pg: "Td", mp: "1583", bp: "-", desc: "<strong>ç£·é…¸éˆ‰</strong><br>å¼·é¹¼æ€§é¹½é¡ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35},{elem:"O",x:-55,y:-30,z:35},{elem:"O",x:0,y:-30,z:-60},{elem:"Na",x:90,y:30,z:0,r:15},{elem:"Na",x:-90,y:30,z:0,r:15},{elem:"Na",x:0,y:-90,z:0,r:15}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] },
    "Ca(H2PO4)2|ç£·é…¸äºŒæ°«éˆ£": { pg: "C2v", mp: "109 (åˆ†è§£)", bp: "-", desc: "<strong>ç£·é…¸äºŒæ°«éˆ£</strong><br>è‚¥æ–™æˆåˆ†ã€‚", atoms: [{elem:"Ca",x:0,y:0,z:0,r:20}, {elem:"P",x:-100,y:0,z:0}, {elem:"O",x:-100,y:65,z:0}, {elem:"O",x:-100,y:-30,z:55}, {elem:"O",x:-145,y:-30,z:-30}, {elem:"O",x:-55,y:-30,z:-30}, {elem:"H",x:-145,y:-60,z:55}, {elem:"H",x:-175,y:-10,z:-30}, {elem:"P",x:100,y:0,z:0}, {elem:"O",x:100,y:65,z:0}, {elem:"O",x:100,y:-30,z:55}, {elem:"O",x:145,y:-30,z:-30}, {elem:"O",x:55,y:-30,z:-30}, {elem:"H",x:145,y:-60,z:55}, {elem:"H",x:175,y:-10,z:-30}], bonds: [[1,2,"double"],[1,3],[1,4],[1,5],[3,6],[4,7], [8,9,"double"],[8,10],[8,11],[8,12],[10,13],[11,14]] }
});

addMol("H3PO3|äºç£·é…¸ç³»åˆ—", "P", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "73.6", "200 (åˆ†è§£)", [], [], {
    "H3PO3|äºç£·é…¸": { pg: "Cs", mp: "73.6", bp: "200 (åˆ†è§£)", desc: "<strong>äºç£·é…¸</strong><br>äºŒè³ªå­é…¸ï¼Œå«ä¸€å€‹ P-H éµ (ä¸è§£é›¢) èˆ‡å…©å€‹ P-OHã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35,lpCount:2},{elem:"O",x:-55,y:-30,z:35,lpCount:2},{elem:"H",x:0,y:-40,z:-60},{elem:"H",x:90,y:-10,z:60},{elem:"H",x:-90,y:-10,z:60}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5],[3,6]] },
    "H2PO3-|äºç£·é…¸æ°«æ ¹": { pg: "Cs", mp: "-", bp: "-", desc: "<strong>äºç£·é…¸äºŒæ°«æ ¹</strong><br>å¸¶ -1 åƒ¹é›»è·ï¼ŒP-H éµä¿ç•™ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35,lpCount:2},{elem:"O",x:-55,y:-30,z:35,lpCount:2},{elem:"H",x:0,y:-40,z:-60},{elem:"H",x:90,y:-10,z:60}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5]] },
    "HPO32-|äºç£·é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>äºç£·é…¸æ°«æ ¹ (äºç£·é…¸æ ¹)</strong><br>å¸¶ -2 åƒ¹é›»è·ï¼ŒP-H éµé€šå¸¸ä¸è§£é›¢ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35},{elem:"O",x:-55,y:-30,z:35},{elem:"H",x:0,y:-40,z:-60}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] },
    "Na2HPO3|äºç£·é…¸éˆ‰": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>äºç£·é…¸éˆ‰</strong><br>æ­£é¹½ï¼ŒP ç›´æ¥é€£æœ‰ä¸€å€‹ Hã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:55,y:-30,z:35},{elem:"O",x:-55,y:-30,z:35},{elem:"H",x:0,y:-40,z:-60},{elem:"Na",x:90,y:20,z:0,r:15},{elem:"Na",x:-90,y:20,z:0,r:15}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] }
});

addMol("H3PO2|æ¬¡ç£·é…¸ç³»åˆ—", "P", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "26.5", "130 (åˆ†è§£)", [], [], {
    "H3PO2|æ¬¡ç£·é…¸": { pg: "Cs", mp: "26.5", bp: "130 (åˆ†è§£)", desc: "<strong>æ¬¡ç£·é…¸</strong><br>å–®è³ªå­é…¸ï¼Œå«å…©å€‹ P-H éµèˆ‡ä¸€å€‹ P-OHã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:0,y:-30,z:-60,lpCount:2},{elem:"H",x:55,y:-35,z:35},{elem:"H",x:-55,y:-35,z:35},{elem:"H",x:0,y:-10,z:-100}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4],[2,5]] },
    "H2PO2-|æ¬¡ç£·é…¸æ ¹": { pg: "C2v", mp: "-", bp: "-", desc: "<strong>æ¬¡ç£·é…¸æ ¹</strong><br>å¸¶ -1 åƒ¹é›»è·ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:0,y:-30,z:-60},{elem:"H",x:55,y:-35,z:35},{elem:"H",x:-55,y:-35,z:35}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] },
    "NaH2PO2|æ¬¡ç£·é…¸éˆ‰": { pg: "C2v", mp: "90 (ä¸€æ°´åˆ)", bp: "-", desc: "<strong>æ¬¡ç£·é…¸éˆ‰</strong><br>å¼·é‚„åŸåŠ‘ã€‚", atoms: [{elem:"P",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:0,y:-30,z:-60},{elem:"H",x:55,y:-35,z:35},{elem:"H",x:-55,y:-35,z:35},{elem:"Na",x:-85,y:0,z:0,r:15}], bonds: [[0,1,"double"],[0,2],[0,3],[0,4]] }
});

addMol("HClO4|éæ°¯é…¸ç³»åˆ—", "Cl", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-112", "19 (åˆ†è§£)", [], [], {
    "HClO4|éæ°¯é…¸": { pg: "Cs", mp: "-112", bp: "19 (åˆ†è§£)", desc: "<strong>éæ°¯é…¸</strong><br>æœ€å¼·ç„¡æ©Ÿé…¸ä¹‹ä¸€ï¼Œæ­£å››é¢é«”çµæ§‹ã€‚æ°¯åŸå­èˆ‡ä¸‰å€‹æ°§å½¢æˆé›™éµï¼Œèˆ‡ä¸€å€‹ç¾¥åŸºå½¢æˆå–®éµã€‚", atoms: [{elem:"Cl",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:58,y:-25,z:35,lpCount:2},{elem:"O",x:-58,y:-25,z:35,lpCount:2},{elem:"O",x:0,y:-25,z:-65,lpCount:2},{elem:"H",x:0,y:-5,z:-105}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"double"],[0,4,"single"],[4,5]] },
    "ClO4-|éæ°¯é…¸æ ¹": { pg: "Td", mp: "-", bp: "-", desc: "<strong>éæ°¯é…¸æ ¹</strong><br>åŒ–å­¸æ€§è³ªç©©å®šï¼Œå››å€‹ Cl-O éµé•·å› å…±æŒ¯è€Œå‡ç­‰ (-1åƒ¹)ã€‚", atoms: [{elem:"Cl",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:58,y:-25,z:35},{elem:"O",x:-58,y:-25,z:35},{elem:"O",x:0,y:-25,z:-65}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"double"],[0,4,"single"]] },
    "Mg(ClO4)2|éæ°¯é…¸é‚": { pg: "Td", mp: "251", bp: "-", desc: "<strong>éæ°¯é…¸é‚</strong><br>æ¥µå¼·çš„è„«æ°´åŠ‘ï¼ˆä¹¾ç‡¥åŠ‘ï¼‰ã€‚", atoms: [{elem:"Mg",x:0,y:0,z:0,r:20,lpCount:0}, {elem:"Cl",x:-130,y:0,z:0,lpCount:0},{elem:"O",x:-130,y:68,z:0},{elem:"O",x:-72,y:-25,z:35},{elem:"O",x:-188,y:-25,z:35},{elem:"O",x:-130,y:-25,z:-65}, {elem:"Cl",x:130,y:0,z:0,lpCount:0},{elem:"O",x:130,y:68,z:0},{elem:"O",x:72,y:-25,z:35},{elem:"O",x:188,y:-25,z:35},{elem:"O",x:130,y:-25,z:-65}], bonds: [[1,2,"double"],[1,3,"double"],[1,4,"double"],[1,5,"single"], [6,7,"double"],[6,8,"double"],[6,9,"double"],[6,10,"single"]] },
    "KClO4|éæ°¯é…¸é‰€": { pg: "Td", mp: "610 (åˆ†è§£)", bp: "-", desc: "<strong>éæ°¯é…¸é‰€</strong><br>å¼·æ°§åŒ–åŠ‘ï¼Œç”¨æ–¼ç…™ç«ï¼ˆç´«è‰²ç«ç„°ï¼‰ã€‚", atoms: [{elem:"Cl",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:58,y:-25,z:35},{elem:"O",x:-58,y:-25,z:35},{elem:"O",x:0,y:-25,z:-65},{elem:"K",x:0,y:0,z:95,r:22}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"double"],[0,4,"single"]] },
    "NH4ClO4|éæ°¯é…¸éŠ¨": { pg: "Td", mp: "240 (åˆ†è§£)", bp: "-", desc: "<strong>éæ°¯é…¸éŠ¨ (AP)</strong><br>å›ºé«”ç«ç®­ç‡ƒæ–™æ°§åŒ–åŠ‘ã€‚", atoms: [{elem:"Cl",x:0,y:0,z:0,lpCount:0},{elem:"O",x:0,y:68,z:0},{elem:"O",x:58,y:-25,z:35},{elem:"O",x:-58,y:-25,z:35},{elem:"O",x:0,y:-25,z:-65},{elem:"N",x:110,y:0,z:0,r:18},{elem:"H",x:110,y:40,z:0},{elem:"H",x:110,y:-20,z:35},{elem:"H",x:110,y:-20,z:-35},{elem:"H",x:145,y:0,z:0}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"double"],[0,4,"single"],[5,6],[5,7],[5,8],[5,9]] }
});

addMol("HClO3|æ°¯é…¸ç³»åˆ—", "Cl", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "107Â°", "-20", "åˆ†è§£", [], [], {
    "HClO3|æ°¯é…¸": { pg: "Cs", mp: "-20", bp: "åˆ†è§£", desc: "<strong>æ°¯é…¸</strong><br>å¼·é…¸ï¼Œå…·æœ‰å¼·æ°§åŒ–æ€§ï¼Œä¸­å¿ƒæœ‰ä¸€å°å­¤å°é›»å­ã€‚", atoms: [{elem:"Cl",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28,lpCount:2},{elem:"H",x:-90,y:-20,z:-55}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"],[3,4]] },
    "ClO3-|æ°¯é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>æ°¯é…¸æ ¹</strong><br>ä¸‰è§’éŒå½¢çµæ§‹ï¼Œå¸¸ç”¨æ–¼ç«è—¥èˆ‡ç‚¸è—¥ã€‚", atoms: [{elem:"Cl",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] },
    "KClO3|æ°¯é…¸é‰€": { pg: "C3v", mp: "356", bp: "400 (åˆ†è§£)", desc: "<strong>æ°¯é…¸é‰€</strong><br>å¼·æ°§åŒ–åŠ‘ï¼Œå—ç†±åˆ†è§£ç”¢ç”Ÿæ°§æ°£ã€‚", atoms: [{elem:"Cl",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28},{elem:"K",x:0,y:0,z:85,r:22}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] },
    "NaClO3|æ°¯é…¸éˆ‰": { pg: "C3v", mp: "248", bp: "300 (åˆ†è§£)", desc: "<strong>æ°¯é…¸éˆ‰</strong><br>å·¥æ¥­æ¼‚ç™½èˆ‡é™¤è‰åŠ‘åŸæ–™ã€‚", atoms: [{elem:"Cl",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28},{elem:"Na",x:0,y:0,z:80,r:15}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] }
});

addMol("HClO2|äºæ°¯é…¸ç³»åˆ—", "Cl", "spÂ³", ["è§’å½¢","Bent"], "111Â°", "-", "ä¸ç©©å®š", [], [], {
    "HClO2|äºæ°¯é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>äºæ°¯é…¸</strong><br>å¼±é…¸ï¼Œçµæ§‹å‘ˆVå‹ï¼Œä¸­å¿ƒæœ‰å…©å°å­¤å°é›»å­ã€‚", atoms: [{elem:"Cl",x:0,y:5,z:0,lpCount:2},{elem:"O",x:55,y:-35,z:0},{elem:"O",x:-55,y:-35,z:0,lpCount:2},{elem:"H",x:-90,y:-20,z:0}], bonds: [[0,1,"double"],[0,2,"single"],[2,3]] },
    "ClO2-|äºæ°¯é…¸æ ¹": { pg: "C2v", mp: "-", bp: "-", desc: "<strong>äºæ°¯é…¸æ ¹</strong><br>Vå‹çµæ§‹ï¼Œå¸¸ç”¨æ–¼æ¼‚ç™½åŠ‘ã€‚", atoms: [{elem:"Cl",x:0,y:5,z:0,lpCount:2},{elem:"O",x:55,y:-35,z:0},{elem:"O",x:-55,y:-35,z:0}], bonds: [[0,1,"double"],[0,2,"single"]] },
    "NaClO2|äºæ°¯é…¸éˆ‰": { pg: "C2v", mp: "170 (åˆ†è§£)", bp: "-", desc: "<strong>äºæ°¯é…¸éˆ‰</strong><br>é«˜æ•ˆæ¼‚ç™½åŠ‘ï¼Œåæ‡‰å¯ç”ŸæˆäºŒæ°§åŒ–æ°¯ (ClOâ‚‚)ã€‚", atoms: [{elem:"Cl",x:0,y:5,z:0,lpCount:2},{elem:"O",x:55,y:-35,z:0},{elem:"O",x:-55,y:-35,z:0},{elem:"Na",x:-90,y:0,z:0,r:15}], bonds: [[0,1,"double"],[0,2,"single"]] }
});

addMol("HClO|æ¬¡æ°¯é…¸ç³»åˆ—", "O", "spÂ³", ["è§’å½¢","Bent"], "104.5Â°", "-", "ä¸ç©©å®š", [], [], {
    "HClO|æ¬¡æ°¯é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>æ¬¡æ°¯é…¸</strong><br>å¼±é…¸ï¼Œæ®ºèŒåŠ›å¼·ï¼Œçµæ§‹ H-O-Clã€‚", atoms: [{elem:"O",x:0,y:10,z:0,lpCount:2},{elem:"Cl",x:65,y:-25,z:0},{elem:"H",x:-35,y:-20,z:0}], bonds: [[0,1],[0,2]] },
    "ClO-|æ¬¡æ°¯é…¸æ ¹": { pg: "Cinfv", mp: "-", bp: "-", desc: "<strong>æ¬¡æ°¯é…¸æ ¹</strong><br>æ¼‚ç™½æ°´æœ‰æ•ˆæˆåˆ†ã€‚", atoms: [{elem:"Cl",x:-35,y:0,z:0,lpCount:3},{elem:"O",x:35,y:0,z:0,lpCount:3}], bonds: [[0,1]] },
    "NaClO|æ¬¡æ°¯é…¸éˆ‰|æ¼‚ç™½æ°´": { pg: "Cinfv", mp: "18 (äº”æ°´åˆ)", bp: "åˆ†è§£", desc: "<strong>æ¬¡æ°¯é…¸éˆ‰ (æ¼‚ç™½æ°´)</strong><br>å®¶ç”¨æ¼‚ç™½åŠ‘ã€‚Naâº èˆ‡ ClOâ» ä¹‹é–“ç‚ºé›¢å­éµã€‚", atoms: [{elem:"Cl",x:-35,y:0,z:0,lpCount:3},{elem:"O",x:35,y:0,z:0,lpCount:3},{elem:"Na",x:85,y:0,z:0,r:15}], bonds: [[0,1]] },
    "Ca(ClO)2|æ¬¡æ°¯é…¸éˆ£|æ¼‚ç™½ç²‰": { pg: "Cinfv", mp: "100 (åˆ†è§£)", bp: "-", desc: "<strong>æ¬¡æ°¯é…¸éˆ£</strong><br>æ¼‚ç™½ç²‰ä¸»è¦æˆåˆ†ã€‚", atoms: [{elem:"Cl",x:-55,y:0,z:0,lpCount:3},{elem:"O",x:15,y:0,z:0,lpCount:3},{elem:"Ca",x:60,y:0,z:0,r:20},{elem:"O",x:105,y:0,z:0,lpCount:3},{elem:"Cl",x:175,y:0,z:0,lpCount:3}], bonds: [[0,1], [3,4]] }
});

addMol("HBrO3|æº´é…¸ç³»åˆ—", "Br", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "107Â°", "-", "ä¸ç©©å®š", [], [], {
    "HBrO3|æº´é…¸": { pg: "Cs", mp: "-", bp: "ä¸ç©©å®š", desc: "<strong>æº´é…¸</strong><br>å¼·é…¸ï¼Œä¸­å¿ƒæœ‰ä¸€å°å­¤å°é›»å­ã€‚", atoms: [{elem:"Br",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28,lpCount:2},{elem:"H",x:-90,y:-20,z:-55}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"],[3,4]] },
    "BrO3-|æº´é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>æº´é…¸æ ¹</strong><br>ä¸‰è§’éŒå½¢çµæ§‹ã€‚", atoms: [{elem:"Br",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] },
    "KBrO3|æº´é…¸é‰€": { pg: "C3v", mp: "350 (åˆ†è§£)", bp: "-", desc: "<strong>æº´é…¸é‰€</strong><br>å¼·æ°§åŒ–åŠ‘ï¼ŒKâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"Br",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28},{elem:"K",x:0,y:60,z:0,r:22}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] },
    "AgBrO3|æº´é…¸éŠ€": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>æº´é…¸éŠ€</strong><br>é›£æº¶æ–¼æ°´çš„ç™½è‰²å›ºé«”ã€‚", atoms: [{elem:"Br",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28},{elem:"Ag",x:0,y:60,z:0,r:18}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] }
});

addMol("HIO3|ç¢˜é…¸ç³»åˆ—", "I", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "107Â°", "110", "åˆ†è§£", [], [], {
    "HIO3|ç¢˜é…¸": { pg: "Cs", mp: "110", bp: "åˆ†è§£", desc: "<strong>ç¢˜é…¸</strong><br>ç©©å®šçš„ç™½è‰²å›ºé«”ï¼Œå¼·é…¸ã€‚", atoms: [{elem:"I",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28,lpCount:2},{elem:"H",x:-90,y:-20,z:-55}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"],[3,4]] },
    "IO3-|ç¢˜é…¸æ ¹": { pg: "C3v", mp: "-", bp: "-", desc: "<strong>ç¢˜é…¸æ ¹</strong><br>ä¸‰è§’éŒå½¢çµæ§‹ã€‚", atoms: [{elem:"I",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] },
    "KIO3|ç¢˜é…¸é‰€": { pg: "C3v", mp: "560 (åˆ†è§£)", bp: "-", desc: "<strong>ç¢˜é…¸é‰€</strong><br>é£Ÿé¹½åŠ ç¢˜æˆåˆ†ï¼ŒKâº ä½æ–¼å¤–å´ã€‚", atoms: [{elem:"I",x:0,y:15,z:0,lpCount:1},{elem:"O",x:0,y:-40,z:50},{elem:"O",x:48,y:-40,z:-28},{elem:"O",x:-48,y:-40,z:-28},{elem:"K",x:0,y:60,z:0,r:22}], bonds: [[0,1,"double"],[0,2,"double"],[0,3,"single"]] }
});

// --- 11. ç°¡å–®æœ‰æ©Ÿåˆ†å­èˆ‡è¡ç”Ÿç‰© (éµé•·ä¿®æ­£: C-H=50, C-C=70, C-N=70, C=O=68, C-Cl=75) ---
addMol("CH3NO2|ç¡åŸºç”²çƒ·", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-29", "101.2", [{elem:"O",x:-65,y:50,z:0,lpCount:3},{elem:"O",x:-65,y:-50,z:0},{elem:"N",x:-35,y:0,z:0,lpCount:0},{elem:"C",x:35,y:0,z:0},{elem:"H",x:55,y:-35,z:-25},{elem:"H",x:55,y:35,z:-25},{elem:"H",x:55,y:0,z:45}], [[2,0,"coordinate"],[1,2,"double"],[2,3],[3,4],[3,5],[3,6]], null, null, "Cs");
addMol("C2H6|ä¹™çƒ·", "C", "spÂ³", ["å››é¢é«”é€£çµ","Tetrahedral"], "109.5Â°", "-182.8", "-88.6", [{elem:"C",x:-35,y:0,z:0}, {elem:"C",x:35,y:0,z:0}, {elem:"H",x:-65,y:35,z:0}, {elem:"H",x:-65,y:-25,z:30}, {elem:"H",x:-65,y:-25,z:-30}, {elem:"H",x:65,y:-35,z:0}, {elem:"H",x:65,y:25,z:30}, {elem:"H",x:65,y:25,z:-30}], [[0,1], [0,2], [0,3], [0,4], [1,5], [1,6], [1,7]], null, null, "D3d");
addMol("CH3Cl|ä¸€æ°¯ç”²çƒ·|æ°¯ç”²çƒ·", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-97.4", "-24.2", [{elem:"Cl",x:75,y:0,z:0},{elem:"C",x:0,y:0,z:0},{elem:"H",x:-30,y:30,z:30},{elem:"H",x:-30,y:-40,z:10},{elem:"H",x:-30,y:10,z:-40}], [[0,1],[1,2],[1,3],[1,4]], null, null, "C3v");
addMol("C2H4|ä¹™çƒ¯", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "-169.2", "-103.7", [{elem:"C",x:-32,y:0,z:0}, {elem:"C",x:32,y:0,z:0}, {elem:"H",x:-67,y:45,z:0}, {elem:"H",x:-67,y:-45,z:0}, {elem:"H",x:67,y:45,z:0}, {elem:"H",x:67,y:-45,z:0}], [[0,1,"double"], [0,2], [0,3], [1,4], [1,5]], null, null, "D2h");
addMol("C2H2|ä¹™ç‚”", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-80.8", "-84 (æ˜‡è¯)", [{elem:"C",x:-30,y:0,z:0}, {elem:"C",x:30,y:0,z:0}, {elem:"H",x:-80,y:0,z:0}, {elem:"H",x:80,y:0,z:0}], [[0,1,"triple"], [0,2], [1,3]], null, null, "Dinfh");

addMol("C2H2", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-80.8", "-84", [], [], {
    "C2H2|ä¹™ç‚”": { pg: "Dinfh", mp: "-80.8", bp: "-84", atoms: [{elem:"C",x:-30,y:0,z:0},{elem:"C",x:30,y:0,z:0},{elem:"H",x:-80,y:0,z:0},{elem:"H",x:80,y:0,z:0}], bonds: [[0,1,"triple"], [0,2], [1,3]] }
});

addMol("N2H4|è¯æ°¨|è‚¼", "N", "spÂ³", ["æ‰­è½‰å‹","Gauche"], "107Â°", "2", "114", [{elem:"N",x:-35,y:0,z:0}, {elem:"N",x:35,y:0,z:0}, {elem:"H",x:-60,y:35,z:25}, {elem:"H",x:-60,y:-35,z:25}, {elem:"H",x:60,y:35,z:-25}, {elem:"H",x:60,y:-35,z:-25}], [[0,1], [0,2], [0,3], [1,4], [1,5]], null, null, "C2");

addMol("C3H6O|ä¸™é†›/ä¸™é…® (åŒåˆ†ç•°æ§‹)", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Mixed"], "120Â°", "-81", "48", [], [], 
    {
        "C2H5CHO|ä¸™é†›": { pg: "Cs", mp: "-81", bp: "48", atoms: [{elem:"O",x:-86,y:35,z:0},{elem:"C",x:5,y:-25,z:0},{elem:"C",x:45,y:35,z:0},{elem:"C",x:-60,y:-15,z:0},{elem:"H",x:15,y:-55,z:40},{elem:"H",x:15,y:-55,z:-40},{elem:"H",x:35,y:65,z:-40},{elem:"H",x:35,y:65,z:40},{elem:"H",x:95,y:25,z:0},{elem:"H",x:-85,y:-60,z:0}],  bonds: [[0,3,"double"],[1,2],[1,3],[1,4],[1,5],[2,6],[2,7],[2,8],[3,9]] },
        "CH3COCH3|ä¸™é…®": { pg: "C2v", mp: "-94.7", bp: "56.1", atoms: [{elem:"O",x:0,y:85,z:0},{elem:"C",x:0,y:20,z:0},{elem:"C",x:60,y:-15,z:0},{elem:"C",x:-60,y:-15,z:0},{elem:"H",x:60,y:-45,z:-40},{elem:"H",x:60,y:-45,z:40},{elem:"H",x:100,y:15,z:0},{elem:"H",x:-100,y:15,z:0},{elem:"H",x:-60,y:-45,z:-40},{elem:"H",x:-60,y:-45,z:40}], bonds: [[0,1,"double"],[1,2],[1,3],[2,4],[2,5],[2,6],[3,7],[3,8],[3,9]] }
    }
);

addMol("CH3NH2|ç”²èƒº|ç”²åŸºèƒº", "N", "spÂ³", ["è§’éŒå½¢ (Nç«¯)","Pyramidal"], "107Â°", "-93", "-6.3", [{elem:"N",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:0}]}, {elem:"H",x:30,y:-25,z:20}, {elem:"H",x:-30,y:-25,z:20}, {elem:"C",x:0,y:-25,z:-35}, {elem:"H",x:0,y:5,z:-65}, {elem:"H",x:25,y:-40,z:-55}, {elem:"H",x:-25,y:-40,z:-55}], [[0,1],[0,2],[0,3],[3,4],[3,5],[3,6]], null, null, "Cs");
addMol("CH3OCH3|ç”²é†š|äºŒç”²é†š", "O", "spÂ³", ["è§’å½¢ (ä¸­å¿ƒ)","Bent"], "111Â°", "-141", "-24.8", [{elem:"O",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:1},{x:0,y:1,z:-1}]}, {elem:"C",x:50,y:-20,z:0}, {elem:"C",x:-50,y:-20,z:0}, {elem:"H",x:80,y:0,z:0}, {elem:"H",x:50,y:-50,z:25}, {elem:"H",x:50,y:-50,z:-25}, {elem:"H",x:-80,y:0,z:0}, {elem:"H",x:-50,y:-50,z:25}, {elem:"H",x:-50,y:-50,z:-25}], [[0,1],[0,2],[1,3],[1,4],[1,5],[2,6],[2,7],[2,8]], null, null, "C2v");
addMol("HCOOH|ç”²é…¸|èŸ»é…¸", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "8.4", "100.8", [{elem:"C",x:0,y:0,z:0}, {elem:"O",x:0,y:60,z:0}, {elem:"O",x:50,y:-35,z:0}, {elem:"H",x:-50,y:-35,z:0}, {elem:"H",x:80,y:-15,z:0}], [[0,1,"double"],[0,2],[0,3],[2,4]], null, null, "Cs");
addMol("CH2Cl2|äºŒæ°¯ç”²çƒ·", "C", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-97", "39.6", getTetra("C","H", 50).map((a,i)=>i===1||i===2?{...a,elem:"Cl", x:a.x*1.5, y:a.y*1.5, z:a.z*1.5}:a), [[0,1],[0,2],[0,3],[0,4]], null, null, "C2v");
addMol("CHCl3|ä¸‰æ°¯ç”²çƒ·|æ°¯ä»¿", "C", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-63.5", "61.2", getTetra("C","Cl", 75).map((a,i)=>i===4?{...a,elem:"H", x:a.x*0.66, y:a.y*0.66, z:a.z*0.66}:a), [[0,1],[0,2],[0,3],[0,4]], null, null, "C3v");
addMol("HCN|æ°°åŒ–æ°«|æ°«æ°°é…¸", "C", "sp", ["ç›´ç·šå‹","Linear"], "180Â°", "-13.3", "26", [{elem:"C",x:0,y:0,z:0}, {elem:"N",x:60,y:0,z:0,lpCount:1}, {elem:"H",x:-50,y:0,z:0}], [[0,1,"triple"],[0,2]], null, null, "Cinfv");
addMol("CH3CN|ä¹™è…ˆ|æ°°ç”²çƒ·", "C", "sp", ["ç›´ç·šå‹ (CNç«¯)","Linear"], "180Â°", "-45", "82", [{elem:"C",x:0,y:0,z:0}, {elem:"N",x:60,y:0,z:0,lpCount:1}, {elem:"C",x:-70,y:0,z:0}, {elem:"H",x:-100,y:25,z:0}, {elem:"H",x:-100,y:-15,z:20}, {elem:"H",x:-100,y:-15,z:-20}], [[0,1,"triple"],[0,2],[2,3],[2,4],[2,5]], null, null, "C3v");
addMol("CO(NH2)2|å°¿ç´ ", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "132.7", "åˆ†è§£", [{elem:"C",x:0,y:0,z:0}, {elem:"O",x:0,y:60,z:0}, {elem:"N",x:-50,y:-35,z:0}, {elem:"N",x:50,y:-35,z:0}, {elem:"H",x:-80,y:-15,z:0}, {elem:"H",x:-50,y:-70,z:0}, {elem:"H",x:80,y:-15,z:0}, {elem:"H",x:50,y:-70,z:0}], [[0,1,"double"],[0,2],[0,3],[2,4],[2,5],[3,6],[3,7]], null, null, "C2v");
addMol("SOCl2|äºç¡«é†¯æ°¯|äºŒæ°¯äºç¢¸", "S", "spÂ³", ["è§’éŒå½¢","Pyramidal"], "106Â°", "-104.5", "76", [{elem:"S",x:0,y:15,z:0,lp3d:[{x:0,y:1,z:0}]}, {elem:"O",x:0,y:-35,z:50}, {elem:"Cl",x:60,y:-35,z:-30}, {elem:"Cl",x:-60,y:-35,z:-30}], [[0,1,"double"],[0,2],[0,3]], null, null, "Cs");
addMol("POCl3|ä¸‰æ°¯æ°§åŒ–ç£·|ç£·é†¯æ°¯", "P", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "1.25", "105.8", [{elem:"P",x:0,y:0,z:0}, {elem:"O",x:0,y:65,z:0}, {elem:"Cl",x:55,y:-35,z:35}, {elem:"Cl",x:-55,y:-35,z:35}, {elem:"Cl",x:0,y:0,z:-70}], [[0,1,"double"],[0,2],[0,3],[0,4]], null, null, "C3v");
// C60 (ä½¿ç”¨ IIFE ç”Ÿæˆè³‡æ–™ä¸¦æ·»åŠ åç¨±)
(function(){
    const phi=(1+Math.sqrt(5))/2,scale=28;let rawVerts=[];
    const groups=[[0,1,3*phi],[1,2+phi,2*phi],[phi,2,2*phi+1]];
    function addPermutations(u,v,w){
        const cycles=[[u,v,w],[v,w,u],[w,u,v]];
        cycles.forEach(p=>{
            for(let i=0;i<8;i++){
                let x=p[0]*((i&1)?1:-1),y=p[1]*((i&2)?1:-1),z=p[2]*((i&4)?1:-1);
                rawVerts.push({x,y,z});
            }
        });
    }
    groups.forEach(g=>addPermutations(g[0],g[1],g[2]));
    const atoms=[],threshold=0.1;
    rawVerts.forEach(v=>{
        if(!atoms.some(a=>Math.abs(a.x-v.x*scale)<threshold&&Math.abs(a.y-v.y*scale)<threshold&&Math.abs(a.z-v.z*scale)<threshold)){
            atoms.push({elem:"C",x:v.x*scale,y:v.y*scale,z:v.z*scale,lpCount:0,r:5});
        }
    });
    const bonds=[],bondSet=new Set();
    for(let i=0;i<atoms.length;i++){
        let distances=[];
        for(let j=0;j<atoms.length;j++){
            if(i===j)continue;
            let d=(atoms[i].x-atoms[j].x)**2+(atoms[i].y-atoms[j].y)**2+(atoms[i].z-atoms[j].z)**2;
            distances.push({id:j,dist:d});
        }
        distances.sort((a,b)=>a.dist-b.dist);
        for(let k=0;k<3;k++){
            let neighbor=distances[k].id,id1=Math.min(i,neighbor),id2=Math.max(i,neighbor),key=`${id1}-${id2}`;
            if(!bondSet.has(key)){
                let type=(k===0)?"double":"single";
                bonds.push([id1,id2,type]);
                bondSet.add(key);
            }
        }
    }
    // [ä¿®æ­£] åŠ å…¥ä¸­æ–‡åç¨±æœå°‹
    addMol("C60|ç¢³60|ç¢³å…­å|å¯Œå‹’çƒ¯|è¶³çƒçƒ¯","C","spÂ²",["çƒç‹€ (12å€‹äº”é‚Šå½¢, 20å€‹å…­é‚Šå½¢)","Truncated Icosahedron"],"120Â°", "> 280 (æ˜‡è¯)", "-", atoms,bonds);
})();

// --- 12. æœ‰åŒåˆ†ç•°æ§‹ç‰©çš„æœ‰æ©Ÿåˆ†å­èˆ‡å…¶ä»–æœ‰æ©ŸåŒ–åˆç‰© (å…¨é¢ä¿®æ­£ï¼šKey çµ±ä¸€ç‚º åˆ†å­å¼|ä¸­æ–‡åç¨±) ---
// N2F2 (äºŒæ°ŸäºŒæ°®)
addMol("N2F2", "N", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "-165", "-105", [], [], {
    "N2F2|é †å¼-äºŒæ°ŸäºŒæ°®": { pg: "C2v", mp: "-165", bp: "-105", atoms: [{elem:"N",x:-32,y:0,z:0},{elem:"N",x:32,y:0,z:0},{elem:"F",x:-67,y:60,z:0},{elem:"F",x:67,y:60,z:0}], bonds: [[0,1,"double"],[0,2],[1,3]] },
    "N2F2|åå¼-äºŒæ°ŸäºŒæ°®": { pg: "C2h", mp: "-172", bp: "-111", atoms: [{elem:"N",x:-32,y:0,z:0},{elem:"N",x:32,y:0,z:0},{elem:"F",x:-67,y:60,z:0},{elem:"F",x:67,y:-60,z:0}], bonds: [[0,1,"double"],[0,2],[1,3]] }
});

// C2H2Cl2 (äºŒæ°¯ä¹™çƒ¯)
addMol("C2H2Cl2|äºŒæ°¯ä¹™çƒ¯", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "-81.5", "60.3", [], [], {
    "C2H2Cl2|é †-1,2-äºŒæ°¯ä¹™çƒ¯": { pg: "C2v", mp: "-81.5", bp: "60.3", atoms: [{elem:"C",x:-32,y:0,z:0},{elem:"C",x:32,y:0,z:0},{elem:"Cl",x:-69,y:65,z:0},{elem:"Cl",x:69,y:65,z:0},{elem:"H",x:-57,y:-43,z:0},{elem:"H",x:57,y:-43,z:0}], bonds: [[0,1,"double"],[0,2],[0,4],[1,3],[1,5]] },
    "C2H2Cl2|å-1,2-äºŒæ°¯ä¹™çƒ¯": { pg: "C2h", mp: "-49.4", bp: "47.5", atoms: [{elem:"C",x:-32,y:0,z:0},{elem:"C",x:32,y:0,z:0},{elem:"Cl",x:-69,y:65,z:0},{elem:"Cl",x:69,y:-65,z:0},{elem:"H",x:-57,y:-43,z:0},{elem:"H",x:57,y:43,z:0}], bonds: [[0,1,"double"],[0,2],[0,4],[1,3],[1,5]] },
    "C2H2Cl2|1,1-äºŒæ°¯ä¹™çƒ¯": { pg: "C2v", mp: "-122.6", bp: "31.6", atoms: [{elem:"C",x:-32,y:0,z:0},{elem:"C",x:32,y:0,z:0},{elem:"Cl",x:-69,y:65,z:0},{elem:"Cl",x:-69,y:-65,z:0},{elem:"H",x:57,y:43,z:0},{elem:"H",x:57,y:-43,z:0}], bonds: [[0,1,"double"],[0,2],[0,3],[1,4],[1,5]] }
});

// C5H12 (æˆŠçƒ·)
addMol("C5H12", "C", "spÂ³", ["éˆç‹€/å››é¢é«”","Chain/Tetra"], "109.5Â°", "-129.8", "36.1", [], [], {
    "C5H12|æ­£æˆŠçƒ·": { pg: "C2h", mp: "-129.8", bp: "36.1", atoms: [{elem:"C",x:-140,y:-20,z:0},{elem:"C",x:-70,y:20,z:0},{elem:"C",x:0,y:-20,z:0},{elem:"C",x:70,y:20,z:0},{elem:"C",x:140,y:-20,z:0},{elem:"H",x:-140,y:-70,z:0},{elem:"H",x:-175,y:-5,z:25},{elem:"H",x:-175,y:-5,z:-25},{elem:"H",x:-70,y:70,z:0},{elem:"H",x:-70,y:20,z:50},{elem:"H",x:0,y:-70,z:0},{elem:"H",x:0,y:-20,z:-50},{elem:"H",x:70,y:70,z:0},{elem:"H",x:70,y:20,z:50},{elem:"H",x:140,y:-70,z:0},{elem:"H",x:175,y:-5,z:25},{elem:"H",x:175,y:-5,z:-25}], bonds: [[0,1],[1,2],[2,3],[3,4],[0,5],[0,6],[0,7],[1,8],[1,9],[2,10],[2,11],[3,12],[3,13],[4,14],[4,15],[4,16]] },
    "C5H12|ç•°æˆŠçƒ·": { pg: "Cs", mp: "-159.9", bp: "27.8", atoms: [{elem:"C",x:-80,y:-20,z:0},{elem:"C",x:-10,y:20,z:0},{elem:"C",x:60,y:-20,z:0},{elem:"C",x:130,y:20,z:0},{elem:"C",x:-10,y:90,z:0},{elem:"H",x:-80,y:-70,z:0},{elem:"H",x:-115,y:-5,z:25},{elem:"H",x:-115,y:-5,z:-25},{elem:"H",x:-10,y:20,z:50},{elem:"H",x:60,y:-70,z:0},{elem:"H",x:60,y:-20,z:-50},{elem:"H",x:130,y:70,z:0},{elem:"H",x:165,y:-5,z:25},{elem:"H",x:165,y:-5,z:-25},{elem:"H",x:-10,y:140,z:0},{elem:"H",x:-45,y:105,z:25},{elem:"H",x:25,y:105,z:25}], bonds: [[0,1],[1,2],[2,3],[1,4],[0,5],[0,6],[0,7],[1,8],[2,9],[2,10],[3,11],[3,12],[3,13],[4,14],[4,15],[4,16]] },
    "C5H12|æ–°æˆŠçƒ·": { pg: "Td", mp: "-16.5", bp: "9.5", atoms: [{elem:"C",x:0,y:0,z:0},{elem:"C",x:0,y:70,z:0},{elem:"C",x:66,y:-23,z:0},{elem:"C",x:-33,y:-23,z:57},{elem:"C",x:-33,y:-23,z:-57},{elem:"H",x:0,y:120,z:0},{elem:"H",x:-35,y:85,z:35},{elem:"H",x:35,y:85,z:35},{elem:"H",x:116,y:-23,z:0},{elem:"H",x:80,y:-60,z:35},{elem:"H",x:80,y:-60,z:-35},{elem:"H",x:-83,y:-23,z:57},{elem:"H",x:-20,y:27,z:80},{elem:"H",x:-20,y:-73,z:80},{elem:"H",x:-83,y:-23,z:-57},{elem:"H",x:-20,y:27,z:-80},{elem:"H",x:-20,y:-73,z:-80}], bonds: [[0,1],[0,2],[0,3],[0,4],[1,5],[1,6],[1,7],[2,8],[2,9],[2,10],[3,11],[3,12],[3,13],[4,14],[4,15],[4,16]] }
});

// C4H8 (ä¸çƒ¯/ç’°ä¸çƒ·)
addMol("C4H8", "C", "sp3", ["å½¢ç‹€","Shape"], "N/A", "-185.3", "-6.3", [], [], {
    "C4H8|1-ä¸çƒ¯": { pg: "Cs", mp: "-185.3", bp: "-6.3", atoms: [{elem:"C",x:30,y:-35,z:-15},{elem:"C",x:80,y:20,z:5},{elem:"C",x:-40,y:-20,z:20},{elem:"C",x:-90,y:20,z:-10},{elem:"H",x:25,y:-40,z:-65},{elem:"H",x:50,y:-80,z:5},{elem:"H",x:120,y:10,z:-20},{elem:"H",x:70,y:70,z:-15},{elem:"H",x:90,y:30,z:55},{elem:"H",x:-50,y:-40,z:65},{elem:"H",x:-130,y:25,z:15},{elem:"H",x:-80,y:40,z:-60}], bonds: [[0,1],[0,2],[0,4],[0,5],[1,6],[1,7],[1,8],[2,3,"double"],[2,9],[3,10],[3,11]] },
    "C4H8|é †-2-ä¸çƒ¯": { pg: "C2v", mp: "-138.9", bp: "3.7", atoms: [{elem:"C",x:-32,y:-40,z:0},{elem:"C",x:32,y:-40,z:0},{elem:"C",x:-75,y:25,z:0},{elem:"C",x:75,y:25,z:0},{elem:"H",x:-57,y:-85,z:0},{elem:"H",x:57,y:-85,z:0},{elem:"H",x:-115,y:15,z:-30},{elem:"H",x:-55,y:65,z:-20},{elem:"H",x:-90,y:35,z:50},{elem:"H",x:115,y:15,z:30},{elem:"H",x:55,y:65,z:20},{elem:"H",x:90,y:35,z:-50}], bonds: [[0,1,"double"],[0,2],[0,4],[1,3],[1,5],[2,6],[2,7],[2,8],[3,9],[3,10],[3,11]] },
    "C4H8|å-2-ä¸çƒ¯": { pg: "C2h", mp: "-105.5", bp: "0.9", atoms: [{elem:"C",x:-30,y:20,z:0},{elem:"C",x:30,y:-20,z:0},{elem:"C",x:-90,y:-10,z:0},{elem:"C",x:90,y:10,z:0},{elem:"H",x:-20,y:70,z:0},{elem:"H",x:20,y:-70,z:0},{elem:"H",x:-115,y:10,z:40},{elem:"H",x:-95,y:-60,z:0},{elem:"H",x:-115,y:10,z:-40},{elem:"H",x:115,y:-10,z:40},{elem:"H",x:95,y:60,z:0},{elem:"H",x:115,y:-10,z:-40}], bonds: [[0,1,"double"],[0,2],[0,4],[1,3],[1,5],[2,6],[2,7],[2,8],[3,9],[3,10],[3,11]] },
    "C4H8|2-ç”²åŸºä¸™çƒ¯": { pg: "C2v", mp: "-140.3", bp: "-6.9", atoms: [{elem:"C",x:0,y:10,z:0},{elem:"C",x:-60,y:-25,z:0},{elem:"C",x:60,y:-25,z:0},{elem:"C",x:0,y:73,z:0},{elem:"H",x:-65,y:-60,z:40},{elem:"H",x:-65,y:-60,z:-40},{elem:"H",x:-105,y:5,z:0},{elem:"H",x:65,y:-60,z:-40},{elem:"H",x:65,y:-60,z:40},{elem:"H",x:105,y:5,z:0},{elem:"H",x:43,y:98,z:0},{elem:"H",x:-43,y:98,z:0}], bonds: [[0,1],[0,2],[0,3,"double"],[1,4],[1,5],[1,6],[2,7],[2,8],[2,9],[3,10],[3,11]] },
    "C4H8|ç’°ä¸çƒ·": { pg: "D2d", mp: "-91", bp: "12.5", atoms: [{elem:"C",x:35,y:35,z:10},{elem:"C",x:-35,y:35,z:-10},{elem:"C",x:-35,y:-35,z:10},{elem:"C",x:35,y:-35,z:-10},{elem:"H",x:45,y:45,z:60},{elem:"H",x:60,y:60,z:-30},{elem:"H",x:-45,y:45,z:-60},{elem:"H",x:-60,y:60,z:30},{elem:"H",x:-60,y:-60,z:30},{elem:"H",x:-45,y:-45,z:60},{elem:"H",x:60,y:-60,z:-30},{elem:"H",x:45,y:-45,z:-60}], bonds: [[0,1],[1,2],[2,3],[3,0],[0,4],[0,5],[1,6],[1,7],[2,8],[2,9],[3,10],[3,11]] },
    "C4H8|ç”²åŸºç’°ä¸™çƒ·": { pg: "Cs", mp: "-117.2", bp: "0.7", atoms: [{elem:"C",x:-10,y:0,z:35},{elem:"C",x:50,y:-35,z:0},{elem:"C",x:50,y:35,z:0},{elem:"C",x:-70,y:0,z:-10},{elem:"H",x:-20,y:0,z:85},{elem:"H",x:80,y:-60,z:30},{elem:"H",x:40,y:-60,z:-50},{elem:"H",x:40,y:60,z:-50},{elem:"H",x:80,y:60,z:30},{elem:"H",x:-100,y:-45,z:5},{elem:"H",x:-60,y:0,z:-60},{elem:"H",x:-100,y:45,z:5}], bonds: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,5],[1,6],[2,7],[2,8],[3,9],[3,10],[3,11]] }
});


// C8H10 (äºŒç”²è‹¯é¡) - å·²ä¸­å¿ƒåŒ–èª¿æ•´
addMol("C8H10", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Planar/Tetra"], "120Â°", "-47.8", "139", [], [], {
"C8H10|ä¹™è‹¯|Ethylbenzene": { pg: "Cs", symVectors: { "s": [0,0,1] }, atoms: [{elem:"C",x:0,y:63,z:0},{elem:"C",x:54,y:31,z:0},{elem:"C",x:54,y:-31,z:0},{elem:"C",x:0,y:-63,z:0},{elem:"C",x:-54,y:-31,z:0},{elem:"C",x:-54,y:31,z:0},{elem:"C",x:0,y:129,z:0},{elem:"C",x:66,y:141,z:0},{elem:"H",x:96,y:56,z:0},{elem:"H",x:96,y:-56,z:0},{elem:"H",x:0,y:-112,z:0},{elem:"H",x:-96,y:-56,z:0},{elem:"H",x:-96,y:56,z:0},{elem:"H",x:-39,y:139,z:0},{elem:"H",x:66,y:209,z:0},{elem:"H",x:114,y:101,z:0}], bonds: [[0,1,"double"],[1,2],[2,3,"double"],[3,4],[4,5,"double"],[5,0],[0,6],[1,8],[2,9],[3,10],[4,11],[5,12],[6,7],[6,13],[7,14],[7,15]] },
"C8H10|é„°äºŒç”²è‹¯|o-Xylene": { pg: "C2v", symVectors: { "C2": [0,1,0], "sv": [0,0,1], "sv2": [1,0,0] }, atoms: [{elem:"C",x:31,y:54,z:0},{elem:"C",x:-31,y:54,z:0},{elem:"C",x:63,y:0,z:0},{elem:"C",x:-63,y:0,z:0},{elem:"C",x:31,y:-54,z:0},{elem:"C",x:-31,y:-54,z:0},{elem:"C",x:66,y:112,z:0},{elem:"C",x:-66,y:112,z:0},{elem:"H",x:112,y:0,z:0},{elem:"H",x:56,y:-97,z:0},{elem:"H",x:-56,y:-97,z:0},{elem:"H",x:-112,y:0,z:0},{elem:"H",x:115,y:104,z:0},{elem:"H",x:56,y:139,z:40},{elem:"H",x:56,y:139,z:-40},{elem:"H",x:-115,y:104,z:0},{elem:"H",x:-56,y:139,z:40},{elem:"H",x:-56,y:139,z:-40}], bonds: [[0,1],[0,2,"double"],[0,6],[1,3,"double"],[1,7],[2,4],[2,8],[3,5],[3,11],[4,5,"double"],[4,9],[5,10],[6,12],[6,13],[6,14],[7,15],[7,16],[7,17]] },
"C8H10|é–“äºŒç”²è‹¯|m-Xylene": { pg: "C2v", symVectors: { "C2": [0,1,0], "sv": [0,0,1], "sv2": [1,0,0] }, atoms: [{elem:"C",x:-54,y:31.5,z:0},{elem:"C",x:54,y:31.5,z:0},{elem:"C",x:0,y:62.5,z:0},{elem:"C",x:-54,y:-31.5,z:0},{elem:"C",x:54,y:-31.5,z:0},{elem:"C",x:0,y:-62.5,z:0},{elem:"C",x:-112,y:64.5,z:0},{elem:"C",x:112,y:64.5,z:0},{elem:"H",x:0,y:111.5,z:0},{elem:"H",x:-96,y:-56.5,z:0},{elem:"H",x:96,y:-56.5,z:0},{elem:"H",x:0,y:-111.5,z:0},{elem:"H",x:-148,y:38.5,z:0},{elem:"H",x:-126,y:74.5,z:46},{elem:"H",x:-108,y:107.5,z:-46},{elem:"H",x:148,y:38.5,z:0},{elem:"H",x:126,y:74.5,z:46},{elem:"H",x:108,y:107.5,z:-46}], bonds: [[0,2,"double"],[0,3],[0,6],[1,2],[1,4,"double"],[1,7],[2,8],[3,5,"double"],[3,9],[4,5],[4,10],[5,11],[6,12],[6,13],[6,14],[7,15],[7,16],[7,17]] },
"C8H10|å°äºŒç”²è‹¯|p-Xylene": { pg: "D2h", symVectors: { "C2x": [1,0,0], "C2y": [0,1,0], "C2z": [0,0,1], "sh": [0,0,1], "i": [0,0,0] }, atoms: [{elem:"C",x:63,y:0,z:0},{elem:"C",x:-63,y:0,z:0},{elem:"C",x:31,y:-54,z:0},{elem:"C",x:-31,y:-54,z:0},{elem:"C",x:31,y:54,z:0},{elem:"C",x:-31,y:54,z:0},{elem:"C",x:130,y:0,z:0},{elem:"C",x:-130,y:0,z:0},{elem:"H",x:55,y:-97,z:0},{elem:"H",x:-55,y:-97,z:0},{elem:"H",x:55,y:97,z:0},{elem:"H",x:-55,y:97,z:0},{elem:"H",x:148,y:40,z:0},{elem:"H",x:148,y:-40,z:46},{elem:"H",x:147,y:0,z:-46},{elem:"H",x:-148,y:40,z:0},{elem:"H",x:-148,y:-40,z:46},{elem:"H",x:-147,y:0,z:-46}], bonds: [[0,2,"double"],[0,4],[0,6],[1,3,"double"],[1,5],[1,7],[2,3],[2,8],[3,9],[4,5,"double"],[4,10],[5,11],[6,12],[6,13],[6,14],[7,15],[7,16],[7,17]] }
}, null, null, "D2h");


// C6H12O6 (å·±ç³–)
addMol("C6H12O6", "C", "spÂ³", ["éˆç‹€/ç’°ç‹€","Chain/Ring"], "109.5Â°", "146", "dec.", [], [], {
    "C6H12O6|åŠä¹³ç³–": { pg: "C1", mp: "167", bp: "dec.", atoms: [{elem:"O",x:35,y:-42,z:-14},{elem:"O",x:14,y:76,z:-59},{elem:"O",x:-95,y:91,z:1},{elem:"O",x:-127,y:-35,z:16},{elem:"O",x:-39,y:-115,z:-30},{elem:"O",x:154,y:-27,z:13},{elem:"C",x:11,y:63,z:4},{elem:"C",x:-54,y:45,z:20},{elem:"C",x:53,y:10,z:18},{elem:"C",x:-71,y:-15,z:-9},{elem:"C",x:-24,y:-63,z:4},{elem:"C",x:118,y:24,z:-1},{elem:"H",x:24,y:104,z:27},{elem:"H",x:-58,y:42,z:69},{elem:"H",x:53,y:0,z:66},{elem:"H",x:-79,y:-9,z:-57},{elem:"H",x:-24,y:-75,z:51},{elem:"H",x:122,y:31,z:-50},{elem:"H",x:136,y:63,z:22},{elem:"H",x:9,y:39,z:-82},{elem:"H",x:-135,y:77,z:12},{elem:"H",x:-137,y:-73,z:-3},{elem:"H",x:-21,y:-149,z:-10},{elem:"H",x:138,y:-61,z:-8}], bonds: [[0,8],[0,10],[1,6],[1,19],[2,7],[2,20],[3,9],[3,21],[4,10],[4,22],[5,11],[5,23],[6,7],[6,8],[6,12],[7,9],[7,13],[8,11],[8,14],[9,10],[9,15],[10,16],[11,17],[11,18]] },
    "C6H12O6|è‘¡è„ç³–": { pg: "C1", mp: "146", bp: "dec.", atoms: [{elem:"O",x:-26,y:-57,z:14},{elem:"O",x:-36,y:106,z:-13},{elem:"O",x:88,y:88,z:24},{elem:"O",x:132,y:-29,z:-18},{elem:"O",x:54,y:-124,z:14},{elem:"O",x:-148,y:-48,z:-6},{elem:"C",x:-13,y:51,z:13},{elem:"C",x:53,y:44,z:-6},{elem:"C",x:-51,y:-2,z:-8},{elem:"C",x:76,y:-19,z:11},{elem:"C",x:32,y:-68,z:-9},{elem:"C",x:-116,y:2,z:15},{elem:"H",x:-15,y:56,z:62},{elem:"H",x:58,y:52,z:-55},{elem:"H",x:-53,y:-4,z:-58},{elem:"H",x:85,y:-21,z:59},{elem:"H",x:31,y:-73,z:-58},{elem:"H",x:-117,y:2,z:64},{elem:"H",x:-138,y:43,z:-2},{elem:"H",x:-35,y:102,z:-56},{elem:"H",x:71,y:127,z:12},{elem:"H",x:126,y:-27,z:-62},{elem:"H",x:71,y:-117,z:54},{elem:"H",x:-128,y:-84,z:9}], bonds: [[0,8],[0,10],[1,6],[1,19],[2,7],[2,20],[3,9],[3,21],[4,10],[4,22],[5,11],[5,23],[6,7],[6,8],[6,12],[7,9],[7,13],[8,11],[8,14],[9,10],[9,15],[10,16],[11,17],[11,18]] },
    "C6H12O6|æœç³–": { pg: "C1", mp: "103", bp: "dec.", atoms: [{elem:"O",x:30,y:-58,z:-2},{elem:"O",x:4,y:106,z:-2},{elem:"O",x:60,y:18,z:67},{elem:"O",x:-117,y:57,z:-1},{elem:"O",x:-92,y:-55,z:-46},{elem:"O",x:148,y:-20,z:-14},{elem:"C",x:-9,y:44,z:-13},{elem:"C",x:45,y:5,z:6},{elem:"C",x:-66,y:26,z:21},{elem:"C",x:-77,y:-42,z:15},{elem:"C",x:-21,y:-77,z:32},{elem:"C",x:100,y:18,z:-33},{elem:"H",x:-18,y:39,z:-62},{elem:"H",x:-61,y:38,z:69},{elem:"H",x:-115,y:-56,z:43},{elem:"H",x:-27,y:-125,z:22},{elem:"H",x:-11,y:-73,z:80},{elem:"H",x:91,y:9,z:-81},{elem:"H",x:115,y:64,z:-28},{elem:"H",x:34,y:119,z:-32},{elem:"H",x:102,y:8,z:73},{elem:"H",x:-118,y:53,z:-45},{elem:"H",x:-131,y:-38,z:-54},{elem:"H",x:134,y:-61,z:-18}], bonds: [[0,7],[0,10],[1,6],[1,19],[2,7],[2,20],[3,8],[3,21],[4,9],[4,22],[5,11],[5,23],[6,7],[6,8],[6,12],[7,11],[8,9],[8,13],[9,10],[9,14],[10,15],[10,16],[11,17],[11,18]] }
});

addMol("C4H4O4", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "", "", [], [], {
    "C4H4O4|é †ä¸çƒ¯äºŒé…¸": { pg: "C2v", mp: "131", bp: "135 (dec)", atoms: [{elem:"C",x:-57,y:-5,z:-2},{elem:"C",x:-29,y:49,z:3},{elem:"C",x:-29,y:-65,z:-6},{elem:"C",x:36,y:62,z:6},{elem:"O",x:19,y:-73,z:31},{elem:"O",x:-49,y:-105,z:-38},{elem:"O",x:70,y:28,z:-31},{elem:"O",x:57,y:101,z:38},{elem:"H",x:-106,y:-6,z:-5},{elem:"H",x:-57,y:89,z:7},{elem:"H",x:33,y:-114,z:23},{elem:"H",x:111,y:40,z:-25}], bonds: [[0,1,"double"],[0,2],[0,8],[1,3],[1,9],[2,4],[2,5,"double"],[3,6],[3,7,"double"],[4,10],[6,11]] },
    "C4H4O4|åä¸çƒ¯äºŒé…¸": { pg: "C2h", mp: "287", bp: "290 (subl)", atoms: [{elem:"C",x:-15,y:25,z:-8},{elem:"C",x:15,y:-25,z:8},{elem:"C",x:-80,y:31,z:5},{elem:"C",x:80,y:-31,z:-5},{elem:"O",x:-101,y:84,z:-16},{elem:"O",x:-111,y:-5,z:30},{elem:"O",x:101,y:-84,z:16},{elem:"O",x:111,y:6,z:-30},{elem:"H",x:8,y:61,z:-32},{elem:"H",x:-8,y:-61,z:32},{elem:"H",x:-144,y:85,z:-6},{elem:"H",x:144,y:-85,z:6}], bonds: [[0,1,"double"],[0,2],[0,8],[1,3],[1,9],[2,4],[2,5,"double"],[3,6],[3,7,"double"],[4,10],[6,11]] }
});

addMol("C3H6", "C", "sp3", ["å››é¢é«”","Tetrahedral"], "109.5", "-185.2", "-47.6", [], [], {
    "C3H6|ä¸™çƒ¯": { pg: "Cs", mp: "-185.2", bp: "-47.6", atoms: [{elem:"C",x:54,y:7,z:0},{elem:"C",x:-9,y:-28,z:0},{elem:"C",x:-65,y:9,z:0},{elem:"H",x:79,y:-15,z:-40},{elem:"H",x:54,y:60,z:0},{elem:"H",x:79,y:-15,z:40},{elem:"H",x:-9,y:-78,z:0},{elem:"H",x:-105,y:-20,z:0},{elem:"H",x:-65,y:60,z:0}], bonds: [[0,1],[0,3],[0,4],[0,5],[1,2,"double"],[1,6],[2,7],[2,8]] },
    "C3H6|ç’°ä¸™çƒ·": { pg: "D3h", mp: "-127.6", bp: "-32.9", atoms: [{elem:"C",x:0,y:-40,z:0},{elem:"C",x:-35,y:20,z:0},{elem:"C",x:35,y:20,z:0},{elem:"H",x:0,y:-75,z:-40},{elem:"H",x:0,y:-75,z:40},{elem:"H",x:-65,y:35,z:40},{elem:"H",x:-65,y:35,z:-40},{elem:"H",x:65,y:35,z:-40},{elem:"H",x:65,y:35,z:40}], bonds: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,5],[1,6],[2,7],[2,8]] }
});

addMol("C3H8O", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-126", "97.2", [], [], {
    "C3H8O|1-ä¸™é†‡": { pg: "Cs", mp: "-126", bp: "97.2", atoms: [{elem:"O",x:115,y:10,z:-5},{elem:"C",x:-5,y:25,z:-5},{elem:"C",x:55,y:-25,z:-5},{elem:"C",x:-70,y:-10,z:-5},{elem:"H",x:0,y:55,z:-45},{elem:"H",x:0,y:55,z:40},{elem:"H",x:50,y:-55,z:-45},{elem:"H",x:50,y:-55,z:40},{elem:"H",x:-75,y:-40,z:-45},{elem:"H",x:-110,y:25,z:-5},{elem:"H",x:-75,y:-40,z:40},{elem:"H",x:120,y:40,z:35}], bonds: [[0,2],[0,11],[1,2],[1,3],[1,4],[1,5],[2,6],[2,7],[3,8],[3,9],[3,10]] },
    "C3H8O|2-ä¸™é†‡": { pg: "Cs", mp: "-89", bp: "82.3", atoms: [{elem:"O",x:0,y:-80,z:-5},{elem:"C",x:0,y:-15,z:25},{elem:"C",x:-60,y:20,z:0},{elem:"C",x:60,y:20,z:0},{elem:"H",x:0,y:-15,z:75},{elem:"H",x:-60,y:70,z:20},{elem:"H",x:-100,y:-10,z:20},{elem:"H",x:-60,y:20,z:-50},{elem:"H",x:60,y:70,z:20},{elem:"H",x:100,y:-10,z:20},{elem:"H",x:60,y:20,z:-50},{elem:"H",x:0,y:-80,z:-55}], bonds: [[0,1],[0,11],[1,2],[1,3],[1,4],[2,5],[2,6],[2,7],[3,8],[3,9],[3,10]] },
    "C3H8O|ç”²ä¹™é†š": { pg: "Cs", mp: "-113", bp: "7.4", atoms: [{elem:"O",x:0,y:20,z:0},{elem:"C",x:-50,y:-15,z:0},{elem:"C",x:50,y:-15,z:0},{elem:"C",x:95,y:20,z:0},{elem:"H",x:-50,y:-45,z:25},{elem:"H",x:-50,y:-45,z:-25},{elem:"H",x:-85,y:5,z:0},{elem:"H",x:50,y:-45,z:25},{elem:"H",x:50,y:-45,z:-25},{elem:"H",x:95,y:50,z:0},{elem:"H",x:130,y:0,z:25},{elem:"H",x:130,y:0,z:-25}], bonds: [[0,1],[0,2],[1,4],[1,5],[1,6],[2,3],[2,7],[2,8],[3,9],[3,10],[3,11]] }
});

addMol("C3H6Cl2", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-78", "87", [], [], {
    "C3H6Cl2|1,1-äºŒæ°¯ä¸™çƒ·": { pg: "Cs", mp: "-78", bp: "87", atoms: [{elem:"Cl",x:85,y:60,z:-15},{elem:"Cl",x:85,y:-60,z:-15},{elem:"C",x:-15,y:0,z:30},{elem:"C",x:55,y:0,z:20},{elem:"C",x:-55,y:0,z:-35},{elem:"H",x:-30,y:-45,z:55},{elem:"H",x:-30,y:45,z:55},{elem:"H",x:75,y:0,z:70},{elem:"H",x:-45,y:45,z:-65},{elem:"H",x:-105,y:0,z:-25},{elem:"H",x:-45,y:-45,z:-65}], bonds: [[0,3],[1,3],[2,3],[2,4],[2,5],[2,6],[3,7],[4,8],[4,9],[4,10]] },
    "C3H6Cl2|1,2-äºŒæ°¯ä¸™çƒ·": { pg: "C1", mp: "-100.4", bp: "96", atoms: [{elem:"Cl",x:-45,y:-80,z:20},{elem:"Cl",x:95,y:-30,z:30},{elem:"C",x:-25,y:-15,z:-15},{elem:"C",x:45,y:-20,z:-30},{elem:"C",x:-35,y:45,z:30},{elem:"H",x:-50,y:-10,z:-60},{elem:"H",x:65,y:25,z:-55},{elem:"H",x:55,y:-60,z:-60},{elem:"H",x:-15,y:40,z:75},{elem:"H",x:-85,y:50,z:35},{elem:"H",x:-20,y:90,z:10}], bonds: [[0,2],[1,3],[2,3],[2,4],[2,5],[3,6],[3,7],[4,8],[4,9],[4,10]] },
    "C3H6Cl2|1,3-äºŒæ°¯ä¸™çƒ·": { pg: "C2v", mp: "-99.5", bp: "120.4", atoms: [{elem:"Cl",x:90,y:50,z:-15},{elem:"Cl",x:-90,y:50,z:15},{elem:"C",x:0,y:-30,z:0},{elem:"C",x:50,y:10,z:35},{elem:"C",x:-50,y:10,z:-35},{elem:"H",x:-25,y:-65,z:35},{elem:"H",x:25,y:-65,z:-35},{elem:"H",x:85,y:-25,z:55},{elem:"H",x:30,y:40,z:70},{elem:"H",x:-30,y:40,z:-70},{elem:"H",x:-85,y:-25,z:-55}], bonds: [[0,3],[1,4],[2,3],[2,4],[2,5],[2,6],[3,7],[3,8],[4,9],[4,10]] },
    "C3H6Cl2|2,2-äºŒæ°¯ä¸™çƒ·": { pg: "C2v", mp: "-33.8", bp: "69.3", atoms: [{elem:"Cl",x:-60,y:-70,z:0},{elem:"Cl",x:60,y:-70,z:0},{elem:"C",x:0,y:-25,z:0},{elem:"C",x:0,y:20,z:60},{elem:"C",x:0,y:20,z:-60},{elem:"H",x:0,y:-10,z:105},{elem:"H",x:-45,y:50,z:60},{elem:"H",x:45,y:50,z:60},{elem:"H",x:45,y:50,z:-60},{elem:"H",x:0,y:-10,z:-105},{elem:"H",x:-45,y:50,z:-60}], bonds: [[0,2],[1,2],[2,3],[2,4],[3,5],[3,6],[3,7],[4,8],[4,9],[4,10]] }
});

addMol("C3H7Cl", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-122.8", "46.6", [], [], {
    "C3H7Cl|1-æ°¯ä¸™çƒ·": { pg: "Cs", mp: "-122.8", bp: "46.6", atoms: [{elem:"Cl",x:105,y:28,z:-5},{elem:"C",x:-15,y:-22,z:-18},{elem:"C",x:55,y:-30,z:12},{elem:"C",x:-50,y:40,z:5},{elem:"H",x:-12,y:-20,z:-68},{elem:"H",x:-45,y:-65,z:-5},{elem:"H",x:52,y:-32,z:62},{elem:"H",x:78,y:-75,z:-5},{elem:"H",x:-52,y:42,z:55},{elem:"H",x:-100,y:40,z:-15},{elem:"H",x:-25,y:85,z:-12}], bonds: [[0,2],[1,2],[1,3],[1,4],[1,5],[2,6],[2,7],[3,8],[3,9],[3,10]] },
    "C3H7Cl|2-æ°¯ä¸™çƒ·": { pg: "Cs", mp: "-117.2", bp: "35.7", atoms: [{elem:"Cl",x:90,y:0,z:-5},{elem:"C",x:15,y:0,z:20},{elem:"C",x:-20,y:60,z:-5},{elem:"C",x:-20,y:-60,z:-5},{elem:"H",x:14,y:0,z:70},{elem:"H",x:5,y:105,z:15},{elem:"H",x:-65,y:60,z:10},{elem:"H",x:-20,y:60,z:-55},{elem:"H",x:5,y:-105,z:15},{elem:"H",x:-65,y:-60,z:10},{elem:"H",x:-20,y:-60,z:-55}], bonds: [[0,1],[1,2],[1,3],[1,4],[2,5],[2,6],[2,7],[3,8],[3,9],[3,10]] }
});


addMol("C2H4Cl2|äºŒæ°¯ä¹™çƒ·", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-96.9", "57.3", [], [], 
    {
        "C2H4Cl2|1,1-äºŒæ°¯ä¹™çƒ·": { pg: "Cs", mp: "-96.9", bp: "57.3", atoms: [{elem:"Cl",x:66,y:68,z:-9},{elem:"Cl",x:-66,y:68,z:-9},{elem:"C",x:0,y:28,z:15},{elem:"C",x:0,y:-35,z:-10},{elem:"H",x:0,y:27,z:64},{elem:"H",x:0,y:-35,z:-60},{elem:"H",x:-40,y:60,z:5},{elem:"H",x:40,y:60,z:5}], bonds: [[0,2],[1,2],[2,3],[2,4],[3,5],[3,6],[3,7]] },
        "C2H4Cl2|1,2-äºŒæ°¯ä¹™çƒ·": { pg: "C2h", mp: "-35.7", bp: "83.5", atoms: [{elem:"Cl",x:74,y:58,z:6},{elem:"Cl",x:-74,y:58,z:-6},{elem:"C",x:31,y:-6,z:-15},{elem:"C",x:-31,y:-6,z:15},{elem:"H",x:27,y:-6,z:-64},{elem:"H",x:56,y:-46,z:-2},{elem:"H",x:-56,y:-46,z:2},{elem:"H",x:-27,y:-6,z:64}], bonds: [[0,2],[1,3],[2,3],[2,4],[2,5],[3,6],[3,7]] }
    }
);

addMol("C6H4Cl2|äºŒæ°¯è‹¯", "C", "spÂ²", ["å¹³é¢ (è‹¯ç’°)","Planar"], "120Â°", "-17", "180.5", [], [], {
"C6H4Cl2|é„°äºŒæ°¯è‹¯|1,2-Dichlorobenzene": { pg: "C2v", mp: "-17", bp: "180.5", atoms: [{elem:"C",x:-39,y:68,z:0},{elem:"C",x:39,y:68,z:0},{elem:"C",x:78,y:0,z:0},{elem:"C",x:39,y:-68,z:0},{elem:"C",x:-39,y:-68,z:0},{elem:"C",x:-78,y:0,z:0},{elem:"Cl",x:-68,y:117,z:0},{elem:"Cl",x:68,y:117,z:0},{elem:"H",x:135,y:0,z:0},{elem:"H",x:68,y:-117,z:0},{elem:"H",x:-68,y:-117,z:0},{elem:"H",x:-135,y:0,z:0}], bonds: [[0,1,"double"],[1,2],[2,3,"double"],[3,4],[4,5,"double"],[5,0],[0,6],[1,7],[2,8],[3,9],[4,10],[5,11]] },
"C6H4Cl2|é–“äºŒæ°¯è‹¯|1,3-Dichlorobenzene": { pg: "C2v", mp: "-24.7", bp: "173", atoms: [{elem:"C",x:-68,y:39,z:0},{elem:"C",x:0,y:78,z:0},{elem:"C",x:68,y:39,z:0},{elem:"C",x:68,y:-39,z:0},{elem:"C",x:0,y:-78,z:0},{elem:"C",x:-68,y:-39,z:0},{elem:"Cl",x:-117,y:68,z:0},{elem:"Cl",x:117,y:68,z:0},{elem:"H",x:0,y:135,z:0},{elem:"H",x:117,y:-68,z:0},{elem:"H",x:0,y:-135,z:0},{elem:"H",x:-117,y:-68,z:0}], bonds: [[0,1,"double"],[1,2],[2,3,"double"],[3,4],[4,5,"double"],[5,0],[0,6],[2,7],[1,8],[3,9],[4,10],[5,11]] },
"C6H4Cl2|å°äºŒæ°¯è‹¯|1,4-Dichlorobenzene": { pg: "D2h", mp: "53.5", bp: "174", symVectors: { "C2_1": [1,0,0], "C2_2": [0,1,0], "C2_3": [0,0,1], "sh": [0,0,1], "sv1": [1,0,0], "sv2": [0,1,0] }, atoms: [{elem:"C",x:78,y:0,z:0},{elem:"C",x:39,y:-68,z:0},{elem:"C",x:-39,y:-68,z:0},{elem:"C",x:-78,y:0,z:0},{elem:"C",x:-39,y:68,z:0},{elem:"C",x:39,y:68,z:0},{elem:"Cl",x:135,y:0,z:0},{elem:"Cl",x:-135,y:0,z:0},{elem:"H",x:68,y:-117,z:0},{elem:"H",x:-68,y:-117,z:0},{elem:"H",x:-68,y:117,z:0},{elem:"H",x:68,y:117,z:0}], bonds: [[0,1,"double"],[1,2],[2,3,"double"],[3,4],[4,5,"double"],[5,0],[0,6],[3,7],[1,8],[2,9],[4,10],[5,11]] }
});

addMol("C2H2Cl4", "C", "sp3", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "", "", [], [], 
{
        "C2H2Cl4|1,1,2,2-å››æ°¯ä¹™çƒ·": { pg: "C2h", mp: "-42.3", bp: "146", atoms: [{elem:"Cl",x:-38,y:66,z:59},{elem:"Cl",x:-93,y:-33,z:-9},{elem:"Cl",x:38,y:-66,z:59},{elem:"Cl",x:93,y:33,z:-9},{elem:"C",x:-30,y:17,z:-5},{elem:"C",x:30,y:-17,z:-5},{elem:"H",x:-33,y:46,z:-45},{elem:"H",x:33,y:-46,z:-45}], bonds: [[0,4],[1,4],[2,5],[3,5],[4,5],[4,6],[5,7]] },
        "C2H2Cl4|1,1,1,2-å››æ°¯ä¹™çƒ·": { pg: "Cs", mp: "-70.2", bp: "130.2", atoms: [{elem:"Cl",x:27,y:-65,z:-65},{elem:"Cl",x:95,y:-1,z:26},{elem:"Cl",x:29,y:66,z:-63},{elem:"Cl",x:-98,y:0,z:-13},{elem:"C",x:27,y:0,z:-18},{elem:"C",x:-27,y:0,z:25},{elem:"H",x:-27,y:-40,z:54},{elem:"H",x:-26,y:40,z:54}], bonds: [[0,4],[1,4],[2,4],[3,5],[4,5],[5,6],[5,7]] }
    }
);

addMol("C4H6", "C", "sp/spÂ²/spÂ³", ["å¤šç¨®ç•°æ§‹ç‰©", "Isomers"], "Varies", "-108", "10", [], [], 
{
    "C4H6|1,3-ä¸äºŒçƒ¯": { pg: "C2h", mp: "-108.9", bp: "-4.4", atoms: [{elem:"C",x:-27,y:-18,z:0},{elem:"C",x:27,y:18,z:0},{elem:"C",x:-82,y:6,z:0},{elem:"C",x:82,y:-6,z:0},{elem:"H",x:-22,y:-67,z:0},{elem:"H",x:22,y:67,z:0},{elem:"H",x:-122,y:-23,z:0},{elem:"H",x:-90,y:54,z:0},{elem:"H",x:122,y:23,z:0},{elem:"H",x:90,y:-54,z:0}], bonds: [[0,1],[0,2,"double"],[0,4],[1,3,"double"],[1,5],[2,6],[2,7],[3,8],[3,9]] },
    "C4H6|1,2-ä¸äºŒçƒ¯": { pg: "Cs", mp: "-136.2", bp: "10.9", atoms: [{elem:"C",x:-71,y:-13,z:0},{elem:"C",x:-18,y:28,z:0},{elem:"C",x:38,y:11,z:0},{elem:"C",x:94,y:-6,z:0},{elem:"H",x:-98,y:-5,z:-40},{elem:"H",x:-57,y:-60,z:0},{elem:"H",x:-98,y:-5,z:40},{elem:"H",x:-27,y:76,z:0},{elem:"H",x:105,y:-54,z:0},{elem:"H",x:130,y:26,z:0}], bonds: [[0,1],[0,4],[0,5],[0,6],[1,2,"double"],[1,7],[2,3,"double"],[3,8],[3,9]] },
    "C4H6|2-ä¸ç‚”": { pg: "D3h", mp: "-32.3", bp: "27", atoms: [{elem:"C",x:-93,y:0,z:0},{elem:"C",x:93,y:0,z:0},{elem:"C",x:-27,y:0,z:0},{elem:"C",x:27,y:0,z:0},{elem:"H",x:-110,y:15,z:43},{elem:"H",x:-110,y:-45,z:-9},{elem:"H",x:-110,y:30,z:-35},{elem:"H",x:110,y:46,z:1},{elem:"H",x:110,y:-24,z:39},{elem:"H",x:110,y:-22,z:-40}], bonds: [[0,2],[0,4],[0,5],[0,6],[1,3],[1,7],[1,8],[1,9],[2,3,"triple"]] },
    "C4H6|1-ç”²åŸºç’°ä¸™çƒ¯": { pg: "Cs", mp: "-", bp: "12", atoms: [{elem:"C",x:53,y:-28,z:0},{elem:"C",x:0,y:8,z:0},{elem:"C",x:51,y:36,z:0},{elem:"C",x:-65,y:3,z:0},{elem:"H",x:65,y:-50,z:42},{elem:"H",x:65,y:-50,z:-42},{elem:"H",x:75,y:77,z:0},{elem:"H",x:-80,y:-22,z:40},{elem:"H",x:-86,y:47,z:0},{elem:"H",x:-80,y:-22,z:-40}], bonds: [[0,1],[0,2],[0,4],[0,5],[1,2,"double"],[1,3],[2,6],[3,7],[3,8],[3,9]] },
    "C4H6|1-ä¸ç‚”": { pg: "Cs", mp: "-125.7", bp: "8.1", atoms: [{elem:"C",x:10,y:31,z:0},{elem:"C",x:55,y:-20,z:0},{elem:"C",x:-52,y:8,z:0},{elem:"C",x:-103,y:-10,z:0},{elem:"H",x:18,y:59,z:40},{elem:"H",x:18,y:59,z:-40},{elem:"H",x:50,y:-49,z:40},{elem:"H",x:50,y:-49,z:40},{elem:"H",x:101,y:-3,z:0},{elem:"H",x:-148,y:-27,z:0}], bonds: [[0,1],[0,2],[0,4],[0,5],[1,6],[1,7],[1,8],[2,3,"triple"],[3,9]] },
    "C4H6|3-ç”²åŸºç’°ä¸™çƒ¯": { pg: "Cs", mp: "-", bp: "0", atoms: [{elem:"C",x:5,y:0,z:-24},{elem:"C",x:54,y:-29,z:4},{elem:"C",x:54,y:29,z:4},{elem:"C",x:-55,y:0,z:8},{elem:"H",x:3,y:0,z:-72},{elem:"H",x:76,y:-70,z:16},{elem:"H",x:76,y:70,z:16},{elem:"H",x:-81,y:-40,z:-5},{elem:"H",x:-81,y:40,z:-5},{elem:"H",x:-51,y:0,z:57}], bonds: [[0,1],[0,2],[0,3],[0,4],[1,2,"double"],[1,5],[2,6],[3,7],[3,8],[3,9]] },
    "C4H6|é›™ç’°ä¸çƒ·": { pg: "C2v", mp: "-", bp: "8", atoms: [{elem:"C",x:0,y:-34,z:-12},{elem:"C",x:0,y:34,z:-12},{elem:"C",x:51,y:0,z:15},{elem:"C",x:-51,y:0,z:15},{elem:"H",x:0,y:-53,z:-57},{elem:"H",x:0,y:53,z:-57},{elem:"H",x:93,y:0,z:-9},{elem:"H",x:55,y:0,z:63},{elem:"H",x:-55,y:0,z:63},{elem:"H",x:-93,y:0,z:-9}], bonds: [[0,1],[0,2],[0,3],[0,4],[1,2],[1,3],[1,5],[2,6],[2,7],[3,8],[3,9]] },
    "C4H6|ç’°ä¸çƒ¯": { pg: "C2v", mp: "-135.7", bp: "2.5", atoms: [{elem:"C",x:-26,y:-35,z:0},{elem:"C",x:-26,y:35,z:0},{elem:"C",x:42,y:-30,z:0},{elem:"C",x:42,y:30,z:0},{elem:"H",x:-46,y:-55,z:40},{elem:"H",x:-46,y:-55,z:-40},{elem:"H",x:-46,y:55,z:-40},{elem:"H",x:-46,y:55,z:40},{elem:"H",x:77,y:-64,z:0},{elem:"H",x:77,y:64,z:0}], bonds: [[0,1],[0,2],[0,4],[0,5],[1,3],[1,6],[1,7],[2,3,"double"],[2,8],[3,9]] }
});

addMol("C8H88|Conformer3D_COMPOUND_CID_69667", "C", "spÂ³", ["å¹¾ä½•å½¢ç‹€","Shape"], "è§’åº¦", "", "", [{elem:"C",x:39,y:133,z:0},{elem:"C",x:-39,y:133,z:0},{elem:"C",x:34,y:58,z:0},{elem:"C",x:-34,y:58,z:0},{elem:"C",x:71,y:0,z:0},{elem:"C",x:-71,y:0,z:0},{elem:"C",x:35,y:-60,z:0},{elem:"C",x:-35,y:-60,z:0},{elem:"H",x:62,y:156,z:-44},{elem:"H",x:61,y:156,z:44},{elem:"H",x:-62,y:156,z:44},{elem:"H",x:-62,y:156,z:-44},{elem:"H",x:125,y:1,z:0},{elem:"H",x:-125,y:1,z:0},{elem:"H",x:62,y:-107,z:0},{elem:"H",x:-62,y:-107,z:0}], [[0,1],[0,2],[0,8],[0,9],[1,3],[1,10],[1,11],[2,3],[2,4,"double"],[3,5,"double"],[4,6],[4,12],[5,7],[5,13],[6,7,"double"],[6,14],[7,15]], null, null, "C2v");



addMol("C8H8|è‹¯ä¹™çƒ¯|Styrene", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "-30.6", "145.2", [{elem:"C",x:18,y:11,z:6},{elem:"C",x:-22,y:59,z:1},{elem:"C",x:-4,y:-48,z:6},{elem:"C",x:-84,y:49,z:-3},{elem:"C",x:-66,y:-58,z:2},{elem:"C",x:-106,y:-10,z:-3},{elem:"C",x:82,y:22,z:10},{elem:"C",x:126,y:-14,z:-11},{elem:"H",x:-6,y:105,z:1},{elem:"H",x:26,y:-86,z:10},{elem:"H",x:-115,y:86,z:-7},{elem:"H",x:-83,y:-104,z:2},{elem:"H",x:-154,y:-18,z:-6},{elem:"H",x:95,y:64,z:31},{elem:"H",x:173,y:-1,z:-5},{elem:"H",x:117,y:-56,z:-34}], [[0,1,"double"],[0,2],[0,6],[1,3],[1,8],[2,4,"double"],[2,9],[3,5,"double"],[3,10],[4,5],[4,11],[5,12],[6,7,"double"],[6,13],[7,14],[7,15]], null, null, "Cs");
addMol("C3H3N|ä¸™çƒ¯è…ˆ|Acrylonitrile", "C", "spÂ²/sp", ["å¹³é¢/ç›´ç·š","Planar/Linear"], "120Â°/180Â°", "-83.5", "77.3", [{elem:"N",x:-113,y:10,z:0},{elem:"C",x:-1,y:-22,z:0},{elem:"C",x:43,y:18,z:0},{elem:"C",x:-63,y:-4,z:0},{elem:"H",x:9,y:-70,z:0},{elem:"H",x:90,y:3,z:0},{elem:"H",x:35,y:66,z:0}], [[0,3,"triple"],[1,2,"double"],[1,3],[1,4],[2,5],[2,6]], null, null, "Cs");
addMol("C2H3Cl|æ°¯ä¹™çƒ¯", "C", "sp3", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-153.8", "-13.8", [{elem:"Cl",x:-91,y:-12,z:0},{elem:"C",x:-20,y:18,z:0},{elem:"C",x:30,y:-15,z:0},{elem:"H",x:-20,y:67,z:0},{elem:"H",x:74,y:6,z:0},{elem:"H",x:28,y:-64,z:0}], [[0,1],[1,2,"double"],[1,3],[2,4],[2,5]], null, null, "Cs");
addMol("C3H8|ä¸™çƒ·", "C", "sp3", ["æ­£å››é¢é«”","Tetrahedral"], "109.5Â°", "-187.7", "-42.1", [{elem:"C",x:0,y:35,z:0},{elem:"C",x:-61,y:-17,z:0},{elem:"C",x:61,y:-17,z:0},{elem:"H",x:0,y:65,z:40},{elem:"H",x:0,y:65,z:-40},{elem:"H",x:-65,y:-55,z:40},{elem:"H",x:-65,y:-55,z:-40},{elem:"H",x:-105,y:15,z:0},{elem:"H",x:105,y:15,z:0},{elem:"H",x:65,y:-55,z:40},{elem:"H",x:65,y:-55,z:-40}], [[0,1],[0,2],[0,3],[0,4],[1,5],[1,6],[1,7],[2,8],[2,9],[2,10]], null, null, "C2v");
addMol("C6H5COOH|è‹¯ç”²é…¸|å®‰æ¯é¦™é…¸", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "122", "249", [{elem:"O",x:118,y:50,z:0},{elem:"O",x:125,y:-52,z:0},{elem:"C",x:28,y:-5,z:0},{elem:"C",x:-5,y:-59,z:0},{elem:"C",x:-2,y:50,z:0},{elem:"C",x:-67,y:-58,z:0},{elem:"C",x:-65,y:51,z:0},{elem:"C",x:-98,y:-3,z:0},{elem:"C",x:93,y:-6,z:0},{elem:"H",x:18,y:-102,z:0},{elem:"H",x:21,y:93,z:0},{elem:"H",x:-93,y:-99,z:0},{elem:"H",x:-89,y:94,z:0},{elem:"H",x:-146,y:-2,z:0},{elem:"H",x:162,y:48,z:0}], [[0,8],[0,14],[1,8,"double"],[2,3,"double"],[2,4],[2,8],[3,5],[3,9],[4,6,"double"],[4,10],[5,7,"double"],[5,11],[6,7],[6,12],[7,13]], null, null, "Cs");
addMol("C7H6O3|é„°ç¾¥åŸºè‹¯ç”²é…¸|Salicylic Acid|æ°´æ¥Šé…¸|æŸ³é…¸", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "158.6", "211", [{elem:"O",x:27,y:102,z:-7},{elem:"O",x:116,y:-59,z:-20},{elem:"O",x:126,y:34,z:23},{elem:"C",x:28,y:-5,z:3},{elem:"C",x:-3,y:49,z:-2},{elem:"C",x:-4,y:-59,z:8},{elem:"C",x:-66,y:49,z:-3},{elem:"C",x:-67,y:-59,z:7},{elem:"C",x:-98,y:-5,z:2},{elem:"C",x:93,y:-7,z:3},{elem:"H",x:19,y:-102,z:12},{elem:"H",x:-91,y:91,z:-7},{elem:"H",x:-92,y:-101,z:11},{elem:"H",x:-147,y:-4,z:2},{elem:"H",x:-2,y:135,z:-10},{elem:"H",x:160,y:-59,z:-20}], [[0,4],[0,14],[1,9],[1,15],[2,9,"double"],[3,4],[3,5,"double"],[3,9],[4,6,"double"],[5,7],[5,10],[6,8],[6,11],[7,8,"double"],[7,12],[8,13]], null, null, "Cs");
addMol("C9H8O4|é˜¿æ–¯åŒ¹éˆ|ä¹™é†¯æŸ³é…¸|ä¹™é†¯æ°´æ¥Šé…¸", "C", "spÂ²", ["å¹³é¢/è‹¯ç’°","Planar"], "109-120Â°", "136", "140", [{elem:"O",x:51,y:-18,z:35},{elem:"O",x:-36,y:129,z:-33},{elem:"O",x:31,y:105,z:39},{elem:"O",x:76,y:-29,z:-66},{elem:"C",x:-8,y:-20,z:20},{elem:"C",x:-40,y:32,z:6},{elem:"C",x:-37,y:-76,z:19},{elem:"C",x:-101,y:28,z:-9},{elem:"C",x:-98,y:-80,z:4},{elem:"C",x:-130,y:-27,z:-11},{elem:"C",x:-11,y:90,z:7},{elem:"C",x:91,y:-23,z:-14},{elem:"C",x:154,y:-20,z:8},{elem:"H",x:-13,y:-117,z:30},{elem:"H",x:-127,y:68,z:-20},{elem:"H",x:-121,y:-123,z:3},{elem:"H",x:-177,y:-30,z:-23},{elem:"H",x:163,y:-57,z:39},{elem:"H",x:185,y:-24,z:-31},{elem:"H",x:163,y:23,z:29},{elem:"H",x:-16,y:169,z:-33}], [[0,4],[0,11],[1,10],[1,20],[2,10,"double"],[3,11,"double"],[4,5],[4,6,"double"],[5,7,"double"],[5,10],[6,8],[6,13],[7,9],[7,14],[8,9,"double"],[8,15],[9,16],[11,12],[12,17],[12,18],[12,19]], null, null, "C1");
addMol("C3H4|ä¸™äºŒçƒ¯|Allene", "C", "sp (ä¸­) / spÂ² (ç«¯)", ["ç›´ç·šè»¸ (å…©ç«¯å‚ç›´)","Linear Axis (Perpendicular Ends)"], "180Â° (è»¸) / 90Â° (é¢)", "-136", "-34", [{elem:"C",x:53,y:25,z:-3},{elem:"C",x:0,y:0,z:0},{elem:"C",x:-53,y:-25,z:3},{elem:"H",x:63,y:62,z:-33},{elem:"H",x:90,y:9,z:26},{elem:"H",x:-88,y:-8,z:33},{elem:"H",x:-65,y:-63,z:-26}], [[0,1,"double"],[0,3],[0,4],[1,2,"double"],[2,5],[2,6]], null, null, "D2d");
addMol("H2C2O4|ä¹™äºŒé…¸|è‰é…¸", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "189.5", "365", [{elem:"O",x:57,y:54,z:0},{elem:"O",x:-57,y:-54,z:0},{elem:"O",x:61,y:-49,z:0},{elem:"O",x:-61,y:49,z:0},{elem:"C",x:34,y:-2,z:0},{elem:"C",x:-34,y:2,z:0},{elem:"H",x:101,y:53,z:0},{elem:"H",x:-101,y:-53,z:0}], [[0,4],[0,6],[1,5],[1,7],[2,4,"double"],[3,5,"double"],[4,5]], null, null, "C2h");
addMol("C2H4(OH)2|ä¹™äºŒé†‡|1,2-ä¹™äºŒé†‡", "C", "spÂ³", ["æ‰­è½‰å‹/å››é¢é«”","Gauche/Tetrahedral"], "109.5Â°", "-12.9", "197.3", [{elem:"O",x:-60,y:36,z:-1},{elem:"O",x:65,y:36,z:12},{elem:"C",x:-29,y:-16,z:19},{elem:"C",x:34,y:-16,z:-8},{elem:"H",x:-54,y:-56,z:5},{elem:"H",x:-27,y:-15,z:68},{elem:"H",x:59,y:-56,z:7},{elem:"H",x:33,y:-15,z:-57},{elem:"H",x:-63,y:34,z:-45},{elem:"H",x:42,y:71,z:-1}], [[0,2],[0,8],[1,3],[1,9],[2,3],[2,4],[2,5],[3,6],[3,7]], null, null, "C2");
addMol("C3H5(OH)3|ä¸™ä¸‰é†‡|ç”˜æ²¹", "C", "spÂ³", ["éˆç‹€/å››é¢é«”","Chain/Tetrahedral"], "109.5Â°", "17.8", "290", [{elem:"O",x:4,y:70,z:3},{elem:"O",x:111,y:10,z:-19},{elem:"O",x:-106,y:10,z:-19},{elem:"C",x:3,y:10,z:-20},{elem:"C",x:59,y:-22,z:3},{elem:"C",x:-54,y:-21,z:3},{elem:"H",x:3,y:14,z:-69},{elem:"H",x:62,y:-23,z:52},{elem:"H",x:61,y:-68,z:-14},{elem:"H",x:-56,y:-68,z:-13},{elem:"H",x:-56,y:-20,z:52},{elem:"H",x:4,y:68,z:47},{elem:"H",x:108,y:51,z:-4},{elem:"H",x:-141,y:-11,z:-3}], [[0,3],[0,11],[1,4],[1,12],[2,5],[2,13],[3,4],[3,5],[3,6],[4,7],[4,8],[5,9],[5,10]], null, null, "C1");
addMol("C8H9NO2|ä¹™é†¯èƒºåŸºè‹¯é…š|æ™®æ‹¿ç–¼", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Planar/Tetra"], "120Â°", "169", ">250", [{elem:"O",x:187,y:-27,z:0},{elem:"O",x:-103,y:-70,z:0},{elem:"N",x:-57,y:26,z:0},{elem:"C",x:4,y:12,z:0},{elem:"C",x:24,y:-47,z:0},{elem:"C",x:46,y:59,z:0},{elem:"C",x:85,y:-60,z:0},{elem:"C",x:108,y:46,z:0},{elem:"C",x:127,y:-14,z:0},{elem:"C",x:-106,y:-15,z:0},{elem:"C",x:-165,y:18,z:0},{elem:"H",x:-6,y:-86,z:0},{elem:"H",x:32,y:106,z:0},{elem:"H",x:-67,y:70,z:0},{elem:"H",x:99,y:-107,z:0},{elem:"H",x:140,y:82,z:0},{elem:"H",x:-169,y:45,z:-41},{elem:"H",x:-202,y:-15,z:1},{elem:"H",x:-168,y:47,z:40},{elem:"H",x:192,y:-70,z:0}], [[0,8],[0,19],[1,9,"double"],[2,3],[2,9],[2,13],[3,4,"double"],[3,5],[4,6],[4,11],[5,7,"double"],[5,12],[6,8,"double"],[6,14],[7,8],[7,15],[9,10],[10,16],[10,17],[10,18]], null, null, "Cs");
addMol("C7H8|ç”²è‹¯|Toluene", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Mixed"], "120Â°", "-95", "110.6", [{elem:"C",x:-62.5,y:0,z:0},{elem:"C",x:-31.5,y:-54,z:0},{elem:"C",x:-31.5,y:54,z:0},{elem:"C",x:-129.5,y:0,z:0},{elem:"C",x:31.5,y:-54,z:0},{elem:"C",x:31.5,y:54,z:0},{elem:"C",x:62.5,y:0,z:0},{elem:"H",x:-55.5,y:-97,z:0},{elem:"H",x:-55.5,y:97,z:0},{elem:"H",x:-147.5,y:40,z:23},{elem:"H",x:-147.5,y:-40,z:23},{elem:"H",x:-146.5,y:0,z:-46},{elem:"H",x:55.5,y:-97,z:0},{elem:"H",x:55.5,y:97,z:0},{elem:"H",x:111.5,y:0,z:0}], [[0,1,"double"],[0,2],[0,3],[1,4],[1,7],[2,5,"double"],[2,8],[3,9],[3,10],[3,11],[4,6,"double"],[4,12],[5,6],[5,13],[6,14]], null, null, "Cs");addMol("C10H8|è˜|Naphthalene", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "80.2", "218", [{elem:"C",x:0,y:-32,z:0},{elem:"C",x:0,y:32,z:0},{elem:"C",x:55,y:-63,z:0},{elem:"C",x:55,y:63,z:0},{elem:"C",x:-55,y:-63,z:0},{elem:"C",x:-55,y:63,z:0},{elem:"C",x:109,y:-31,z:0},{elem:"C",x:109,y:31,z:0},{elem:"C",x:-109,y:-31,z:0},{elem:"C",x:-109,y:31,z:0},{elem:"H",x:56,y:-112,z:0},{elem:"H",x:56,y:112,z:0},{elem:"H",x:-56,y:-112,z:0},{elem:"H",x:-56,y:112,z:0},{elem:"H",x:152,y:-56,z:0},{elem:"H",x:152,y:56,z:0},{elem:"H",x:-152,y:-56,z:0},{elem:"H",x:-152,y:56,z:0}], [[0,1],[0,2,"double"],[0,4],[1,3,"double"],[1,5],[2,6],[2,10],[3,7],[3,11],[4,8,"double"],[4,12],[5,9,"double"],[5,13],[6,7,"double"],[6,14],[7,15],[8,9],[8,16],[9,17]], null, null, "D2h");
addMol("C6H6|è‹¯|Benzene", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "5.5", "80.1", [{elem:"C",x:63,y:0,z:0},{elem:"C",x:31.5,y:54.6,z:0},{elem:"C",x:-31.5,y:54.6,z:0},{elem:"C",x:-63,y:0,z:0},{elem:"C",x:-31.5,y:-54.6,z:0},{elem:"C",x:31.5,y:-54.6,z:0},{elem:"H",x:112,y:0,z:0},{elem:"H",x:56,y:97,z:0},{elem:"H",x:-56,y:97,z:0},{elem:"H",x:-112,y:0,z:0},{elem:"H",x:-56,y:-97,z:0},{elem:"H",x:56,y:-97,z:0}], [[0,1,"double"],[1,2],[2,3,"double"],[3,4],[4,5,"double"],[5,0],[0,6],[1,7],[2,8],[3,9],[4,10],[5,11]], null, null, "D6h");
addMol("CH3COOCH3|ä¹™é…¸ç”²é…¯|Methyl Acetate", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Mixed"], "120Â°", "-98", "56.9", [{elem:"C",x:-35,y:0,z:0},{elem:"C",x:10,y:0,z:0},{elem:"O",x:10,y:50,z:0},{elem:"O",x:50,y:-30,z:0},{elem:"C",x:90,y:-30,z:0},{elem:"H",x:-35,y:-45,z:0},{elem:"H",x:-65,y:25,z:25},{elem:"H",x:-65,y:25,z:-25},{elem:"H",x:90,y:-70,z:0},{elem:"H",x:120,y:-5,z:25},{elem:"H",x:120,y:-5,z:-25}], [[0,1],[1,2,"double"],[1,3],[3,4],[0,5],[0,6],[0,7],[4,8],[4,9],[4,10]], null, null, "Cs");
addMol("CH3COOC2H5|ä¹™é…¸ä¹™é…¯|Ethyl Acetate", "C", "spÂ²", ["å¹³é¢/å››é¢é«”","Mixed"], "120Â°", "-83.6", "77.1", [{elem:"C",x:-35,y:0,z:0},{elem:"C",x:10,y:0,z:0},{elem:"O",x:10,y:50,z:0},{elem:"O",x:50,y:-30,z:0},{elem:"C",x:90,y:-30,z:0},{elem:"C",x:125,y:15,z:0},{elem:"H",x:-35,y:-45,z:0},{elem:"H",x:-65,y:25,z:25},{elem:"H",x:-65,y:25,z:-25},{elem:"H",x:90,y:-70,z:0},{elem:"H",x:115,y:-50,z:30},{elem:"H",x:125,y:55,z:0},{elem:"H",x:155,y:-5,z:25},{elem:"H",x:155,y:-5,z:-25}], [[0,1],[1,2,"double"],[1,3],[3,4],[4,5],[0,6],[0,7],[0,8],[4,9],[4,10],[5,11],[5,12],[5,13]], null, null, "Cs");
addMol("CH3NHCH3|äºŒç”²èƒº|Dimethylamine", "N", "spÂ³", ["è§’éŒ","Pyramidal"], "107Â°", "-92.2", "6.9", [{elem:"N",x:0,y:0,z:0},{elem:"H",x:0,y:30,z:0},{elem:"C",x:40,y:-25,z:25},{elem:"C",x:-40,y:-25,z:25},{elem:"H",x:40,y:-25,z:65},{elem:"H",x:70,y:-50,z:5},{elem:"H",x:60,y:10,z:15},{elem:"H",x:-40,y:-25,z:65},{elem:"H",x:-70,y:-50,z:5},{elem:"H",x:-60,y:10,z:15}], [[0,1],[0,2],[0,3],[2,4],[2,5],[2,6],[3,7],[3,8],[3,9]], null, null, "Cs");
addMol("N(CH3)3|ä¸‰ç”²èƒº|Trimethylamine", "N", "spÂ³", ["è§’éŒ","Pyramidal"], "108Â°", "-117.2", "2.9", [{elem:"N",x:0,y:15,z:0},{elem:"C",x:0,y:-25,z:35},{elem:"C",x:35,y:-25,z:-25},{elem:"C",x:-35,y:-25,z:-25},{elem:"H",x:0,y:-25,z:75},{elem:"H",x:30,y:-55,z:35},{elem:"H",x:-30,y:-55,z:35},{elem:"H",x:35,y:-25,z:-65},{elem:"H",x:65,y:-55,z:-25},{elem:"H",x:65,y:5,z:-25},{elem:"H",x:-35,y:-25,z:-65},{elem:"H",x:-65,y:-55,z:-25},{elem:"H",x:-65,y:5,z:-25}], [[0,1],[0,2],[0,3],[1,4],[1,5],[1,6],[2,7],[2,8],[2,9],[3,10],[3,11],[3,12]], null, null, "C3v");
addMol("HCONH2|ç”²é†¯èƒº|Formamide", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "2.6", "210", [{elem:"C",x:0,y:0,z:0},{elem:"O",x:0,y:50,z:0},{elem:"N",x:45,y:-30,z:0},{elem:"H",x:-40,y:-25,z:0},{elem:"H",x:45,y:-65,z:0},{elem:"H",x:80,y:-10,z:0}], [[0,1,"double"],[0,2],[0,3],[2,4],[2,5]], null, null, "Cs");
addMol("CH3CONH2|ä¹™é†¯èƒº|Acetamide", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "82.3", "221.2", [{elem:"C",x:-40,y:0,z:0},{elem:"C",x:5,y:0,z:0},{elem:"O",x:5,y:50,z:0},{elem:"N",x:50,y:-30,z:0},{elem:"H",x:-40,y:-45,z:0},{elem:"H",x:-70,y:25,z:25},{elem:"H",x:-70,y:25,z:-25},{elem:"H",x:50,y:-65,z:0},{elem:"H",x:85,y:-10,z:0}], [[0,1],[1,2,"double"],[1,3],[0,4],[0,5],[0,6],[3,7],[3,8]], null, null, "Cs");
addMol("P4|ç™½ç£·|é»ƒç£·|White Phosphorus", "P", "spÂ³", ["æ­£å››é¢é«” (ç± ç‹€)","Tetrahedral Cage"], "60Â°", "44.1", "280.5", [{elem:"P",x:50,y:50,z:50}, {elem:"P",x:50,y:-50,z:-50}, {elem:"P",x:-50,y:50,z:-50}, {elem:"P",x:-50,y:-50,z:50}], [[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]], null, null, "Td");
addMol("P4O6|å…­æ°§åŒ–å››ç£·|Phosphorus Hexoxide", "P", "spÂ³", ["ç± ç‹€ (é¡é‡‘å‰›çƒ·)","Cage"], "100Â°", "23.8", "173.1", [{elem:"P",x:55,y:55,z:55}, {elem:"P",x:55,y:-55,z:-55}, {elem:"P",x:-55,y:55,z:-55}, {elem:"P",x:-55,y:-55,z:55}, {elem:"O",x:85,y:0,z:0}, {elem:"O",x:-85,y:0,z:0}, {elem:"O",x:0,y:85,z:0}, {elem:"O",x:0,y:-85,z:0}, {elem:"O",x:0,y:0,z:85}, {elem:"O",x:0,y:0,z:-85}], [[0,4],[0,6],[0,8], [1,4],[1,7],[1,9], [2,5],[2,6],[2,9], [3,5],[3,7],[3,8]], null, null, "Td");
addMol("P4O10|åæ°§åŒ–å››ç£·|Phosphorus Pentoxide", "P", "spÂ³", ["ç± ç‹€","Cage"], "102Â°/123Â°", "340 (æ˜‡è¯)", "-", [{elem:"P",x:55,y:55,z:55}, {elem:"P",x:55,y:-55,z:-55}, {elem:"P",x:-55,y:55,z:-55}, {elem:"P",x:-55,y:-55,z:55}, {elem:"O",x:85,y:0,z:0}, {elem:"O",x:-85,y:0,z:0}, {elem:"O",x:0,y:85,z:0}, {elem:"O",x:0,y:-85,z:0}, {elem:"O",x:0,y:0,z:85}, {elem:"O",x:0,y:0,z:-85}, {elem:"O",x:95,y:95,z:95}, {elem:"O",x:95,y:-95,z:-95}, {elem:"O",x:-95,y:95,z:-95}, {elem:"O",x:-95,y:-95,z:95}], [[0,4],[0,6],[0,8], [1,4],[1,7],[1,9], [2,5],[2,6],[2,9], [3,5],[3,7],[3,8], [0,10,"double"], [1,11,"double"], [2,12,"double"], [3,13,"double"]], null, null, "Td");
addMol("S8|æ–œæ–¹ç¡«|å–®æ–œç¡«|ç¡«ç£º", "S", "sp3", ["çš‡å† å‹ (ç’°ç‹€)","Crown Ring"], "108Â°", "115.2", "444.6", [{elem:"S",x:0,y:-105,z:-25},{elem:"S",x:-75,y:-75,z:25},{elem:"S",x:75,y:-75,z:25},{elem:"S",x:-105,y:0,z:-25},{elem:"S",x:105,y:0,z:-25},{elem:"S",x:-75,y:75,z:25},{elem:"S",x:75,y:75,z:25},{elem:"S",x:0,y:105,z:-25}], [[0,1],[0,2],[1,3],[2,4],[3,5],[4,6],[5,7],[6,7]], null, null, "D4d");
addMol("H2O2|éæ°§åŒ–æ°«|é›™æ°§æ°´", "O", "spÂ³", ["æ›¸æœ¬å‹","Open Book"], "111Â°", "-0.4", "150.2", [{elem:"O",x:-17,y:5,z:-17},{elem:"O",x:17,y:-5,z:17},{elem:"H",x:-55,y:35,z:-22},{elem:"H",x:55,y:-35,z:22}], [[0,1],[0,2],[1,3]], null, null, "C2");
addMol("H2S2|äºŒç¡«åŒ–æ°«", "S", "spÂ³", ["æ›¸æœ¬å‹","Open Book"], "92Â°", "-89.6", "70.7", [{elem:"S",x:-20,y:5,z:-20},{elem:"S",x:20,y:-5,z:20},{elem:"H",x:-55,y:35,z:-25},{elem:"H",x:55,y:-35,z:25}], [[0,1],[0,2],[1,3]], null, null, "C2");
addMol("S2Cl2|äºŒæ°¯åŒ–äºŒç¡«|äºŒæ°¯åŒ–ç¡«", "S", "spÂ³", ["æ›¸æœ¬å‹","Open Book"], "103Â°", "-77", "138", [{elem:"S",x:0,y:25,z:0},{elem:"S",x:0,y:-25,z:0},{elem:"Cl",x:65,y:60,z:50},{elem:"Cl",x:-65,y:-60,z:50}], [[0,1],[0,2],[1,3]], null, null, "C2");
addMol("N2O3|ä¸‰æ°§åŒ–äºŒæ°®", "N", "spÂ²+spÂ²", ["å¹³é¢","Planar"], "120Â°", "-100.7", "3.5", [{elem:"N",x:-32,y:0,z:0},{elem:"N",x:32,y:0,z:0},{elem:"O",x:-67,y:50,z:0},{elem:"O",x:67,y:50,z:0},{elem:"O",x:67,y:-50,z:0}], [[0,1],[0,2,"double"],[1,3,"double"],[1,4]], null, null, "Cs");
addMol("N2O4|å››æ°§åŒ–äºŒæ°®", "N", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "-11.2", "21.2", [{elem:"N",x:-35,y:0,z:0,lpCount:0},{elem:"N",x:35,y:0,z:0,lpCount:0},{elem:"O",x:-75,y:55,z:0},{elem:"O",x:-75,y:-55,z:0},{elem:"O",x:75,y:55,z:0},{elem:"O",x:75,y:-55,z:0}], [[0,1],[0,2,"double"],[0,3],[1,4,"double"],[1,5]], null, null, "D2h");
addMol("N2O5|äº”æ°§åŒ–äºŒæ°®", "N", "spÂ²", ["éå¹³é¢","V-shape"], "120Â°", "30 (æ˜‡è¯)", "47 (åˆ†è§£)", [{elem:"O",x:0,y:30,z:0},{elem:"N",x:-50,y:-15,z:0},{elem:"N",x:50,y:-15,z:0},{elem:"O",x:-85,y:30,z:0},{elem:"O",x:-85,y:-60,z:0},{elem:"O",x:85,y:30,z:0},{elem:"O",x:85,y:-60,z:0}], [[0,1],[0,2],[1,3,"double"],[1,4],[2,5,"double"],[2,6]], null, null, "C2");
addMol("C2H5Cl|æ°¯ä¹™çƒ·", "C", "sp3", ["å››é¢é«”","Tetrahedral"], "109.5", "-138.7", "12.3", [{elem:"Cl",x:100,y:-16,z:0},{elem:"C",x:25,y:28,z:0},{elem:"C",x:-35,y:-20,z:0},{elem:"H",x:25,y:56,z:-40},{elem:"H",x:25,y:56,z:40},{elem:"H",x:-78,y:5,z:0},{elem:"H",x:-35,y:-55,z:40},{elem:"H",x:-35,y:-55,z:-40}], [[0,1],[1,2],[1,3],[1,4],[2,5],[2,6],[2,7]], null, null, "Cs");
addMol("CHOCHO|ä¹™äºŒé†›|Glyoxal", "C", "spÂ²", ["å¹³é¢","Planar"], "120Â°", "15", "50.4", [{elem:"C",x:-28,y:0,z:0},{elem:"C",x:28,y:0,z:0},{elem:"O",x:-55,y:45,z:0},{elem:"O",x:55,y:-45,z:0},{elem:"H",x:-45,y:-40,z:0},{elem:"H",x:45,y:40,z:0}], [[0,1],[0,2,"double"],[1,3,"double"],[0,4],[1,5]], null, null, "C2h");
addMol("CH3OH|ç”²é†‡|æœ¨ç²¾", "C", "spÂ³", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-97.6", "64.7", [{elem:"C",x:0,y:0,z:0}, {elem:"O",x:0,y:70,z:0,lpCount:2}, {elem:"H",x:0,y:-50,z:0}, {elem:"H",x:45,y:15,z:30}, {elem:"H",x:-45,y:15,z:30}, {elem:"H",x:50,y:85,z:0}], [[0,1],[0,2],[0,3],[0,4],[1,5]], null, null, "Cs");
addMol("C2H5OH|ä¹™é†‡|Ethanol|é…’ç²¾", "C", "sp3", ["å››é¢é«”","Tetrahedral"], "109.5Â°", "-114.1", "78.2", [{elem:"O",x:-69,y:-14,z:-4},{elem:"C",x:-19,y:25,z:-4},{elem:"C",x:38,y:-13,z:-4},{elem:"H",x:-21,y:54,z:36},{elem:"H",x:-21,y:53,z:-44},{elem:"H",x:78,y:16,z:-5},{elem:"H",x:39,y:-42,z:-43},{elem:"H",x:40,y:-41,z:36},{elem:"H",x:-67,y:-38,z:32}], [[0,1],[0,8],[1,2],[1,3],[1,4],[2,5],[2,6],[2,7]], null, null, "Cs");
addMol("C10H15N|ç”²åŸºè‹¯ä¸™èƒº|Methamphetamine", "C,N", "spÂ²/spÂ³", ["è‹¯ç’°å¹³é¢","å´éˆå››é¢é«”"], "120Â°/109.5Â°", "3", "212", [{elem:"N",x:-126,y:-6,z:0,lpCount:1},{elem:"C",x:-63,y:-12,z:-18},{elem:"C",x:-22,y:11,z:33},{elem:"C",x:44,y:8,z:18},{elem:"C",x:-51,y:-79,z:-32},{elem:"C",x:71,y:57,z:-10},{elem:"C",x:76,y:-43,z:33},{elem:"C",x:-140,y:56,z:15},{elem:"C",x:132,y:54,z:-23},{elem:"C",x:137,y:-45,z:19},{elem:"C",x:165,y:3,z:-9},{elem:"H",x:-55,y:14,z:-59},{elem:"H",x:-32,y:58,z:44},{elem:"H",x:-31,y:-14,z:75},{elem:"H",x:-7,y:-85,z:-53},{elem:"H",x:-55,y:-107,z:8},{elem:"H",x:-84,y:-95,z:-65},{elem:"H",x:-153,y:-19,z:-35},{elem:"H",x:46,y:97,z:-21},{elem:"H",x:55,y:-81,z:55},{elem:"H",x:-189,y:62,z:16},{elem:"H",x:-125,y:68,z:60},{elem:"H",x:-123,y:88,z:-18},{elem:"H",x:154,y:92,z:-45},{elem:"H",x:163,y:-85,z:30},{elem:"H",x:213,y:1,z:-20}], [[0,1],[0,7],[0,17],[1,2],[1,4],[1,11],[2,3],[2,12],[2,13],[3,5,"double"],[3,6],[4,14],[4,15],[4,16],[5,8],[5,18],[6,9,"double"],[6,19],[7,20],[7,21],[7,22],[8,10,"double"],[8,23],[9,10],[9,24],[10,25]], null, null, "C1");


addMol("aaa", "C", "sp3", ["å½¢ç‹€","Shape"], "è§’åº¦", "", "", [{elem:"C",x:20,y:12,z:6},{elem:"C",x:-24,y:66,z:1},{elem:"C",x:-4,y:-53,z:7},{elem:"C",x:-93,y:54,z:-3},{elem:"C",x:-73,y:-65,z:2},{elem:"C",x:-117,y:-11,z:-3},{elem:"C",x:91,y:24,z:11},{elem:"C",x:140,y:-16,z:-12},{elem:"H",x:-6,y:117,z:1},{elem:"H",x:29,y:-96,z:11},{elem:"H",x:-127,y:96,z:-7},{elem:"H",x:-92,y:-116,z:2},{elem:"H",x:-171,y:-20,z:-7},{elem:"H",x:106,y:71,z:35},{elem:"H",x:192,y:-1,z:-6},{elem:"H",x:130,y:-62,z:-38}], [[0,1,'double'],[0,2],[0,6],[1,3],[1,8],[2,4,'double'],[2,9],[3,5,'double'],[3,10],[4,5],[4,11],[5,12],[6,7,'double'],[6,13],[7,14],[7,15]]);
addMol("bbb", "C", "sp3", ["å½¢ç‹€","Shape"], "è§’åº¦", "", "", [{elem:"C",x:91,y:39,z:0},{elem:"C",x:91,y:-39,z:0},{elem:"C",x:16,y:34,z:0},{elem:"C",x:16,y:-34,z:0},{elem:"C",x:-42,y:71,z:0},{elem:"C",x:-42,y:-71,z:0},{elem:"C",x:-102,y:35,z:0},{elem:"C",x:-102,y:-35,z:0},{elem:"H",x:114,y:62,z:44},{elem:"H",x:114,y:61,z:-44},{elem:"H",x:114,y:-62,z:-44},{elem:"H",x:114,y:-62,z:44},{elem:"H",x:-42,y:125,z:0},{elem:"H",x:-42,y:-125,z:0},{elem:"H",x:-149,y:62,z:0},{elem:"H",x:-149,y:-62,z:0}], [[0,1],[0,2],[0,8],[0,9],[1,3],[1,10],[1,11],[2,3],[2,4,'double'],[3,5,'double'],[4,6],[4,12],[5,7],[5,13],[6,7,'double'],[6,14],[7,15]]);







// --- 13.ç°¡å–®é›¢å­åŒ–åˆç‰©
addMol("KCl|æ°¯åŒ–é‰€", "K", "-", "-", "-", "770", "1420", [{elem:"K",x:-50,y:0,z:0,r:22,lpCount:0}, {elem:"Cl",x:50,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–é‰€ (KCl)</strong><br>ç™½è‰²çµæ™¶å›ºé«”ï¼Œå¤–è§€èˆ‡é£Ÿé¹½ç›¸ä¼¼ã€‚å®ƒæ˜¯é‰€è‚¥çš„ä¸»è¦æˆåˆ†ï¼Œå°æ¤ç‰©ç”Ÿé•·è‡³é—œé‡è¦ã€‚</div></div>');
addMol("KI|ç¢˜åŒ–é‰€", "K", "-", "-", "-", "681", "1330", [{elem:"K",x:-55,y:0,z:0,r:22,lpCount:0}, {elem:"I",x:55,y:0,z:0,r:40,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¢˜åŒ–é‰€ (KI)</strong><br>ç™½è‰²æ™¶é«”ï¼Œæ˜“æº¶æ–¼æ°´ã€‚å¸¸æ·»åŠ æ–¼é£Ÿé¹½ä¸­ä½œç‚ºç¢˜çš„ä¾†æºã€‚</div></div>');
addMol("KBr|æº´åŒ–é‰€", "K", "-", "-", "-", "734", "1435", [{elem:"K",x:-50,y:0,z:0,r:22,lpCount:0}, {elem:"Br",x:50,y:0,z:0,r:38,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æº´åŒ–é‰€ (KBr)</strong><br>ç™½è‰²çµæ™¶ï¼Œå°ç´…å¤–å…‰é€æ˜ï¼Œå¸¸ç”¨ä¾†è£½ä½œå…‰è­œåˆ†æçš„æ¨£å“é¹½ç‰‡ã€‚</div></div>');
addMol("NaF|æ°ŸåŒ–éˆ‰", "Na", "-", "-", "-", "993", "1704", [{elem:"Na",x:-40,y:0,z:0,r:20,lpCount:0}, {elem:"F",x:40,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°ŸåŒ–éˆ‰ (NaF)</strong><br>ç‰™è†ä¸­å¸¸è¦‹çš„æ·»åŠ åŠ‘ï¼Œèƒ½æä¾›æ°Ÿé›¢å­ä»¥å¼·åŒ–ç‰™é½’çºç‘¯è³ªã€‚</div></div>');
addMol("LiF|æ°ŸåŒ–é‹°", "Li", "-", "-", "-", "845", "1676", [{elem:"Li",x:-40,y:0,z:0,r:15,lpCount:0}, {elem:"F",x:40,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°ŸåŒ–é‹° (LiF)</strong><br>åœ¨ç´«å¤–ç·šå€åŸŸå…·æœ‰æ¥µä½³çš„ç©¿é€æ€§ï¼Œå¸¸ç”¨æ–¼å…‰å­¸é€é¡ææ–™ã€‚</div></div>');
addMol("MgO|æ°§åŒ–é‚|è‹¦åœŸ", "Mg", "-", "-", "-", "2852", "3600", [{elem:"Mg",x:-40,y:0,z:0,r:18,lpCount:0}, {elem:"O",x:40,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§± ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–é‚ (MgO)</strong><br>ç†”é»æ¥µé«˜ï¼Œæ˜¯å„ªè‰¯çš„è€ç«ææ–™ã€‚</div></div>');
addMol("CaO|æ°§åŒ–éˆ£|ç”ŸçŸ³ç°", "Ca", "-", "-", "-", "2572", "2850", [{elem:"Ca",x:-45,y:0,z:0,r:22,lpCount:0}, {elem:"O",x:45,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§± ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–éˆ£ (CaO)</strong><br>ä¿—ç¨±ç”ŸçŸ³ç°ï¼Œé‡æ°´æ”¾ç†±ç”Ÿæˆç†ŸçŸ³ç°ï¼Œæ˜¯å¸¸ç”¨çš„ä¹¾ç‡¥åŠ‘ã€‚</div></div>');
addMol("BaO|æ°§åŒ–é‹‡", "Ba", "-", "-", "-", "1923", "2000", [{elem:"Ba",x:-50,y:0,z:0,r:28,lpCount:0}, {elem:"O",x:50,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§± ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–é‹‡ (BaO)</strong><br>ç”¨æ–¼ç»ç’ƒå·¥æ¥­å¢åŠ æŠ˜å°„ç‡ã€‚</div></div>');
addMol("ZnO|æ°§åŒ–é‹…|é‹…ç™½", "Zn", "-", "-", "-", "1975", "-", [{elem:"Zn",x:-40,y:0,z:0,r:18,lpCount:0}, {elem:"O",x:40,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ¨ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–é‹… (ZnO)</strong><br>ä¿—ç¨±é‹…ç™½ï¼Œå…·æœ‰ç´«å¤–ç·šé®è”½èƒ½åŠ›ï¼Œç”¨æ–¼é˜²æ›¬ä¹³èˆ‡æ©¡è† å·¥æ¥­ã€‚</div></div>');
addMol("CuO|æ°§åŒ–éŠ…", "Cu", "-", "-", "-", "1326", "-", [{elem:"Cu",x:-40,y:0,z:0,r:18,lpCount:0}, {elem:"O",x:40,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">âš« ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–éŠ… (CuO)</strong><br>é»‘è‰²å›ºé«”ï¼Œç”¨æ–¼è£½é€ é¡æ–™èˆ‡æœ‰æ©Ÿåˆ†æã€‚</div></div>');
addMol("AgCl|æ°¯åŒ–éŠ€", "Ag", "-", "-", "-", "455", "1550", [{elem:"Ag",x:-45,y:0,z:0,r:22,lpCount:0}, {elem:"Cl",x:45,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ“· ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–éŠ€ (AgCl)</strong><br>ç™½è‰²æ²ˆæ¾±ï¼Œè¦‹å…‰åˆ†è§£ç”¢ç”Ÿé»‘è‰²çš„éŠ€ï¼Œæ›¾ç”¨æ–¼æ”å½±åº•ç‰‡ã€‚</div></div>');
addMol("AgBr|æº´åŒ–éŠ€", "Ag", "-", "-", "-", "432", "1502", [{elem:"Ag",x:-48,y:0,z:0,r:22,lpCount:0}, {elem:"Br",x:48,y:0,z:0,r:38,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ“· ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æº´åŒ–éŠ€ (AgBr)</strong><br>æ·ºé»ƒè‰²å›ºé«”ï¼Œæ„Ÿå…‰æ€§å¼·ï¼Œå‚³çµ±æ”å½±åº•ç‰‡çš„ä¸»è¦æˆåˆ†ã€‚</div></div>');
addMol("AgI|ç¢˜åŒ–éŠ€", "Ag", "-", "-", "-", "558", "1506", [{elem:"Ag",x:-50,y:0,z:0,r:22,lpCount:0}, {elem:"I",x:50,y:0,z:0,r:40,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸŒ§ï¸ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¢˜åŒ–éŠ€ (AgI)</strong><br>é»ƒè‰²å›ºé«”ï¼Œæ™¶é«”çµæ§‹ä¼¼å†°ï¼Œç”¨æ–¼äººé€ é™é›¨çš„æ™¶ç¨®ã€‚</div></div>');
addMol("NaH|æ°«åŒ–éˆ‰", "Na", "-", "-", "-", "800", "åˆ†è§£", [{elem:"Na",x:-40,y:0,z:0,r:20,lpCount:0}, {elem:"H",x:40,y:0,z:0,r:15,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°«åŒ–éˆ‰ (NaH)</strong><br>å«æ°«è² é›¢å­ (Hâ») çš„å¼·é‚„åŸåŠ‘ã€‚</div></div>');
addMol("HgS|ç¡«åŒ–æ±|ç¡ƒç ‚", "Hg", "-", "-", "-", "583", "æ˜‡è¯", [{elem:"Hg",x:-45,y:0,z:0,r:25,lpCount:0}, {elem:"S",x:45,y:0,z:0,r:30,lpCount:0}], [[0, 1, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ¨ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¡«åŒ–æ± (HgS)</strong><br>å¤©ç„¶ç¡ƒç ‚ï¼Œé®®ç´…è‰²ï¼Œå¤ä»£é¡æ–™èˆ‡ç…‰ä¸¹åŸæ–™ã€‚</div></div>');
addMol("MgCl2|æ°¯åŒ–é‚", "Mg", "-", "-", "-", "714", "1412", [{elem:"Mg",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"Cl",x:-85,y:0,z:0,r:35,lpCount:0}, {elem:"Cl",x:85,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–é‚ (MgClâ‚‚)</strong><br>è‹¦æ»·çš„ä¸»è¦æˆåˆ†ï¼Œè±†è…å‡å›ºåŠ‘ã€‚</div></div>');
addMol("CaCl2|æ°¯åŒ–éˆ£", "Ca", "-", "-", "-", "772", "1935", [{elem:"Ca",x:0,y:0,z:0,r:22,lpCount:0}, {elem:"Cl",x:-90,y:0,z:0,r:35,lpCount:0}, {elem:"Cl",x:90,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–éˆ£ (CaClâ‚‚)</strong><br>å¼·å¸æ¿•æ€§ï¼Œå¸¸ç”¨ä¹¾ç‡¥åŠ‘èˆ‡èé›ªåŠ‘ã€‚</div></div>');
addMol("CaF2|æ°ŸåŒ–éˆ£|è¢çŸ³", "Ca", "-", "-", "-", "1418", "2533", [{elem:"Ca",x:0,y:0,z:0,r:22,lpCount:0}, {elem:"F",x:-80,y:0,z:0,r:25,lpCount:0}, {elem:"F",x:80,y:0,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ’ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°ŸåŒ–éˆ£ (CaFâ‚‚)</strong><br>è¢çŸ³ï¼Œè£½å‚™ HF çš„åŸæ–™ï¼Œä¹Ÿç”¨æ–¼å…‰å­¸é¡é ­ã€‚</div></div>');
addMol("BaCl2|æ°¯åŒ–é‹‡", "Ba", "-", "-", "-", "962", "1560", [{elem:"Ba",x:0,y:0,z:0,r:28,lpCount:0}, {elem:"Cl",x:-95,y:0,z:0,r:35,lpCount:0}, {elem:"Cl",x:95,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–é‹‡ (BaClâ‚‚)</strong><br>æª¢é©—ç¡«é…¸æ ¹çš„è©¦åŠ‘ï¼ŒåŠ‡æ¯’ï¼Œç‡ƒç‡’å‘ˆé»ƒç¶ è‰²ç«ç„°ã€‚</div></div>');
addMol("CuCl2|æ°¯åŒ–éŠ…", "Cu", "-", "-", "-", "620", "993", [{elem:"Cu",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"Cl",x:-80,y:0,z:0,r:35,lpCount:0}, {elem:"Cl",x:80,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–éŠ… (CuClâ‚‚)</strong><br>ç‡ƒç‡’å‘ˆè—ç¶ è‰²ç«ç„°ã€‚</div></div>');
addMol("PbI2|ç¢˜åŒ–é‰›", "Pb", "-", "-", "-", "402", "953", [{elem:"Pb",x:0,y:0,z:0,r:25,lpCount:0}, {elem:"I",x:-90,y:0,z:0,r:40,lpCount:0}, {elem:"I",x:90,y:0,z:0,r:40,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">âœ¨ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¢˜åŒ–é‰› (PbIâ‚‚)</strong><br>äº®é»ƒè‰²æ™¶é«”ï¼Œç”¨æ–¼ã€Œé»ƒé‡‘é›¨ã€å¯¦é©—ã€‚</div></div>');
addMol("CaH2|æ°«åŒ–éˆ£", "Ca", "-", "-", "-", "816", "åˆ†è§£", [{elem:"Ca",x:0,y:0,z:0,r:22,lpCount:0}, {elem:"H",x:-70,y:0,z:0,r:15,lpCount:0}, {elem:"H",x:70,y:0,z:0,r:15,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">â›º ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°«åŒ–éˆ£ (CaHâ‚‚)</strong><br>æ”œå¸¶æ–¹ä¾¿çš„æ°«æ°£ç™¼ç”ŸåŠ‘ã€‚</div></div>');
addMol("Na2O|æ°§åŒ–éˆ‰", "Na", "-", "-", "-", "1132", "1950", [{elem:"O",x:0,y:0,z:0,r:25,lpCount:0}, {elem:"Na",x:-90,y:0,z:0,r:20,lpCount:0}, {elem:"Na",x:90,y:0,z:0,r:20,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–éˆ‰ (Naâ‚‚O)</strong><br>é¹¼æ€§æ°§åŒ–ç‰©ã€‚</div></div>');
addMol("K2O|æ°§åŒ–é‰€", "K", "-", "-", "-", "740", "åˆ†è§£", [{elem:"O",x:0,y:0,z:0,r:25,lpCount:0}, {elem:"K",x:-100,y:0,z:0,r:22,lpCount:0}, {elem:"K",x:100,y:0,z:0,r:22,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§‚ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–é‰€ (Kâ‚‚O)</strong><br>æ¥µæ˜“å¸æ¿•ï¼Œç”¨æ–¼è‚¥æ–™è¨ˆç®—åŸºæº–ã€‚</div></div>');
addMol("Na2S|ç¡«åŒ–éˆ‰", "Na", "-", "-", "-", "1176", "-", [{elem:"S",x:0,y:0,z:0,r:30,lpCount:0}, {elem:"Na",x:-90,y:0,z:0,r:20,lpCount:0}, {elem:"Na",x:90,y:0,z:0,r:20,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>ç¡«åŒ–éˆ‰ (Naâ‚‚S)</strong><br>ä¿—ç¨±è‡­é¹¼ï¼Œç”¨æ–¼é€ ç´™èˆ‡çš®é©å·¥æ¥­ã€‚</div></div>');
addMol("FeCl2|æ°¯åŒ–äºéµ", "Fe", "-", "-", "-", "677", "1023", [{elem:"Fe",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"Cl",x:-85,y:0,z:0,r:35,lpCount:0}, {elem:"Cl",x:85,y:0,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–äºéµ (FeClâ‚‚)</strong><br>æ·ºç¶ è‰²æ™¶é«”ï¼Œå…·é‚„åŸæ€§ã€‚</div></div>');
addMol("FeCl3|æ°¯åŒ–éµ", "Fe", "-", "-", "-", "306", "315", [{elem:"Fe",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"Cl",x:0,y:90,z:0,r:35,lpCount:0}, {elem:"Cl",x:-78,y:-45,z:0,r:35,lpCount:0}, {elem:"Cl",x:78,y:-45,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"], [0, 3, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–éµ (FeClâ‚ƒ)</strong><br>é»‘æ£•è‰²æ™¶é«”ï¼Œç”¨æ–¼é›»è·¯æ¿è•åˆ»ã€‚</div></div>');
addMol("AlCl3|æ°¯åŒ–é‹", "Al", "-", "-", "-", "192", "180 (æ˜‡è¯)", [{elem:"Al",x:0,y:0,z:0,r:18,lpCount:0}, {elem:"Cl",x:0,y:90,z:0,r:35,lpCount:0}, {elem:"Cl",x:-78,y:-45,z:0,r:35,lpCount:0}, {elem:"Cl",x:78,y:-45,z:0,r:35,lpCount:0}], [[0, 1, "ionic_thin"], [0, 2, "ionic_thin"], [0, 3, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§ª ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°¯åŒ–é‹ (AlClâ‚ƒ)</strong><br>è·¯æ˜“æ–¯é…¸ï¼Œæœ‰æ©Ÿåˆæˆå‚¬åŒ–åŠ‘ã€‚</div></div>');
addMol("Al2O3|æ°§åŒ–é‹|å‰›ç‰", "Al", "-", "-", "-", "2072", "2977", [{elem:"O",x:-90,y:-20,z:0,r:25,lpCount:0}, {elem:"Al",x:-45,y:40,z:0,r:18,lpCount:0}, {elem:"O",x:0,y:-20,z:0,r:25,lpCount:0}, {elem:"Al",x:45,y:40,z:0,r:18,lpCount:0}, {elem:"O",x:90,y:-20,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"], [1, 2, "ionic_thin"], [2, 3, "ionic_thin"], [3, 4, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ’ ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–é‹ (Alâ‚‚Oâ‚ƒ)</strong><br>å‰›ç‰ï¼Œç´…å¯¶çŸ³èˆ‡è—å¯¶çŸ³çš„ä¸»è¦æˆåˆ†ï¼Œç¡¬åº¦é«˜ã€‚</div></div>');
addMol("Fe2O3|æ°§åŒ–éµ|èµ¤éµç¤¦", "Fe", "-", "-", "-", "1565", "-", [{elem:"O",x:-90,y:-20,z:0,r:25,lpCount:0}, {elem:"Fe",x:-45,y:40,z:0,r:18,lpCount:0}, {elem:"O",x:0,y:-20,z:0,r:25,lpCount:0}, {elem:"Fe",x:45,y:40,z:0,r:18,lpCount:0}, {elem:"O",x:90,y:-20,z:0,r:25,lpCount:0}], [[0, 1, "ionic_thin"], [1, 2, "ionic_thin"], [2, 3, "ionic_thin"], [3, 4, "ionic_thin"]], null, '<div class="info-section"><div class="info-title">ğŸ§± ç‰©è³ªæ€§è³ª</div><div class="info-body"><strong>æ°§åŒ–éµ (Feâ‚‚Oâ‚ƒ)</strong><br>ç´…æ£•è‰²ç²‰æœ«ï¼Œä¿—ç¨±éµé½æˆ–ç´…åœŸï¼Œç‚ºèµ¤éµç¤¦æˆåˆ†ã€‚</div></div>');


// ==========================================
// ç¢³ç°‡ç”Ÿæˆå™¨ (æ”¾åœ¨æª”æ¡ˆæœ€å¾Œé¢)
// ==========================================
function addFullerene(name, n, radius, stretch = 1) {
    const atoms = [];
    if (n === 60) {
        const phi = (1 + Math.sqrt(5)) / 2; 
        const scale = 28;
        let rawVerts = [];
        const groups = [[0, 1, 3*phi], [1, 2+phi, 2*phi], [phi, 2, 2*phi+1]];
        groups.forEach(g => {
            const cycles = [[g[0],g[1],g[2]], [g[1],g[2],g[0]], [g[2],g[0],g[1]]];
            cycles.forEach(p => {
                for(let i=0; i<8; i++) {
                    let x = p[0] * ((i & 1) ? 1 : -1);
                    let y = p[1] * ((i & 2) ? 1 : -1);
                    let z = p[2] * ((i & 4) ? 1 : -1);
                    rawVerts.push({x, y, z});
                }
            });
        });
        const threshold = 0.1;
        rawVerts.forEach(v => {
            if(!atoms.some(a => Math.abs(a.x - v.x*scale) < threshold && Math.abs(a.y - v.y*scale) < threshold && Math.abs(a.z - v.z*scale) < threshold)) {
                atoms.push({elem: "C", x: v.x*scale, y: v.y*scale, z: v.z*scale, r: 5, lpCount: 0});
            }
        });
    } else {
        const phi = Math.PI * (3 - Math.sqrt(5)); 
        for(let i = 0; i < n; i++) {
            const y = 1 - (i / (n - 1)) * 2; 
            const r = Math.sqrt(1 - y * y);
            const theta = phi * i;
            const x = Math.cos(theta) * r;
            const z = Math.sin(theta) * r;
            atoms.push({elem: "C", x: x * radius, y: y * radius * stretch, z: z * radius, r: 5, lpCount: 0});
        }
    }
    const bonds = []; const bondSet = new Set();
    for(let i = 0; i < atoms.length; i++) {
        let dists = [];
        for(let j = 0; j < atoms.length; j++) {
            if(i === j) continue;
            let d = (atoms[i].x - atoms[j].x)**2 + (atoms[i].y - atoms[j].y)**2 + (atoms[i].z - atoms[j].z)**2;
            dists.push({id: j, d: d});
        }
        dists.sort((a, b) => a.d - b.d);
        for(let k = 0; k < 3; k++){
            let neighbor = dists[k].id;
            let id1 = Math.min(i, neighbor); let id2 = Math.max(i, neighbor);
            let key = `${id1}-${id2}`;
            if(!bondSet.has(key)){
                let type = (k === 0) ? "double" : "single"; 
                bonds.push([id1, id2, type]); bondSet.add(key);
            }
        }
    }
    // [ä¿®æ­£] è£œä¸Š mp å’Œ bp åƒæ•¸ ("-", "-")ï¼Œé¿å…åƒæ•¸éŒ¯ä½
    addMol(name, "C", "spÂ²", ["çƒç‹€", n===60?"Truncated Icosahedron":"Fullerene"], "120Â°", "-", "-", atoms, bonds);
}

// [ä¿®æ­£] åŠ ä¸Šä¸­æ–‡åç¨±ï¼Œè®“ã€ŒçŒœä½ æƒ³çœ‹ã€é¡¯ç¤ºæ›´å®Œæ•´
addFullerene("C36|ç¢³36", 36, 130);
addFullerene("C40|ç¢³40", 40, 140);
addFullerene("C50|ç¢³50", 50, 160);
addFullerene("C70|ç¢³70", 70, 160, 1.4);
addFullerene("C80|ç¢³80", 80, 170);
addFullerene("C100|ç¢³100", 100, 190);

// Defensive cleanup for any "è¤‡åˆ"/composite mode artifacts possibly defined here
(function(){
    const keys = ["æ¨¡å¼: è¤‡åˆ","æ¨¡å¼_è¤‡åˆ","è¤‡åˆæ¨¡å¼","compositeMode","modeComposite","composite"];
    if (typeof window !== 'undefined') {
        keys.forEach(k=>{
            try { if (window.hasOwnProperty(k)) delete window[k]; } catch(e){ try { window[k]=undefined; } catch(_){} }
        });
    }
})();
</script>
<script>
// ==========================================
// data_reactions.js - åŒ–å­¸åæ‡‰é‚è¼¯èˆ‡å‹•ç•«æ§åˆ¶
// ==========================================

// å„²å­˜åæ‡‰æ­·å²ç´€éŒ„ï¼Œç”¨æ–¼ã€Œé‡ç½®/è¿”å›ã€åŠŸèƒ½
moleculeHistory = [];

// å–å¾—ç•¶å‰åˆ†å­çš„ä¸­æ–‡åç¨± (è¼”åŠ©å‡½å¼)
function getCurrentMoleculeName() {
    // ç¢ºä¿è®€å–å…¨åŸŸçš„ window.currentMolecule
    if (!window.currentMolecule || !window.currentMolecule.fullKey) return "";
    const parts = currentMolecule.fullKey.split('|');
    return parts.length > 1 ? parts[1].trim() : parts[0].trim();
}

// æ ¸å¿ƒé‚è¼¯ï¼šæª¢æŸ¥æŒ‰éˆ•ç‹€æ…‹ & æ±ºå®šå“ªäº›åæ‡‰æŒ‰éˆ•è©²å‡ºç¾
function checkReactionAvailable(key) {
    const btnContainer = document.getElementById("reaction-container");
    const resetBtn = document.querySelector(".reset-btn");
    const btns = document.querySelectorAll(".reaction-btn"); 
    
    // 1. åˆå§‹åŒ–ï¼šéš±è—æ‰€æœ‰æŒ‰éˆ•ï¼ˆguard for removed UIï¼‰
    if (btns && btns.length) btns.forEach(b => b.style.display = "none");
    if (btnContainer) btnContainer.style.display = "none";
    if (resetBtn) resetBtn.style.display = "none";

    const currentName = getCurrentMoleculeName();

    // --- A. ä¹™çƒ¯å°ˆå±¬åæ‡‰ ---
    if (currentName === "ä¹™çƒ¯") {
        if (btnContainer) btnContainer.style.display = "block";
        ["reaction-btn", "reaction-h2-btn", "reaction-hcl-btn", "reaction-cl2-btn", "reaction-kmno4-btn"].forEach(id => {
            const el = document.getElementById(id);
            if(el) el.style.display = "flex";
        });
    } 
    // --- B. ä¸™çƒ¯å°ˆå±¬åæ‡‰ ---
    else if (currentName === "ä¸™çƒ¯") { 
        if (btnContainer) btnContainer.style.display = "block";
        ["reaction-propene-h2-btn", "reaction-propene-cl2-btn", "reaction-propene-hcl-btn", "reaction-propene-h2o-btn"].forEach(id => {
            const el = document.getElementById(id);
            if(el) el.style.display = "flex";
        });
    } 
    // --- C. ä¹™ç‚”å°ˆå±¬åæ‡‰ ---
    else if (currentName === "ä¹™ç‚”") {
        if (btnContainer) btnContainer.style.display = "block";
        ["btn-c2h2-h2-full", "btn-c2h2-h2-part", "btn-c2h2-cl2-full", "btn-c2h2-cl2-part", "btn-c2h2-hcl-full", "btn-c2h2-hcl-part", "btn-c2h2-h2o"].forEach(id => {
            const el = document.getElementById(id);
            if(el) el.style.display = "flex";
        });
    }
    // --- D. ç”²çƒ·å°ˆå±¬åæ‡‰ ---
    else if (currentName === "ç”²çƒ·") {
        if (btnContainer) btnContainer.style.display = "block";
        const subBtn = document.getElementById("reaction-sub-btn");
        const nitroBtn = document.getElementById("reaction-nitro-btn");
        if(subBtn) subBtn.style.display = "flex"; 
        if(nitroBtn) nitroBtn.style.display = "flex"; 
    } 
    // --- E. ä¹™é†‡/ä¹™é†›/ä¹™é…¸ ---
    else if (currentName === "ä¹™é†‡" || currentName === "é…’ç²¾") {
        if (btnContainer) btnContainer.style.display = "block";
        const oxBtn = document.getElementById("reaction-ox-btn");
        const kmBtn = document.getElementById("reaction-kmno4-btn");
        if(oxBtn) oxBtn.style.display = "flex";
        if(kmBtn) kmBtn.style.display = "flex";
    }
    else if (currentName === "ä¹™é†›") {
        if (btnContainer) btnContainer.style.display = "block";
        const oxBtn = document.getElementById("reaction-ox-btn");
        const redBtn = document.getElementById("reaction-red-btn");
        if(oxBtn) oxBtn.style.display = "flex";
        if(redBtn) redBtn.style.display = "flex";
    }

    // åªè¦æ­·å²ç´€éŒ„ä¸æ˜¯ç©ºçš„ï¼Œå°±é¡¯ç¤ºé‡ç½®æŒ‰éˆ• (å›åˆ°ä¸Šä¸€æ­¥)
    if (moleculeHistory.length > 0) {
        if (btnContainer) btnContainer.style.display = "block";
        if (resetBtn) resetBtn.style.display = "block";
    }
}

// é‡ç½®åæ‡‰ (è¿”å›ä¸Šä¸€æ­¥)
function resetReaction() {
    if (moleculeHistory.length === 0) return;

    isReactionRunning = false;
    isReactionFinished = false; 
    
    const subEl = document.getElementById("viewport-subtitle");
    if(subEl) subEl.style.display = 'none';

    // å–å‡ºä¸Šä¸€ç­†ç´€éŒ„ä¸¦è¼‰å…¥
    const previousState = moleculeHistory.pop();
    loadMolecule(previousState.key, previousState.variant);
}

// åŸ·è¡Œåæ‡‰å‹•ç•«èˆ‡åˆ‡æ›åˆ†å­
function finishReaction(nextKey, nextTitle, variantName = null, description = null) {
    moleculeHistory.push({
        key: currentKey,
        variant: currentVariantKey
    });

    const svg = document.getElementById("scene-root");
    svg.classList.add("scene-blur-out");
    
    setTimeout(() => {
        loadMolecule(nextKey, variantName); 
        
        if (description) {
            // 1. éš±è—å·¦ä¸Šè§’å‰¯æ¨™é¡Œæ–‡å­—
            const subtitle = document.getElementById("viewport-subtitle");
            if (subtitle) subtitle.style.display = "none";

            // 2. å°‡æè¿°æ–‡å­—æ”¾å›æ§åˆ¶é¢æ¿çš„ã€Œå°çŸ¥è­˜ã€å¡ç‰‡
            const kCard = document.getElementById("knowledge-card");
            const kText = document.getElementById("knowledge-text");
            if (kCard && kText) {
                kText.innerHTML = description;
                kCard.style.display = "block";
                kCard.classList.add("expanded"); // è‡ªå‹•å±•é–‹å¡ç‰‡
            }
        }
        
        svg.classList.remove("scene-blur-out");
        svg.classList.add("scene-blur-in");
        
        setTimeout(() => {
            svg.classList.remove("scene-blur-in");
            isReactionRunning = false; 
            isReactionFinished = true; 
            checkReactionAvailable(nextKey); 
        }, 1500);
    }, 1500);
}

// --- ä»¥ä¸‹ç‚ºå„åˆ¥åæ‡‰çš„ Runner å‡½å¼ ---
// 1. ä¹™çƒ¯ç³»åˆ— (åŸæ–™: ä¹™çƒ¯)
function runEthyleneHydration() {
    finishReaction("C2H5OH", "ä¹™é†‡", null, "ä¹™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œä¸€å€‹CåŸå­æ¥Hï¼Œå¦ä¸€å€‹CåŸå­æ¥OHï¼Œè½‰è®Šæˆä¹™é†‡");
}
function runEthyleneChlorination() {
    finishReaction("C2H4Cl2", "1,2-äºŒæ°¯ä¹™çƒ·", "C2H4Cl2|1,2-äºŒæ°¯ä¹™çƒ·", "ä¹™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹CåŸå­å„æ¥1å€‹Clï¼Œè½‰è®Šæˆ1,2-äºŒæ°¯ä¹™çƒ·ï¼Œäº¦ç‚ºæ°§åŒ–åæ‡‰(Cæ°§åŒ–æ•¸ä¸Šå‡)");
}
function runEthyleneHydrogenation() {
    finishReaction("C2H6", "ä¹™çƒ·", null, "ä¹™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹CåŸå­å„æ¥1å€‹Hï¼Œè½‰è®Šæˆä¹™çƒ·ï¼Œäº¦ç‚ºé‚„åŸåæ‡‰(Cæ°§åŒ–æ•¸ä¸‹é™)");
}
function runEthyleneHydrohalogenation() {
    finishReaction("C2H5Cl", "æ°¯ä¹™çƒ·", null, "ä¹™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œä¸€å€‹CåŸå­æ¥Hï¼Œå¦ä¸€å€‹CåŸå­æ¥Clï¼Œè½‰è®Šæˆæ°¯ä¹™çƒ·");
}
function runEthyleneOxidation() {
    finishReaction("C2H4(OH)2", "ä¹™äºŒé†‡", "C2H4(OH)2|ä¹™äºŒé†‡|1,2-ä¹™äºŒé†‡", "ä¹™çƒ¯é€šå…¥å†·ç¨€ã€ä¸­æ€§æˆ–å¾®é¹¼æ€§çš„ééŒ³é…¸é‰€æº¶æ¶²ä¸­ï¼Œç¢³ç¢³é›™éµæ–·è£‚ï¼Œç™¼ç”Ÿæ°§åŒ–åæ‡‰ï¼Œé›™éµçš„å…©å€‹Cæ¥ä¸ŠOHï¼Œç”Ÿæˆä¹™äºŒé†‡ã€‚");
}

// 2. ç”²çƒ·ç³»åˆ— (åŸæ–™: ç”²çƒ·)
function runMethaneSubstitution() {
    finishReaction("CH3Cl", "ä¸€æ°¯ç”²çƒ·", null, "ç”²çƒ·å…¶ä¸­ä¸€å€‹C-Héµæ–·è£‚ï¼Œæ¥ä¸ŠClåŸå­ï¼Œè„«å»çš„Hèˆ‡å¦ä¸€å€‹ClåŸå­çµåˆæˆHCl");
}
function runMethaneNitration() {
    finishReaction("CH3NO2", "ç¡åŸºç”²çƒ·", null, "ç”²çƒ·å…¶ä¸­ä¸€å€‹C-Héµæ–·è£‚ï¼Œæ¥ä¸ŠNOâ‚‚ï¼Œè„«å»çš„Hèˆ‡ç¡é…¸è„«å»çš„OHçµåˆæˆHâ‚‚O");
}

// 3. ä¸™çƒ¯ç³»åˆ— (åŸæ–™: ä¸™çƒ¯)
function runPropeneHydrogenation() {
    finishReaction("C3H8", "ä¸™çƒ·", null, "ä¸™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹æ–·ğ¿éµçš„CåŸå­å„æ¥1å€‹Hï¼Œè½‰è®Šæˆä¸™çƒ·ï¼Œäº¦ç‚ºé‚„åŸåæ‡‰(Cæ°§åŒ–æ•¸ä¸‹é™)");
}
function runPropeneChlorination() {
    finishReaction("C3H6Cl2", "1,2-äºŒæ°¯ä¸™çƒ·", "C3H6Cl2|1,2-äºŒæ°¯ä¸™çƒ·", "ä¸™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹æ–·ğ¿éµçš„CåŸå­å„æ¥1å€‹Clï¼Œè½‰è®Šæˆ1,2-äºŒæ°¯ä¸™çƒ·ï¼Œäº¦ç‚ºæ°§åŒ–åæ‡‰(Cæ°§åŒ–æ•¸ä¸Šå‡)");
}
function runPropeneHydrohalogenation() {
    finishReaction("C3H7Cl", "2-æ°¯ä¸™çƒ·", "C3H7Cl|2-æ°¯ä¸™çƒ·", "ä¸™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹æ–·ğ¿éµçš„CåŸå­ï¼Œå«Hè¼ƒå¤šçš„Cé€£æ¥Hï¼Œå¦ä¸€å€‹C(ä¸­é–“)é€£æ¥Clï¼Œè½‰è®Šæˆ2-æ°¯ä¸™çƒ·(éœ€è€ƒæ…®é¦¬æ°è¦å‰‡)");
}
function runPropeneHydration() {
    finishReaction("C3H8O", "2-ä¸™é†‡", "C3H8O|2-ä¸™é†‡", "ä¸™çƒ¯çš„ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œå…©å€‹æ–·ğ¿éµçš„CåŸå­ï¼Œå«Hè¼ƒå¤šçš„Cé€£æ¥Hï¼Œå¦ä¸€å€‹C(ä¸­é–“)é€£æ¥OHï¼Œè½‰è®Šæˆç•°ä¸™é†‡(éœ€è€ƒæ…®é¦¬æ°è¦å‰‡)");
}

// 4. ä¹™é†‡/ä¹™é†›ç³»åˆ—
function runEthanolMildOxidation() {
    finishReaction("CH3CHO", "ä¹™é†›", null, "ä¹™é†‡ç‚º1ç´šé†‡ï¼Œæ¥Oçš„Cä¸Šå…·æœ‰Hï¼Œä¸€èˆ¬æ°§åŒ–åŠ‘æœƒå…ˆå°‡ä¹™é†‡æ°§åŒ–æˆä¹™é†›");
}
function runEthanolStrongOxidation() {
    finishReaction("CH3COOH", "ä¹™é…¸", null, "ä¹™é†‡ç‚º1ç´šé†‡ï¼Œæ¥Oçš„Cä¸Šå…·æœ‰Hï¼Œç”±æ–¼ééŒ³é…¸é‰€æ°§åŒ–åŠ›è¼ƒå¼·ï¼Œæ•…ä¹™é†‡ç›´æ¥æ°§åŒ–æˆä¹™é…¸");
}
function runAcetaldehydeOxidation() {
    finishReaction("CH3COOH", "ä¹™é…¸", null, "ä¹™é†›æ¥Oçš„Cä¸Šå…·æœ‰Hï¼Œç¶“éæ°§åŒ–å¯ä»¥å½¢æˆä¹™é…¸");
}
function runAcetaldehydeReduction() {
    finishReaction("C2H5OH", "ä¹™é†‡", null, "é†›é¡å¯ä»¥é‚„åŸï¼Œè®Šå›1ç´šé†‡ï¼Œä¹™é†›é‚„åŸå¾Œå½¢æˆä¹™é†‡");
}

// 5. ä¹™ç‚”ç³»åˆ—
function runAcetyleneFullHydrogenation() {
    finishReaction("C2H6", "ä¹™çƒ·", null, "ä¹™ç‚”çš„å…©å€‹ç¢³ç¢³ğ¿éµå…¨æ•¸æ‰“æ–·ï¼Œåƒéµå…©ç«¯çš„CåŸå­å„æ¥ä¸Š2å€‹Hï¼Œè½‰è®Šæˆé£½å’Œçš„ä¹™çƒ·ï¼Œäº¦ç‚ºé‚„åŸåæ‡‰(Cæ°§åŒ–æ•¸ä¸‹é™)ã€‚");
}
function runAcetylenePartialHydrogenation() {
    finishReaction("C2H4", "ä¹™çƒ¯", null, "ä¹™ç‚”çš„å…¶ä¸­ä¸€å€‹ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œåƒéµå…©ç«¯çš„CåŸå­å„æ¥ä¸Š1å€‹Hï¼Œè½‰è®Šæˆä¹™çƒ¯ï¼Œæ­¤ç‚ºæ§åˆ¶æ¢ä»¶ä¸‹çš„éƒ¨åˆ†é‚„åŸåæ‡‰(Cæ°§åŒ–æ•¸ä¸‹é™)ã€‚");
}
function runAcetyleneFullHalogenation() {
    finishReaction("C2H2Cl4", "1,1,2,2-å››æ°¯ä¹™çƒ·", "C2H2Cl4|1,1,2,2-å››æ°¯ä¹™çƒ·", "ä¹™ç‚”çš„å…©å€‹ç¢³ç¢³ğ¿éµå…¨æ•¸æ‰“æ–·ï¼Œåƒéµå…©ç«¯çš„CåŸå­å„æ¥ä¸Š2å€‹Clï¼Œè½‰è®Šæˆ1,1,2,2-å››æ°¯ä¹™çƒ·ï¼Œäº¦ç‚ºæ°§åŒ–åæ‡‰(Cæ°§åŒ–æ•¸ä¸Šå‡)ã€‚");
}
function runAcetylenePartialHalogenation() {
    finishReaction("C2H2Cl2", "å-1,2-äºŒæ°¯ä¹™çƒ¯", "C2H2Cl2|å-1,2-äºŒæ°¯ä¹™çƒ¯", "ä¹™ç‚”çš„å…¶ä¸­ä¸€å€‹ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œåƒéµå…©ç«¯çš„CåŸå­å„æ¥ä¸Š1å€‹Clï¼Œè½‰è®Šæˆ1,2-äºŒæ°¯ä¹™çƒ¯(å¾åæ‡‰æ©Ÿæ§‹å¯çŸ¥ä¸»ç”¢ç‰©ç‚ºåå¼)ã€‚");
}
function runAcetyleneFullHydrohalogenation() {
    finishReaction("C2H4Cl2", "1,1-äºŒæ°¯ä¹™çƒ·", "C2H4Cl2|1,1-äºŒæ°¯ä¹™çƒ·", "ä¹™ç‚”èˆ‡è¶³é‡é¹µåŒ–æ°«åæ‡‰ï¼Œå…©å€‹ç¢³ç¢³ğ¿éµå…¨æ•¸æ‰“æ–·ã€‚ä¾é¦¬æ°è¦å‰‡ï¼Œå…©å€‹ClåŸå­æœƒæ¥åœ¨åŒä¸€å€‹CåŸå­ä¸Šï¼Œè½‰è®Šæˆ1,1-äºŒæ°¯ä¹™çƒ·ã€‚");
}
function runAcetylenePartialHydrohalogenation() {
    finishReaction("C2H3Cl", "æ°¯ä¹™çƒ¯", "C2H3Cl|æ°¯ä¹™çƒ¯", "ä¹™ç‚”çš„å…¶ä¸­ä¸€å€‹ç¢³ç¢³ğ¿éµæ‰“æ–·ï¼Œä¸€å€‹Cæ¥Hï¼Œå¦ä¸€å€‹Cæ¥Clï¼Œè½‰è®Šæˆæ°¯ä¹™çƒ¯ï¼Œæ­¤ç‚ºèšæ°¯ä¹™çƒ¯(PVC)çš„é‡è¦å–®é«”åŸæ–™ã€‚");
}
function runAcetyleneHydration() {
    finishReaction("CH3CHO", "ä¹™é†›", null, "ä¹™ç‚”åœ¨ç¡«é…¸èˆ‡ç¡«é…¸æ±(HgSOâ‚„)å‚¬åŒ–ä¸‹èˆ‡æ°´åŠ æˆï¼Œğ¿éµæ–·è£‚å¾Œå…ˆå½¢æˆä¸ç©©å®šçš„ä¹™çƒ¯é†‡ï¼Œéš¨å³ç™¼ç”Ÿã€é†›é…®-çƒ¯é†‡äº’è®Šç•°æ§‹ã€ï¼Œæ°«åŸå­è½‰ç§»ï¼Œæœ€çµ‚è½‰è®Šæˆä¹™é†›ã€‚");
}

// Defensive cleanup for any "è¤‡åˆ"/composite mode artifacts possibly defined here
(function(){
	const keys = ["æ¨¡å¼: è¤‡åˆ","æ¨¡å¼_è¤‡åˆ","è¤‡åˆæ¨¡å¼","compositeMode","modeComposite","composite"];
	if (typeof window !== 'undefined') {
		keys.forEach(k=>{
			try { if (window.hasOwnProperty(k)) delete window[k]; } catch(e){ try { window[k]=undefined; } catch(_){} }
		});
	}
})();
</script>
<script>
// ==========================================
// 1. ç³»çµ±åˆå§‹åŒ–
// ==========================================
window.currentMolecule = null;
window.currentKey = null;
window.togglePgFlowchart = function() {
    const overlay = document.getElementById('pg-flowchart-overlay');
    if (!overlay) return;
    if (overlay.style.display === 'none' || overlay.style.display === '') {
        overlay.style.display = 'block';
        document.body.style.overflow = 'hidden'; 
    } else {
        overlay.style.display = 'none';
        document.body.style.overflow = '';
    }
};
window.currentVariantKey = null;
window.moleculeHistory = [];
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
let isReactionRunning = false; 
let isReactionFinished = false; 
let isPlasmaMode = false; // [ä¿®å¾©] ç¢ºä¿è®Šæ•¸å­˜åœ¨
window.isGlowOn = false; // Glow disabled by default (option removed)



// --- [æ–°å¢] ç”¨ä¾†å„²å­˜åæ‡‰æ­·å²ç´€éŒ„ ---
let moleculeHistory = [];

function autoAssignLonePairs(atom, bonds, allAtoms) {
    if (atom.lp3d !== undefined && atom.lp3d.length > 0) return atom.lpCount || atom.lp3d.length;
    if (atom.lpCount !== undefined) return atom.lpCount;
    const props = ELEMENT_PROPS[atom.elem]; if (!props) return 0;
    const valence = props.ve; const en = props.en || 0;
    let bondElectronCount = 0; let neighborCount = 0;
    const myIndex = atom.originalIndex;
    bonds.forEach(b => {
        if (b[0] !== myIndex && b[1] !== myIndex) return;
        neighborCount++; 
        let type = b[2] || "single";
        if (type.includes("triple")) bondElectronCount += 3;
        else if (type.includes("double")) bondElectronCount += 2;
        else if (type === "coordinate") { if (b[0] === myIndex) bondElectronCount += 2; }
        else if (type === "coordinate_triple") bondElectronCount += 3;
        else bondElectronCount += 1;
    });
    let remainingElectrons = valence - bondElectronCount;
    if (remainingElectrons % 2 !== 0 && !atom.radical) {
        if (neighborCount === 1 && en > 2.5) remainingElectrons += 1;
    }
    let lp = Math.floor(remainingElectrons / 2);
    return Math.max(0, lp);
}
function generateElectronDots(atom, atomIndex, allAtoms, allBonds) {
    const dots = []; 
    let lpCount = atom.calculatedLP;
    // å¦‚æœæ²’æœ‰å­¤å°é›»å­ä¸”ä¸æ˜¯è‡ªç”±åŸºï¼Œç›´æ¥è¿”å›ç©ºé™£åˆ—
    if (lpCount <= 0 && !atom.radical) return dots;

    // --- 1. å¹¾ä½•ä½ç½®è¨ˆç®— (ç¶­æŒåŸæœ‰çš„ 3D å‘é‡é‹ç®—) ---
    if (atom.lp3d && atom.lp3d.length > 0) {
        // å¦‚æœæœ‰æ‰‹å‹•æŒ‡å®šçš„åº§æ¨™ (hardcoded)
        const pushDist = atom.r * 2.2; 
        atom.lp3d.forEach(v => {
            const len = Math.sqrt(v.x*v.x + v.y*v.y + v.z*v.z) || 1;
            addPairToDots(dots, atom, { x: (v.x/len)*pushDist, y: (v.y/len)*pushDist, z: (v.z/len)*pushDist });
        });
    } else {
        // è‡ªå‹•è¨ˆç®—ï¼šæ ¹æ“šéµçµå‘é‡æ¨ç®—å­¤å°é›»å­ä½ç½®
        const myBonds = allBonds.filter(b => b[0] === atomIndex || b[1] === atomIndex);
        let bondVectors = [];
        myBonds.forEach(b => {
            const otherIdx = (b[0] === atomIndex) ? b[1] : b[0];
            const other = allAtoms[otherIdx];
            let vx = other.x - atom.x, vy = other.y - atom.y, vz = other.z - atom.z;
            const len = Math.sqrt(vx*vx + vy*vy + vz*vz) || 1;
            bondVectors.push({ x: vx/len, y: vy/len, z: vz/len, style: b[2] });
        });
        
        let sumX = 0, sumY = 0, sumZ = 0;
        if (bondVectors.length > 0) { bondVectors.forEach(v => { sumX += v.x; sumY += v.y; sumZ += v.z; }); } 
        else { sumX = 0; sumY = -1; sumZ = 0; }
        
        let backX = -sumX, backY = -sumY, backZ = -sumZ;
        let backLen = Math.sqrt(backX*backX + backY*backY + backZ*backZ);
        if (backLen < 0.001) { backX=0; backY=1; backZ=0; backLen=1; }
        backX /= backLen; backY /= backLen; backZ /= backLen;
        
        let ux = backX, uy = backY, uz = backZ;
        let tempX = 0, tempY = 1, tempZ = 0;
        if (Math.abs(ux) < 0.1 && Math.abs(uz) < 0.1) { tempX=1; tempY=0; tempZ=0; }
        let wx = uy*tempZ - uz*tempY, wy = uz*tempX - ux*tempZ, wz = ux*tempY - uy*tempX;
        let wLen = Math.sqrt(wx*wx + wy*wy + wz*wz);
        wx/=wLen; wy/=wLen; wz/=wLen;
        let vx = wy*uz - wz*uy, vy = wz*ux - wx*uz, vz = wx*uy - wy*ux;
        
        const lpDist = atom.r * 2.2;
        const pushLP = (dx, dy, dz) => { addPairToDots(dots, atom, { x: dx*lpDist, y: dy*lpDist, z: dz*lpDist }); };

        if (bondVectors.length === 1) {
            if (lpCount === 3) {
                const angle = 70 * (Math.PI/180); const sinA = Math.sin(angle); const cosA = Math.cos(angle);
                for(let i=0; i<3; i++) {
                    const theta = i * (120 * Math.PI/180);
                    const px = cosA * ux + sinA * (Math.cos(theta)*vx + Math.sin(theta)*wx);
                    const py = cosA * uy + sinA * (Math.cos(theta)*vy + Math.sin(theta)*wy);
                    const pz = cosA * uz + sinA * (Math.cos(theta)*vz + Math.sin(theta)*wz);
                    pushLP(px, py, pz);
                }
            } else if (lpCount === 2) {
                const angle = 60 * (Math.PI/180);
                pushLP(Math.cos(angle)*ux + Math.sin(angle)*vx, Math.cos(angle)*uy + Math.sin(angle)*vy, Math.cos(angle)*uz + Math.sin(angle)*vz);
                pushLP(Math.cos(angle)*ux - Math.sin(angle)*vx, Math.cos(angle)*uy - Math.sin(angle)*vy, Math.cos(angle)*uz - Math.sin(angle)*vz);
            } else if (lpCount === 1) { pushLP(ux, uy, uz); }
        } else if (bondVectors.length === 2) {
            if (lpCount === 2) {
                let b1 = bondVectors[0], b2 = bondVectors[1];
                let nx = b1.y*b2.z - b1.z*b2.y, ny = b1.z*b2.x - b1.x*b2.z, nz = b1.x*b2.y - b1.y*b2.x;
                let nLen = Math.sqrt(nx*nx + ny*ny + nz*nz);
                if (nLen > 0.001) { nx/=nLen; ny/=nLen; nz/=nLen; } else { nx=vx; ny=vy; nz=vz; }
                const tilt = 50 * (Math.PI/180);
                pushLP(Math.cos(tilt)*ux + Math.sin(tilt)*nx, Math.cos(tilt)*uy + Math.sin(tilt)*ny, Math.cos(tilt)*uz + Math.sin(tilt)*nz);
                pushLP(Math.cos(tilt)*ux - Math.sin(tilt)*nx, Math.cos(tilt)*uy - Math.sin(tilt)*ny, Math.cos(tilt)*uz - Math.sin(tilt)*nz);
            } else if (lpCount === 1) { pushLP(ux, uy, uz); }
        } else { pushLP(ux, uy, uz); }
    }

    // --- 2. [ä¿®æ­£] é¡è‰²åˆ¤å®šé‚è¼¯ (æ’é™¤ NO/NO2) ---
    
    // åˆ¤æ–·æ˜¯å¦ç‚ºæ°®æ°§åŒ–ç‰©ç‰¹ä¾‹
    let isNitrogenOxide = false;
    if (typeof currentKey !== 'undefined' && currentKey) {
        // åªè¦åˆ†å­åç¨±åŒ…å« NO æˆ– NO2 ä¸”ä¸å«é›»è·ç¬¦è™Ÿ(å¦‚ NO3-)ï¼Œå°±è¦–ç‚ºç‰¹ä¾‹
        if (currentKey === "NO" || currentKey === "NO2" || 
            currentKey.startsWith("NO|") || currentKey.startsWith("NO2|")) {
            isNitrogenOxide = true;
        }
    }

    // åªæœ‰ç•¶ï¼š
    // 1. å½¢å¼é›»è· <= -0.5 (å¸¶è² é›»)
    // 2. ä¸” ä¸æ˜¯é…ä½éµæ¥æ”¶è€…
    // 3. ä¸” ä¸æ˜¯ NO/NO2 é€™ç¨®ç‰¹ä¾‹
    // æ‰å°‡é›»å­å¡—æˆç²‰ç´…è‰²
    if (atom.formalCharge <= -0.5 && !atom.isCoordinateReceiver && !isNitrogenOxide) {
        let countToColor = Math.round(Math.abs(atom.formalCharge));
        
        // å€’è‘—æ‰¾ï¼ŒæŠŠæœ€å¾Œå¹¾é¡†é›»å­æ¨™è¨˜ç‚ºç²‰ç´…
        for (let i = dots.length - 1; i >= 0; i--) {
            if (countToColor > 0) {
                dots[i].isNegativeCharge = true;
                countToColor--;
            } else {
                break;
            }
        }
    }

    return dots;
}

function addPairToDots(dotsArray, atom, vector) {
    let lx = vector.x, ly = vector.y, lz = vector.z;
    let ox = -ly, oy = lx, oz = 0;
    if (Math.abs(lx) < 0.1 && Math.abs(ly) < 0.1) { ox = 1; oy = 0; oz = 0; }
    let oLen = Math.sqrt(ox*ox + oy*oy + oz*oz);
    const separation = 14.0; 
    ox = (ox/oLen) * (separation/2); oy = (oy/oLen) * (separation/2); oz = (oz/oLen) * (separation/2);
    const eRadius = 4.5;
    
    // é è¨­ isNegativeCharge ç‚º false
    dotsArray.push({ x: atom.x + lx + ox, y: atom.y + ly + oy, z: atom.z + lz + oz, isElectron: true, r: eRadius, type: 'electron', parentAtom: atom, isNegativeCharge: false });
    
    if (!atom.radical) {
        dotsArray.push({ x: atom.x + lx - ox, y: atom.y + ly - oy, z: atom.z + lz - oz, isElectron: true, r: eRadius, type: 'electron', parentAtom: atom, isNegativeCharge: false });
    }
}





// ==========================================
// 3. æ ¸å¿ƒé‚è¼¯èˆ‡é¡¯ç¤ºæ›´æ–°
// ==========================================

currentMolecule = null;
let currentMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];
let isFaceBuildMode = false;
let faceSelection = [];
let customFaces = [];   
let currentFaceColor = 'yellow'; // é è¨­é¡è‰²
let rotVelocity = { x: 0.004, y: 0.004, z: 0 };
let panOffset = { x: 0, y: 0 }; 
let isLongPressActive = false;
let scale = 1.6; 
let isDragging = false; 
let lastMouse = { x: 0, y: 0 };
let currentMode = 2; 
let altKeyIsDown = false;
currentKey = null; 
currentVariantKey = null;
let lastInteractTime = 0; 
let lastTouchDist = 0;
let lastTouchCenter = { x:0, y:0 };
let lastTouchAngle = 0; 

function toggleMode() {
    currentMode = (currentMode + 1) % 3; 
    const modes = ['å¹³ç§»', 'æ—‹è½‰', 'è¤‡åˆ'];
    const classes = ['mode-pan', 'mode-rotate', 'mode-composite'];
    modeToggleBtn.className = `control-button ${classes[currentMode]} active`;
    modeToggleBtn.innerHTML = `æ¨¡å¼: ${modes[currentMode]}`;
}

function formatFormula(str) {
    if (!str) return "";
    let s = str.trim();
    let mainPart = s;
    let chargePart = "";
    // Normalize stray caret superscripts and spaces
    s = s.replace(/\^/g, '').replace(/\s+/g, '');
    // Match either a trailing digits+sign (e.g. "2-") or a lone sign ("+")
    const m = s.match(/^(.*?)(\d+([+-])|[+-])$/);
    if (m) {
        let rawCharge = m[2] || m[0].slice(m[1].length);
        const startIdx = s.length - rawCharge.length;
        mainPart = s.slice(0, startIdx);

        // If rawCharge contains digits before the sign, decide whether those digits
        // are part of the formula (subscripts) or part of the charge.
        const digitMatch = rawCharge.match(/^(\d+)/);
        if (digitMatch) {
            const digits = digitMatch[1];
            const charBeforeDigits = s[startIdx - 1];
            // If there are multiple digits captured before the sign (e.g. "22-")
            // and the character immediately before those digits is a letter,
            // then it's likely that all but the last digit belong to the formula
            // (e.g. "O22-" -> mainPart should gain the first '2' and charge be '2-').
            if (digits.length > 1 && charBeforeDigits && /[A-Za-z]/.test(charBeforeDigits)) {
                const leading = digits.slice(0, -1);
                const lastDigit = digits.slice(-1);
                mainPart += leading;
                rawCharge = lastDigit + rawCharge.slice(digits.length);
            } else {
                // Fallback heuristic using element parsing: if mainPart contains
                // multiple element types, captured digits are more likely subscript.
                try {
                    const elCounts = parseAtoms(mainPart);
                    const distinctEls = Object.keys(elCounts).length;
                    if (charBeforeDigits && /[A-Za-z]/.test(charBeforeDigits) && distinctEls > 1) {
                        const signOnly = rawCharge.slice(digits.length);
                        mainPart += digits;
                        rawCharge = signOnly || '';
                    }
                } catch (_) {}
            }
            }

        if (rawCharge) {
            // Build display for charge: digits as-is, signs wrapped for styling
            const chargeDisplay = rawCharge.replace(/(\d+)/g, '$1').replace(/([+-]+)/g, '<span class="charge-sign">$1</span>');
            chargePart = `<sup>${chargeDisplay}</sup>`;
        }
    }

    mainPart = mainPart.replace(/(\d+)(?![^<]*>)/g, '<sub>$1</sub>');
    return mainPart + chargePart;
}

function toFraction(val) {
    if (Math.abs(val - Math.round(val)) < 1e-4) return Math.round(val).toString();
    let best_n = 1, best_d = 1, min_err = Math.abs(val - 1);
    for (let d = 2; d <= 64; d++) {
        let n = Math.round(val * d);
        let err = Math.abs(val - n / d);
        if (err < min_err) { min_err = err; best_n = n; best_d = d; }
        if (err < 1e-4) break;
    }
    return `${best_n}/${best_d}`;
}

function parseCharge(c) {
    if (!c) return 0;
    if (c === '+') return 1; if (c === '-') return -1;
    const m = c.match(/^(\d*)([+-])$/);
    if (!m) return 0;
    return parseInt(m[1] || "1") * (m[2] === '+' ? 1 : -1);
}

function parseAtoms(f) {
    let formula = f.replace(/\[/g, '(').replace(/\]/g, ')').replace(/\{/g, '(').replace(/\}/g, ')');
    const stack = [{}];
    let i = 0;
    while (i < formula.length) {
        let char = formula[i];
        if (char === '(') { stack.push({}); i++; }
        else if (char === ')') {
            i++; let mStr = "";
            while (i < formula.length && /\d/.test(formula[i])) { mStr += formula[i]; i++; }
            let m = parseInt(mStr || "1"), popped = stack.pop(), top = stack[stack.length - 1];
            for (let el in popped) { top[el] = (top[el] || 0) + popped[el] * m; }
        } else {
            let match = formula.slice(i).match(/^([A-Z][a-z]*)(\d*)/);
            if (match) {
                let el = match[1], count = parseInt(match[2] || "1"), top = stack[stack.length - 1];
                top[el] = (top[el] || 0) + count; i += match[0].length;
            } else { i++; }
        }
    }
    return stack[0];
}

// Balance feature removed: setupEquationBalancer() deleted per user request.

function solveChemicalEquationWithSteps(eqn) {
    const sides = eqn.split('=');
    if (sides.length !== 2) throw new Error("ç¼ºå°‘ '=' è™Ÿ");
    const parseSide = (s) => s.split(/\s+\+\s+/).map(x => x.trim()).filter(x => x);
    const leftRaw = parseSide(sides[0]), rightRaw = parseSide(sides[1]), allRaw = [...leftRaw, ...rightRaw];

    // 1. è§£æç‰©è³ªèˆ‡å…ƒç´ æ¸…å–®
    const species = allRaw.map((s, idx) => {
        const p = s.split(/\s+/);
        let f = p[0], cS = p[1] || "";
        if (!cS && (f.endsWith('+') || f.endsWith('-'))) { const m = f.match(/^(.*?)(\d*[+-]+)$/); if (m) { f = m[1]; cS = m[2]; } }
        return { index: idx, formula: f, charge: parseCharge(cS), atoms: parseAtoms(f), raw: s };
    });
    const elements = Array.from(new Set(species.flatMap(s => Object.keys(s.atoms))));
    // å°‡è®Šæ•¸å®šç¾©åœ¨å¤–éƒ¨ä½œç”¨åŸŸï¼Œè®“å¾Œé¢çš„è©³è§£æ­¥é©Ÿä¹Ÿèƒ½è®€å–
    let redoxInfo = { partnerEl: null, partnerDelta: 0, h2o2Delta: 0, h2o2Idx: -1 };

    const finalCoeffs = (function() {
        // åˆå§‹åŒ–çŸ©é™£ï¼šåŸå­å®ˆæ†(elements.length) + é›»å­å®ˆæ†(1) + é›»è·å®ˆæ†(1)
        let m = Array.from({ length: elements.length + 2 }, () => new Array(species.length).fill(0));
        const redoxRowIdx = elements.length;
        const chargeRowIdx = elements.length + 1;

        // --- æ°§åŒ–é‚„åŸé‚è¼¯åˆ¤å®š ---
        const h2o2 = species.find(s => s.formula === "H2O2" && s.index < leftRaw.length);
        if (h2o2) {
            redoxInfo.h2o2Idx = h2o2.index;
            elements.filter(e => e !== 'H' && e !== 'O').forEach(el => {
                const r = species.find(s => s.index < leftRaw.length && s.atoms[el]);
                const p = species.find(s => s.index >= leftRaw.length && s.atoms[el]);
                if (r && p) {
                    const oxR = (r.charge - (r.atoms['O'] || 0) * -2 - (r.atoms['H'] || 0) * 1) / (r.atoms[el] || 1);
                    const oxP = (p.charge - (p.atoms['O'] || 0) * -2 - (p.atoms['H'] || 0) * 1) / (p.atoms[el] || 1);
                    if (Math.abs(oxR - oxP) > 0.01) {
                        redoxInfo.partnerEl = el;
                        redoxInfo.partnerDelta = oxP - oxR;
                        redoxInfo.h2o2Delta = (redoxInfo.partnerDelta < 0) ? 1 : -1;
                    }
                }
            });
        }

        species.forEach((s, j) => {
            const sign = (j < leftRaw.length) ? 1 : -1;
            // 1. åŸå­å®ˆæ†
            elements.forEach((el, i) => m[i][j] = (s.atoms[el] || 0) * sign);
            
            // 2. é›»å­å®ˆæ† (åªæœ‰åæ‡‰ç‰©åƒèˆ‡é›»å­äº¤æ›è¨ˆç®—)
            if (redoxInfo.h2o2Delta !== 0 && j < leftRaw.length) {
                if (s.formula === "H2O2") {
                    m[redoxRowIdx][j] = 2 * redoxInfo.h2o2Delta; // æ¯è«è€³ H2O2 è½‰ç§» 2 è«è€³é›»å­
                } else if (redoxInfo.partnerEl && s.atoms[redoxInfo.partnerEl]) {
                    m[redoxRowIdx][j] = s.atoms[redoxInfo.partnerEl] * redoxInfo.partnerDelta;
                }
            }

            // 3. é›»è·å®ˆæ†
            m[chargeRowIdx][j] = s.charge * sign;
        });
        return gaussElimination(m);
    })();

    const buildModularEq = (coeffs) => {
        let itemsHtml = "";
        species.forEach((s, i) => {
            let unit = `<div style="display: inline-flex; align-items: baseline; background: #1e293b; padding: 4px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); box-shadow: inset 0 1px 1px rgba(255,255,255,0.05), 0 4px 8px rgba(0,0,0,0.3); margin: 4px 2px; gap: 4px; vertical-align: middle;"><span style="font-size: 1.1rem; color: #facc15; font-weight: 900; font-style: italic;">${coeffs[i]}</span><span style="font-size: 1.1rem; color: #fff; font-weight: 500;">${formatFormula(s.raw)}</span></div>`;
            itemsHtml += unit;
            if (i === leftRaw.length - 1) itemsHtml += `<span style="display: inline-flex; align-items: center; margin: 0 8px; color: var(--accent-yellow); font-size: 1.2rem; font-weight: bold;">â†’</span>`;
            else if (i < species.length - 1) itemsHtml += `<span style="display: inline-flex; align-items: center; margin: 0 2px; color: rgba(255,255,255,0.8); font-size: 1rem;">+</span>`;
        });
        return `<div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; width: 100%;">${itemsHtml}</div>`;
    };

    let stp = `<div style="font-weight:bold; font-size:1.2rem; color:#fff; margin-bottom:20px; text-align:center; border-bottom:2px solid #facc15; padding-bottom:10px; letter-spacing:2px;">ğŸ§ª è§€å¯Ÿæ³• + ä»£æ•¸æ³•è§£é¡Œ</div>`;
    let startIdx = 0, maxScore = 0;
    species.forEach((s, i) => { 
        let score = Object.keys(s.atoms).length * 10 + Object.values(s.atoms).reduce((a,b)=>a+b,0);
        if (score > maxScore) { maxScore = score; startIdx = i; } 
    });
    stp += `<div class="step-box"><div class="step-title">æ­¥é©Ÿ 1ï¼šé¸å®šåŸºæº–</div>è¨­å®šçµæ§‹æœ€è¤‡é›œçš„ <span style="color:#fbbf24; font-weight:bold;">${formatFormula(species[startIdx].raw)}</span> ä¿‚æ•¸ç‚º <span class="coeff">1</span>ã€‚</div>`;

    let locked = new Set([startIdx]), expressions = new Array(species.length).fill(""), usedConservation = new Set(), obsDetails = [];
    expressions[startIdx] = "1";
    const toMathTerm = (expr, count) => {
        if (!count || !expr) return null;
        if (expr === "1") return `${count}`;
        let mMatch = expr.match(/^(\d*\.?\d*)/)[1], numPart = mMatch === "" ? 1 : parseFloat(mMatch);
        let varPart = expr.replace(/[0-9.]/g, ''), totalNum = numPart * count;
        return (totalNum === 1 ? "" : (totalNum === -1 ? "-" : totalNum)) + varPart;
    };

    let progressed = true;
    while(progressed) {
        progressed = false;
        for(let el of elements) {
            if (usedConservation.has(el)) continue;
            let rel = species.filter(s => s.atoms[el] > 0), unk = rel.filter(s => !locked.has(s.index));
            if(unk.length === 1 && rel.length > 1) {
                let target = unk[0]; locked.add(target.index);
                expressions[target.index] = toFraction(finalCoeffs[target.index] / finalCoeffs[startIdx]);
                usedConservation.add(el);
                obsDetails.push(`â€¢ è§€å¯Ÿ <span class="highlight-atom">${el}</span> åŸå­ï¼šé–å®š <span style="color:var(--accent-yellow);">${formatFormula(target.raw)}</span> ç‚º <span class="coeff">${expressions[target.index]}</span>ã€‚`);
                progressed = true; break;
            }
        }
        if(progressed) continue;
        if (!usedConservation.has("charge")) {
            let unkC = species.filter(s => s.charge !== 0 && !locked.has(s.index));
            if(unkC.length === 1) {
                let target = unkC[0]; locked.add(target.index);
                expressions[target.index] = toFraction(finalCoeffs[target.index] / finalCoeffs[startIdx]);
                usedConservation.add("charge");
                obsDetails.push(`â€¢ è§€å¯Ÿ <span class="highlight-atom">é›»è·</span>ï¼šé–å®š <span style="color:var(--accent-yellow);">${formatFormula(target.raw)}</span> ç‚º <span class="coeff">${expressions[target.index]}</span>ã€‚`);
                progressed = true;
            }
        }
    }
    stp += `<div class="step-box"><div class="step-title">æ­¥é©Ÿ 2ï¼šè§€å¯Ÿæ³•</div><div style="font-size:1.05rem; line-height:1.8;">${obsDetails.length > 0 ? obsDetails.join('<br>') : "å¯ç”±åŸºæº–ç›´æ¥æ¨å°ã€‚"}</div></div>`;
    // --- æ­¥é©Ÿ 3ï¼šæ°§åŒ–é‚„åŸå®ˆæ†èªªæ³• ---
    if (redoxInfo && redoxInfo.h2o2Delta !== 0) {
        const h2o2Role = redoxInfo.h2o2Delta > 0 ? "é‚„åŸåŠ‘ (æ°§åŒ–æˆ O<sub>2</sub>)" : "æ°§åŒ–åŠ‘ (é‚„åŸæˆ H<sub>2</sub>O)";
        const eFlowPerPartner = Math.abs(redoxInfo.partnerDelta * species[startIdx].atoms[redoxInfo.partnerEl]);
        const h2o2Coeff = finalCoeffs[redoxInfo.h2o2Idx] / finalCoeffs[startIdx];
        
        stp += `<div class="step-box" style="border-left-color: #f472b6; background: rgba(244, 114, 182, 0.05);">
            <div class="step-title" style="color: #f472b6;">æ­¥é©Ÿ 3ï¼šæ°§åŒ–é‚„åŸå®ˆæ† (é—œéµé™åˆ¶)</div>
            åµæ¸¬åˆ° <span style="color:#f472b6; font-weight:bold;">H<sub>2</sub>O<sub>2</sub></span> åƒèˆ‡åæ‡‰ï¼š<br>
            â€¢ è®Šåƒ¹å¤¥ä¼´ï¼š<span style="color:var(--accent-yellow); font-weight:bold;">${redoxInfo.partnerEl}</span> æ°§åŒ–æ•¸å¾åŸºé»è®ŠåŒ–äº† <span style="color:#facc15;">${redoxInfo.partnerDelta}</span>ã€‚<br>
            â€¢ H<sub>2</sub>O<sub>2</sub> è§’è‰²ï¼šæ“”ä»» <span style="color:#f472b6; font-weight:bold;">${h2o2Role}</span>ã€‚<br>
            â€¢ æ ¹æ“šé›»å­å¾—å¤±å®ˆæ†ï¼š<br>
            <div class="step-formula-box" style="border-color: #f472b6; color: #f472b6; font-weight:bold;">
                1 Ã— ${eFlowPerPartner}(eâ») = a(H<sub>2</sub>O<sub>2</sub>) Ã— 2(eâ») 
                &nbsp; â†’ &nbsp; <span style="font-size:1.3rem;">a = ${toFraction(h2o2Coeff)}</span>
            </div>
            å¾—åˆ° H<sub>2</sub>O<sub>2</sub> ä¿‚æ•¸å¾Œï¼Œä»£æ•¸ç³»çµ±å³å¯è§£å‡ºå”¯ä¸€è§£ã€‚
        </div>`;
        locked.add(redoxInfo.h2o2Idx);
        expressions[redoxInfo.h2o2Idx] = toFraction(h2o2Coeff);
    }

    if (locked.size < species.length) {
        let vars = ['a', 'b', 'c', 'd'], vIdx = 0, algebraicSteps = [];
        let remaining = species.filter(s => !locked.has(s.index));
        while(remaining.length > 0) {
            let next = remaining[0], v = vars[vIdx++] || 'k';
            let linkEl = Object.keys(next.atoms).find(el => {
                let allRel = species.filter(s => s.atoms[el] > 0);
                return allRel.filter(x => !locked.has(x.index)).length === 2 && allRel.filter(x => locked.has(x.index)).length === 0;
            });
            if (linkEl) {
                let pair = species.filter(s => s.atoms[linkEl] > 0);
                let s1 = pair[0], s2 = pair[1], n1 = s1.atoms[linkEl], n2 = s2.atoms[linkEl];
                expressions[s1.index] = (n2 === 1 ? "" : n2) + v; expressions[s2.index] = (n1 === 1 ? "" : n1) + v;
                usedConservation.add(linkEl);
                algebraicSteps.push(`â€¢ é—œè¯ <span class="highlight-atom">${linkEl}</span> åŸå­ï¼šè¨­ <span style="color:#f472b6; font-weight:bold;">${formatFormula(s1.raw)}</span> ç‚º <span style="color:#f472b6;">${expressions[s1.index]}</span>ï¼Œå‰‡ <span style="color:#f472b6; font-weight:bold;">${formatFormula(s2.raw)}</span> ç‚º <span style="color:#f472b6;">${expressions[s2.index]}</span>ã€‚`);
                locked.add(s1.index); locked.add(s2.index);
            } else {
                expressions[next.index] = v; algebraicSteps.push(`â€¢ ç¨ç«‹è¨­å…ƒï¼šè¨­ <span style="color:#f472b6; font-weight:bold;">${formatFormula(next.raw)}</span> ç‚º <span style="color:#f472b6;">${v}</span>ã€‚`);
                locked.add(next.index);
            }
            remaining = species.filter(s => !locked.has(s.index));
        }
        const buildEq = (type, elName) => {
            let L = [], R = [];
            species.forEach((s, idx) => {
                let term = toMathTerm(expressions[idx], (type === 'atom' ? s.atoms[elName] : s.charge));
                if (term) (idx < leftRaw.length ? L : R).push(term);
            });
            return `${L.join(' + ') || "0"} = ${R.join(' + ') || "0"}`;
        };
        algebraicSteps.push(`<div style="margin-top:15px; color:#94a3b8; font-size:0.95rem;">åˆ—å‡ºå®ˆæ†ç­‰å¼ï¼š</div>`);
        elements.forEach(el => { if (!usedConservation.has(el)) algebraicSteps.push(`â€¢ æ ¹æ“š <span class="highlight-atom">${el}</span>ï¼š<span style="font-family:'Noto Serif TC', serif; color:#facc15; font-size:1.1rem; font-weight:bold;">${buildEq('atom', el)}</span>`); });
        if (!usedConservation.has("charge") && species.some(s => s.charge !== 0)) algebraicSteps.push(`â€¢ æ ¹æ“š <span class="highlight-atom">é›»è·</span>ï¼š<span style="font-family:'Noto Serif TC', serif; color:#facc15; font-size:1.1rem; font-weight:bold;">${buildEq('charge')}</span>`);

        let solvedVars = []; let seenV = new Set();
        species.forEach((s, idx) => {
            let ex = expressions[idx]; if(!ex || ex === "1") return;
            let vChar = ex.match(/[a-z]/);
            if(vChar && !seenV.has(vChar[0])) {
                seenV.add(vChar[0]); let numMatch = ex.match(/[0-9.]+/), mult = numMatch ? parseFloat(numMatch[0]) : 1;
                let val = toFraction((finalCoeffs[idx] / finalCoeffs[startIdx]) / mult);
                solvedVars.push(`<div style="display:flex; align-items:center; gap:8px;"><span style="font-style:italic; color:#f472b6; font-weight:bold; font-size:1.3rem;">${vChar[0]}</span> <span style="color:#94a3b8;">=</span> <span style="color:#facc15; font-weight:900; font-size:1.6rem; text-shadow: 0 0 10px rgba(250,204,21,0.4);">${val}</span></div>`);
            }
        });
        algebraicSteps.push(`<div style="margin-top:20px; color:#94a3b8;">è§£è¯ç«‹æ–¹ç¨‹å¾—ï¼š</div><div style="display:flex; flex-wrap:wrap; justify-content:center; gap:25px; margin:15px 0; padding:15px; background:rgba(255,255,255,0.03); border-radius:12px;">${solvedVars.join('')}</div>`);
        stp += `<div class="step-box"><div class="step-title">æ­¥é©Ÿ 3ï¼šä»£æ•¸æ³•</div><div style="font-size:1.05rem; line-height:1.8;">${algebraicSteps.join('<br>')}</div></div>`;
    }

    let multiplier = 1, baseV = finalCoeffs[startIdx];
    finalCoeffs.forEach(c => {
        let f = c / baseV;
        for(let d=1; d<=60; d++){ if(Math.abs(f*d - Math.round(f*d)) < 0.01){ multiplier = Math.max(multiplier, d); break; } }
    });

    const finalBox = buildModularEq(finalCoeffs);
    stp += `<div class="step-box" style="border:none;"><div class="step-title">æ­¥é©Ÿ 4ï¼šæ•´æ•¸åŒ– (æœ€ç°¡æ•´æ•¸æ¯”)</div>ç›®å‰æ¯”ä¾‹ï¼š<span style="color:#94a3b8;">(${finalCoeffs.map(c => toFraction(c/baseV)).join(' : ')})</span>ã€‚<br>å…¨é«”ä¹˜ä»¥ <span style="color:#facc15; font-weight:bold;">${multiplier}</span> æ¶ˆé™¤åˆ†æ¯ï¼Œå¾—åˆ°æœ€çµ‚å¹³è¡¡åæ‡‰å¼ï¼š<br><div style="margin-top:20px; padding:15px; background:rgba(255,255,255,0.03); border-radius:15px; border:1px solid rgba(255,255,255,0.08);">${finalBox}</div></div>`;

    const btnDom = document.getElementById('steps-toggle-btn');
    if(btnDom) { btnDom.style.margin = "35px auto 25px auto"; btnDom.style.display = "block"; }
    const resDom = document.getElementById('balance-result');
    if(resDom) { resDom.style.marginBottom = "20px"; }

    let html = buildModularEq(finalCoeffs);

    return { html, stepsHtml: stp };
}

function gaussElimination(matrix) {
    const rows = matrix.length, cols = matrix[0].length;
    let pivot = 0;
    for (let j = 0; j < cols && pivot < rows; j++) {
        let max = pivot;
        for (let i = pivot + 1; i < rows; i++) { if (Math.abs(matrix[i][j]) > Math.abs(matrix[max][j])) max = i; }
        [matrix[pivot], matrix[max]] = [matrix[max], matrix[pivot]];
        if (Math.abs(matrix[pivot][j]) < 1e-10) continue;
        const val = matrix[pivot][j];
        for (let k = 0; k < cols; k++) matrix[pivot][k] /= val;
        for (let i = 0; i < rows; i++) { if (i !== pivot) { const factor = matrix[i][j]; for (let k = 0; k < cols; k++) matrix[i][k] -= factor * matrix[pivot][k]; } }
        pivot++;
    }
    let sol = new Array(cols).fill(0); sol[cols - 1] = 1;
    for (let i = 0; i < cols - 1; i++) { sol[i] = -matrix[i][cols - 1]; }
    let bestMult = 1;
    for (let m = 1; m <= 1000; m++) {
        let allInt = true;
        for (let v of sol) { if (Math.abs(v * m - Math.round(v * m)) > 1e-3) { allInt = false; break; } }
        if (allInt) { bestMult = m; break; }
    }
    return sol.map(v => Math.round(Math.abs(v * bestMult)));
}

function handleLoadBtn() {
    let rawVal = document.getElementById("formula-input").value;
    if (!rawVal) return;

    // ========== éš±è—åŠŸèƒ½ï¼šæŸ¥è©¢ç€è¦½äººæ¬¡ ==========
    if (rawVal === "äººæ¬¡") {
        const subEl = document.getElementById("viewport-subtitle");
        if (subEl) {
            subEl.style.display = "block";
            subEl.style.width = "fit-content";
            subEl.style.border = "1px solid #10b981"; 
            subEl.style.backgroundColor = "rgba(0, 0, 0, 0.9)";
            subEl.style.color = "#10b981"; 
            subEl.style.boxShadow = "0 0 15px rgba(16, 185, 129, 0.3)";
            subEl.style.padding = "10px 20px";
            subEl.style.textAlign = "center";
            
            subEl.innerHTML = `<div style="margin-bottom:8px; font-size:0.9rem; color:#ccc; font-weight:bold;">ğŸ‘ï¸ æœ¬ç«™ç´¯ç©ç€è¦½äººæ¬¡</div>`;
            
            const newImg = new Image();
            newImg.src = `https://hits.sh/weiwei-molecular-lab.app.svg?label=Views&color=10b981&labelColor=2d3748&t=${new Date().getTime()}`;
            newImg.alt = "è¼‰å…¥ä¸­...";
            newImg.style.height = "28px";
            newImg.style.display = "block";
            newImg.style.margin = "0 auto";

            newImg.onerror = function() {
                subEl.innerHTML += `<div style="color:#f87171; font-size:0.8rem;">(é€£ç·šå¤±æ•—)</div>`;
            };
            subEl.appendChild(newImg);
            document.getElementById("formula-input").value = "";
        }
        return; 
    }
    // ===============================================

    // [æ–°å¢] æ‰‹å‹•æœå°‹æ™‚ï¼Œæ¸…ç©ºæ­·å²ç´€éŒ„
    moleculeHistory = [];

    let searchKey = rawVal.replace(/\s/g, '').toUpperCase();
    let target = MOLECULE_INDEX[searchKey];
    if (target) {
        loadMolecule(target.key, target.variant);
    } else if (MOLECULE_DB[rawVal]) {
        loadMolecule(rawVal);
    } else if (MOLECULE_DB[searchKey]) {
        loadMolecule(searchKey);
    } else {
        alert("è³‡æ–™åº«ä¸­æœªæ‰¾åˆ°è©²åˆ†å­: " + rawVal);
    }
}

// `toggleKnowledge` removed â€” knowledge card feature disabled

function multiplyMatrix(a, b) {
    const out = [];
    for (let i = 0; i < 3; i++) { 
        for (let j = 0; j < 3; j++) { 
            let sum = 0;
            for (let k = 0; k < 3; k++) sum += a[i * 3 + k] * b[k * 3 + j];
            out.push(sum);
        }
    }
    return out;
}

function normalizeMatrix(m) {
    let x = [m[0], m[3], m[6]], y = [m[1], m[4], m[7]];
    const lenX = Math.sqrt(x[0]*x[0] + x[1]*x[1] + x[2]*x[2]);
    x = x.map(v => v / lenX);
    const dot = x[0]*y[0] + x[1]*y[1] + x[2]*y[2];
    y = [y[0]-x[0]*dot, y[1]-x[1]*dot, y[2]-x[2]*dot];
    const lenY = Math.sqrt(y[0]*y[0] + y[1]*y[1] + y[2]*y[2]);
    y = y.map(v => v / lenY);
    const z = [x[1]*y[2]-x[2]*y[1], x[2]*y[0]-x[0]*y[2], x[0]*y[1]-x[1]*y[0]];
    return [x[0], y[0], z[0], x[1], y[1], z[1], x[2], y[2], z[2]];
}

function applyRotation(dx, dy, dz) {
    const cx = Math.cos(dy), sx = Math.sin(dy);
    const rotX = [1,0,0, 0,cx,-sx, 0,sx,cx];
    const cy = Math.cos(dx), sy = Math.sin(dx);
    const rotY = [cy,0,sy, 0,1,0, -sy,0,cy];
    const cz = Math.cos(dz), sz = Math.sin(dz);
    const rotZ = [cz,-sz,0, sz,cz,0, 0,0,1];
    let rot = multiplyMatrix(rotY, multiplyMatrix(rotX, rotZ));
    currentMatrix = multiplyMatrix(rot, currentMatrix);
    currentMatrix = normalizeMatrix(currentMatrix);
}

const sceneRoot = document.getElementById("scene-root");
const viewport = document.getElementById("viewport");
const modeToggleBtn = document.getElementById("mode-toggle");
const themeToggleBtn = document.getElementById("theme-toggle");
const variantSelector = document.getElementById("variant-selector");

window.onload = () => {
    // Ensure every molecule has an English name available for English mode
    try {
        if (typeof MOLECULE_DB === 'object') {
            Object.keys(MOLECULE_DB).forEach(k => {
                const d = MOLECULE_DB[k];
                if (!d) return;
                // prefer existing nameEN
                if (d.nameEN && String(d.nameEN).trim() !== '') return;
                const fullKey = d.fullKey || k || '';
                const parts = String(fullKey).split('|').map(p => p && p.trim()).filter(Boolean);
                const isLikelyEnglish = (s) => /[A-Za-z]/.test(String(s));
                let en = '';
                // Prefer any part that looks like English (contains Latin letters)
                for (let i = 0; i < parts.length; i++) {
                    if (isLikelyEnglish(parts[i])) { en = parts[i]; break; }
                }
                // If not found, try common-names lookup (by formula or Chinese name)
                if (!en && typeof COMMON_EN_NAMES === 'object') {
                    const raw0 = parts[0] ? String(parts[0]) : '';
                    const p0 = raw0.toUpperCase();
                    const p1 = parts[1] || parts[0] || '';
                    const norm = (k) => String(k || '').replace(/\^/g, '').replace(/\s+/g, '').toUpperCase();
                    const tryKeys = [p1, p0, norm(p0), norm(p1), raw0.replace(/\s+/g,''), raw0.replace(/\^/g,'')];
                    for (let tk of tryKeys) {
                        if (!tk) continue;
                        if (COMMON_EN_NAMES[tk]) { en = COMMON_EN_NAMES[tk]; break; }
                        if (COMMON_EN_NAMES[tk.toUpperCase()]) { en = COMMON_EN_NAMES[tk.toUpperCase()]; break; }
                    }
                }
                // Last resort: use formula (parts[0]) so something displays in English mode
                if (!en) en = parts[0] || k;
                d.nameEN = en;
            });
        }
    } catch (e) { console.error('populate nameEN failed', e); }

    if(Object.keys(MOLECULE_DB).length > 0) {
        loadMolecule("H2O"); 
    }
    animate();
    setupInteractions();
    // Initialize theme from localStorage
    try {
        const light = localStorage.getItem('lightMode') === 'true';
        if (light) {
            document.body.classList.add('light-mode');
            if (themeToggleBtn) themeToggleBtn.textContent = 'æ·±è‰²æ¨¡å¼';
        } else {
            if (themeToggleBtn) themeToggleBtn.textContent = 'æ·ºè‰²æ¨¡å¼';
        }
    } catch (e) { /* ignore localStorage errors */ }
};

// Debug helper: open the app with ?dbg=1 to log formatted formulas for candidates
if (typeof window !== 'undefined' && window.location && window.location.search && window.location.search.indexOf('dbg=1') !== -1) {
    try {
        const seen = new Set();
        const addToken = (t) => { if (!t) return; const s = String(t).trim(); if (s && /[+-]/.test(s)) seen.add(s); };
        if (typeof MOLECULE_DB === 'object') {
            Object.keys(MOLECULE_DB).forEach(k => {
                addToken((k||'').split('|')[0]);
                const d = MOLECULE_DB[k];
                if (d && d.variants) Object.keys(d.variants).forEach(vk => addToken((vk||'').split('|')[0]));
            });
        }
        if (typeof COMMON_EN_NAMES === 'object') Object.keys(COMMON_EN_NAMES).forEach(k => addToken(k));
        console.log('Format debug: found', seen.size, 'candidates');
        seen.forEach(t => console.log(t, '->', formatFormula(t)));
    } catch (e) { console.error('Format debug failed', e); }
}

function loadMolecule(key, variantKey = null) {
    const subEl = document.getElementById("viewport-subtitle");
    if(subEl) { subEl.style.display = 'none'; subEl.textContent = ""; }
    
    let targetData = MOLECULE_DB[key];
    if (!targetData && MOLECULE_INDEX[key.toUpperCase()]) {
        const idx = MOLECULE_INDEX[key.toUpperCase()];
        targetData = MOLECULE_DB[idx.key];
        key = idx.key; 
        if (!variantKey) variantKey = idx.variant;
    }
    if (!targetData) { console.error("Data missing for:", key); return; }
    
    // Do not automatically reuse previous variant when loading the same base key â€”
    // if a user requests the base key explicitly, we should show its default variant.

    rotVelocity = { x: 0.004, y: 0.004, z: 0 }; 
    currentKey = key;
    
    let data = targetData;
    if (variantKey && data.variants && data.variants[variantKey]) {
        data = data.variants[variantKey];
    } else if (data.variants && !variantKey) {
        const firstKey = Object.keys(data.variants)[0];
        data = data.variants[firstKey];
        variantKey = firstKey;
    }
    currentVariantKey = variantKey;

    if (!data.bondsRaw) data.bondsRaw = []; 
    let processedBonds = JSON.parse(JSON.stringify(data.bondsRaw)); 
    let processedAtoms = JSON.parse(JSON.stringify(data.atomsRaw)); 

    // å„ªå…ˆéµå¾ªå…«éš…é«”ï¼šå›ºå®šç‚º trueï¼ˆå·²ç§»é™¤å¤–éƒ¨é–‹é—œï¼‰
    const isOctetMode = true;

    const expandableCenters = ['P', 'S', 'Cl', 'As', 'Se', 'Br', 'I', 'Xe', 'Sb', 'Te'];
    let keptDoubleBonds = 0;

    processedBonds.forEach(bond => {
        const idx1 = bond[0], idx2 = bond[1], type = bond[2];
        const a1 = processedAtoms[idx1], a2 = processedAtoms[idx2];
        let cIdx = -1, tIdx = -1;

        if (expandableCenters.includes(a1.elem) && a2.elem === 'O') { cIdx = idx1; tIdx = idx2; }
        else if (expandableCenters.includes(a2.elem) && a1.elem === 'O') { cIdx = idx2; tIdx = idx1; }

        if (cIdx !== -1) {
            if (isOctetMode) {
                if (type === 'double') {
                    const resonanceMols = ["SO2", "äºŒæ°§åŒ–ç¡«", "äºç¡«é…¸", "H2SO3", "SO3", "äºç¡«é…¸æ ¹", "HSO3"];
                    const isResonance = resonanceMols.some(n => currentKey.includes(n));

                    if (isResonance && keptDoubleBonds === 0) {
                        keptDoubleBonds++;
                    } else {
                        bond[2] = 'coordinate';
                        bond[0] = cIdx;
                        bond[1] = tIdx;
                    }
                }
            } else {
                if (type === 'coordinate') bond[2] = 'double';
            }
        }
    });

    let renderObjects = processAtomsData(processedAtoms, processedBonds, data.center);
    
    // UI æ¨™ç±¤åˆ‡æ›
    const isIonic = data.isIonic === true || data.center === "Ionic";
    
    // [ä¿®æ­£] å¦‚æœæ˜¯é›¢å­æ™¶é«”ï¼Œå¼·åˆ¶ç§»é™¤æ‰€æœ‰é›»å­é» (LP)
    if (isIonic) {
        renderObjects = renderObjects.filter(obj => obj.type !== 'electron');
    }

    currentMolecule = { ...data, renderObjects: renderObjects, bonds3D: processedBonds };

    const lblHybrid = document.getElementById("lbl-hybrid");
    const lblShape = document.getElementById("lbl-shape");
    const lblAngle = document.getElementById("lbl-angle");
    const lblBonds = document.getElementById("lbl-bonds");
    const lblMass = document.getElementById("lbl-mass");

    // [ä¿®æ”¹] æ¨™ç±¤é¡¯ç¤ºé‚è¼¯ï¼ˆæœƒä¾èªè¨€åˆ‡æ›ï¼‰
    const currentLang = (window.__APP_LANG) || localStorage.getItem('app_lang') || ((navigator.language && navigator.language.startsWith('en')) ? 'en' : 'zh');
    let labels = { hybrid: '', shape: '', angle: '', bonds: '', mass: '' };
    if (data.isMetal) {
        labels.hybrid = (currentLang === 'en') ? 'Crystal packing' : 'æ™¶é«”å †ç©';
        labels.shape = (currentLang === 'en') ? 'Packing efficiency' : 'ç©ºé–“åˆ©ç”¨ç‡';
        labels.angle = (currentLang === 'en') ? 'Coordination number' : 'é…ä½æ•¸';
        labels.bonds = (currentLang === 'en') ? 'Edge relation' : 'é‚Šé•·é—œä¿‚';
        labels.mass = (currentLang === 'en') ? 'Atomic mass' : 'åŸå­é‡';
    } else if (isIonic) {
        labels.hybrid = (currentLang === 'en') ? 'Crystal packing' : 'æ™¶é«”å †ç©';
        labels.shape = (currentLang === 'en') ? 'Radius ratio (râº/râ»)' : 'åŠå¾‘æ¯” (râº/râ»)';
        labels.angle = (currentLang === 'en') ? 'Coordination number' : 'é…ä½æ•¸';
        labels.bonds = (currentLang === 'en') ? 'Edge relation' : 'é‚Šé•·é—œä¿‚';
        labels.mass = (currentLang === 'en') ? 'Formula mass' : 'å¼é‡';
    } else {
        labels.hybrid = (currentLang === 'en') ? 'Hybridization' : 'æ··æˆè»ŒåŸŸ';
        labels.shape = (currentLang === 'en') ? 'Shape' : 'å½¢ç‹€';
        labels.angle = (currentLang === 'en') ? 'Bond angle' : 'éµè§’';
        labels.bonds = (currentLang === 'en') ? 'Bond stats' : 'éµçµçµ±è¨ˆ';
        labels.mass = (currentLang === 'en') ? 'Molar mass' : 'åˆ†å­é‡';
    }
    if (lblHybrid) lblHybrid.textContent = labels.hybrid;
    if (lblShape) lblShape.textContent = labels.shape;
    if (lblAngle) lblAngle.textContent = labels.angle;
    if (lblBonds) lblBonds.textContent = labels.bonds;
    if (lblMass) lblMass.textContent = labels.mass;

    const formulaEl = document.getElementById('info-formula');
    const nameEl = document.getElementById('info-name');
    const keyParts = (data.fullKey || key).split('|');
    let formulaText = keyParts[0];
    // determine current language (use runtime global or fallback to localStorage / navigator)
    // reuse `currentLang` declared earlier for label translations
    // choose display name: prefer data.nameEN/nameCN if available
    let nameText = '';
    if (currentLang === 'en') {
        nameText = data.nameEN || data.nameCN || (keyParts.length>1? keyParts[1] : '') || '';
    } else {
        nameText = data.nameCN || data.nameEN || (keyParts.length>1? keyParts[1] : '') || '';
    }
    if(formulaEl) formulaEl.innerHTML = formatFormula(formulaText);
    if(nameEl) nameEl.textContent = nameText;

    // Knowledge card removed: no descriptive sidebar is shown

    const dispFormulaEl = document.getElementById("disp-formula");
    if (dispFormulaEl) dispFormulaEl.innerHTML = formatFormula(formulaText);
    const dispCenterEl = document.getElementById("disp-center");
    if (dispCenterEl) dispCenterEl.textContent = nameText;
    const dispHybridEl = document.getElementById("disp-hybrid");
    if (dispHybridEl) dispHybridEl.textContent = data.hybrid;
    const dispShapeEl = document.getElementById("disp-shape");
    if (dispShapeEl) {
        const shapeText = (currentLang === 'en') ? (data.shapeEN || data.shapeCN || data.shape) : (data.shapeCN || data.shapeEN || data.shape);
        dispShapeEl.textContent = shapeText;
    }
    const dispAngleEl = document.getElementById("disp-angle");
    if (dispAngleEl) dispAngleEl.textContent = data.angle;
    const dispMpEl = document.getElementById("disp-mp");
    const missingText = currentLang === 'en' ? 'No data' : 'ç„¡è³‡æ–™';
    if (dispMpEl) dispMpEl.textContent = (data.mp && data.mp !== "-") ? `${data.mp} Â°C` : missingText;
    const dispBpEl = document.getElementById("disp-bp");
    if (dispBpEl) dispBpEl.textContent = (data.bp && data.bp !== "-") ? `${data.bp} Â°C` : missingText;
    
    const bondDisp = document.getElementById("disp-bonds");
    if(bondDisp) {
        if (isIonic) {
            bondDisp.innerHTML = data.edgeRelation || "a = 2(r<sub>+</sub> + r<sub>-</sub>)";
        } else {
            let sigma = 0, pi = 0, totalLP = 0;
            if (currentMolecule.bonds3D) currentMolecule.bonds3D.forEach(b => { 
                sigma++; if(b[2]==='double') pi++; if(b[2]==='triple') pi+=2; 
            });
            currentMolecule.renderObjects.forEach(obj => { if (obj.type === 'atom') totalLP += (obj.calculatedLP||0); });
            bondDisp.innerHTML = `&sigma;: ${sigma} &nbsp; &pi;: ${pi} &nbsp; LP: ${totalLP}`;
        }
    }
    
    let totalMass = 0;
    if (data.atomsRaw) {
        if (isIonic && key.includes("NaCl")) totalMass = 22.99 + 35.45; 
        else data.atomsRaw.forEach(a => { totalMass += (ELEMENT_PROPS[a.elem]?.mass || 0); });
    }
    document.getElementById("disp-mass").textContent = totalMass > 0 ? `${totalMass.toFixed(2)} g/mol` : "N/A";
    
    const subtitle = document.getElementById("viewport-subtitle");
    
    // --- é»ç¾¤è‡ªå‹•ç”Ÿæˆå™¨é‚è¼¯ ---
    const pgDisplay = document.getElementById("pg-group-display");
    const symList = document.getElementById("symmetry-elements-list");
    
    if (pgDisplay && symList) {
        const currentPg = data.pg;
        
        if (currentPg) {
            // å…§å»ºä¸‹æ¨™è½‰æ›ï¼Œé˜²æ­¢å ±éŒ¯
            const toSub = (n) => n.toString().split('').map(c => ({'0':'â‚€','1':'â‚','2':'â‚‚','3':'â‚ƒ','4':'â‚„','5':'â‚…','6':'â‚†','7':'â‚‡','8':'â‚ˆ','9':'â‚‰'}[c]||c)).join('');

            // 1. ã€æ ¸å¿ƒä¿®æ­£ã€‘ç²¾ç¢ºè¨ˆç®—å¹¾ä½•é‡å¿ƒï¼Œç¢ºä¿å°ç¨±è»¸ä¸æœƒç§»ä½
            let tX = 0, tY = 0, tZ = 0, atomCount = 0;
            const realAtoms = data.atomsRaw ? data.atomsRaw.filter(a => !a.isElectron) : [];
            realAtoms.forEach(a => { tX += a.x; tY += a.y; tZ += a.z; atomCount++; });
            data.centroid = atomCount > 0 ? { x: tX/atomCount, y: tY/atomCount, z: tZ/atomCount } : { x:0, y:0, z:0 };

            // 2. é¡¯ç¤ºç¾åŒ–èˆ‡åˆå§‹åŒ–
            pgDisplay.textContent = `é»ç¾¤: ${currentPg.replace("inf", "âˆ")}`;
            data.symmetry = { group: currentPg, elements: [] };
            
            // ã€æ ¸å¿ƒä¿®æ­£ï¼šæ”¯æ´è™›ç·šåƒæ•¸ isDashedã€‘
            const addSym = (type, label, defaultVec, colorType = 'cyan', customKey = null, isDashed = false) => {
                let vec = defaultVec;
                if (data.symVectors && customKey && data.symVectors[customKey]) vec = data.symVectors[customKey];
                data.symmetry.elements.push({ 
                    type: type, 
                    label: label, 
                    v: vec, 
                    active: false, 
                    colorType: colorType,
                    isDashed: isDashed // æ–°å¢è™›ç·šæ¨™è¨˜
                });
            };

            const nMatch = currentPg.match(/\d+/);
            const n = nMatch ? parseInt(nMatch[0]) : 1;
            const isTShaped = data.shape && data.shape.includes("Tå‹");

            // --- 3. å…¨çƒé»ç¾¤å°ç¨±å…ƒç´ æ¨¡æ¿ (å®Œå…¨è¦†è“‹æ•™ç§‘æ›¸) ---
            
            // Cnv ç³»åˆ— (ä¾‹å¦‚ C2v, C3v)
            if (/^C\d+v$/.test(currentPg)) {
                let mainVec = isTShaped ? [1, 0, 0] : [0, 1, 0];
                addSym('axis', `1 Ã— C${toSub(n)} (ä¸»è»¸)`, mainVec, 'cyan', 'Cn');
                addSym('plane', `Ïƒáµ¥ (åˆ†å­é¢)`, [0, 0, 1], 'cyan', 'sv1');
                addSym('plane', `${n-1} Ã— Ïƒáµ¥ (é‰›ç›´é¢)`, (isTShaped ? [0, 1, 0] : [1, 0, 0]), 'pink', 'sv2');
            } 
            // Cnh ç³»åˆ— (ä¾‹å¦‚ C2h)
            else if (/^C\d+h$/.test(currentPg)) {
                addSym('axis', `1 Ã— C${toSub(n)} (ä¸»è»¸)`, [0, 1, 0], 'cyan', 'Cn');
                addSym('plane', `1 Ã— Ïƒâ‚• (æ°´å¹³é¢)`, [0, 1, 0], 'yellow', 'sh');
                if (n % 2 === 0) addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            }
            // Dnh ç³»åˆ— (ä¾‹å¦‚ D2h, D3h, D6h)
            else if (/^D\d+h$/.test(currentPg)) {
                addSym('axis', `1 Ã— C${toSub(n)} (ä¸»è»¸)`, [0, 0, 1], 'cyan', 'Cn');
                addSym('plane', `1 Ã— Ïƒâ‚• (æ°´å¹³é¢)`, [0, 0, 1], 'yellow', 'sh');
                addSym('axis', `${n} Ã— Câ‚‚ (å‰¯è»¸)`, [1, 0, 0], 'cyan', 'C2');
                addSym('plane', `${n} Ã— Ïƒáµ¥ (é‰›ç›´é¢)`, [0, 1, 0], 'pink', 'sv');
                if (n % 2 === 0) addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            }
            // Dnd ç³»åˆ— (ä¾‹å¦‚ D2d, D3d, D4d)
            else if (/^D\d+d$/.test(currentPg)) {
                addSym('axis', `1 Ã— C${toSub(n)} (ä¸»è»¸)`, [0, 0, 1], 'cyan', 'Cn');
                addSym('axis', `${n} Ã— Câ‚‚ (å‰¯è»¸)`, [1, 0, 0], 'cyan', 'C2');
                addSym('plane', `${n} Ã— Ïƒd (äºŒé¢é¡é¢)`, [1, 1, 0], 'pink', 'sd');
                // ã€æ•™ç§‘æ›¸è¦æ ¼ï¼šä¸ç•¶è»¸ Sn ç‚ºè™›ç·šã€‘
                addSym('axis', `1 Ã— S${toSub(2*n)} (ä¸ç•¶è»¸)`, [0, 0, 1], 'yellow', 'Sn', true);
                if (n % 2 !== 0) addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            }
            // Sn ç³»åˆ— (ä¾‹å¦‚ S4, S6)
            else if (/^S\d+$/.test(currentPg)) {
                addSym('axis', `1 Ã— S${toSub(n)} (ä¸ç•¶æ—‹è½‰è»¸)`, [0, 0, 1], 'yellow', 'Sn', true);
                if ((n / 2) % 2 !== 0) addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            }
            // Dn ç³»åˆ—
            else if (/^D\d+$/.test(currentPg)) {
                addSym('axis', `1 Ã— C${toSub(n)} (ä¸»è»¸)`, [0, 0, 1], 'cyan', 'Cn');
                addSym('axis', `${n} Ã— Câ‚‚ (å‰¯è»¸)`, [1, 0, 0], 'cyan', 'C2');
            }
            // Td (å››é¢é«”)
            else if (currentPg === "Td") {
                addSym('axis', '4 Ã— Câ‚ƒ (é ‚é»è»¸)', [1, 1, 1], 'cyan', 'C3');
                addSym('axis', '3 Ã— Câ‚‚ (å°é‚Šè»¸)', [1, 0, 0], 'cyan', 'C2');
                addSym('plane', '6 Ã— Ïƒd (å°è§’é¢)', [1, -1, 0], 'pink', 'sd');
            } 
            // Oh (å…«é¢é«”)
            else if (currentPg === "Oh") {
                addSym('axis', '3 Ã— Câ‚„ (ä¸»è»¸)', [1, 0, 0], 'cyan', 'C4');
                addSym('axis', '4 Ã— Câ‚ƒ (å°è§’è»¸)', [1, 1, 1], 'cyan', 'C3');
                addSym('plane', '3 Ã— Ïƒâ‚• (ä¸»è¦é¢)', [0, 0, 1], 'yellow', 'sh');
                addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            } 
            // ç·šæ€§åˆ†å­
            else if (currentPg === "Cinfv") {
                addSym('axis', 'Câˆ (åˆ†å­è»¸)', [1, 0, 0], 'cyan', 'Cinf');
                addSym('plane', 'âˆ Ã— Ïƒáµ¥ (é‰›ç›´é¢)', [0, 1, 0], 'pink', 'sv');
            } else if (currentPg === "Dinfh") {
                addSym('axis', 'Câˆ (åˆ†å­è»¸)', [1, 0, 0], 'cyan', 'Cinf');
                addSym('plane', '1 Ã— Ïƒâ‚• (ä¸­å¿ƒé¢)', [1, 0, 0], 'yellow', 'sh');
                addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            } else if (currentPg === "Cs") {
                addSym('plane', '1 Ã— Ïƒ (å°ç¨±é¢)', [0, 0, 1], 'cyan', 's');
            } else if (currentPg === "Ci") {
                addSym('center', 'åè½‰ä¸­å¿ƒ (i)', [0, 0, 0], 'cyan', 'i');
            }

            // 4. ã€æ›´æ–°é¸å–® UIã€‘
            symList.innerHTML = "";
            data.symmetry.elements.forEach(el => {
                const div = document.createElement("div");
                div.className = "variant-option";
                div.style.fontSize = "0.85rem";
                div.style.cursor = "pointer";
                const chk = document.createElement("input");
                chk.type = "checkbox";
                chk.checked = el.active; 
                chk.onchange = (e) => { el.active = e.target.checked; renderScene(); };
                const span = document.createElement("span");
                if (el.type === 'plane') {
                    const colorMap = { 'cyan': 'var(--accent-yellow)', 'pink': '#f472b6', 'yellow': '#facc15' };
                    span.style.color = colorMap[el.colorType];
                } else if (el.type === 'center') { 
                    span.style.color = "#facc15"; span.style.fontWeight = "bold"; 
                }
                const icon = el.type === 'axis' ? 'è»¸' : (el.type === 'center' ? 'é»' : 'é¢');
                span.textContent = ` [${icon}] ${el.label}`;
                div.appendChild(chk); div.appendChild(span);
                symList.appendChild(div);
            });
            
            // åŒæ­¥é‡å¿ƒèˆ‡å°ç¨±æ€§åˆ°ç•¶å‰åˆ†å­
            currentMolecule.centroid = data.centroid;
            currentMolecule.symmetry = data.symmetry;
        } else {
            pgDisplay.textContent = "é»ç¾¤: -";
            symList.innerHTML = '<div style="color: #888; font-size: 0.85rem; text-align: center;">æ­¤ç‰©è³ªæš«ç„¡å°ç¨±è³‡æ–™</div>';
            currentMolecule.symmetry = null;
            currentMolecule.centroid = { x: 0, y: 0, z: 0 };
        }
    }
    if(subtitle) subtitle.textContent = `${nameText} (${formulaText})`; 
    
    updateVariantUI(key, variantKey);
    checkReactionAvailable(key);
}

function processAtomsData(atomList, bondList, centerElem) {
    let processed = [];
    
    // 1. å»ºç«‹åŸå­åŸºæœ¬ç‰©ä»¶
    const atomObjects = atomList.map((a, index) => { 
        const props = ELEMENT_PROPS[a.elem] || { c3d: "#ccc", r3d: 20 };
        const finalRadius = (a.r !== undefined) ? a.r : props.r3d;
        return { ...a, color: props.c3d, r: finalRadius, type: 'atom', originalIndex: index };
    });

    // 2. è¨ˆç®—å±¬æ€§
    atomObjects.forEach((atomObj, idx) => {
        const calcLP = autoAssignLonePairs(atomObj, bondList, atomObjects);
        atomObj.calculatedLP = calcLP;
        
        let bondLines = 0;
        let isCoordinateReceiver = false; // [æ¨™è¨˜] æ˜¯å¦ç‚ºé…ä½éµçš„æ¥æ”¶ç«¯

        bondList.forEach(b => {
            if (b[0] === idx || b[1] === idx) {
                let type = b[2] || "single";
                
                // [é—œéµ] åˆ¤æ–·æ˜¯å¦ç‚ºé…ä½éµæ¥æ”¶ç«¯ (b[0] -> b[1])
                // è‹¥æˆ‘æ˜¯æ¥æ”¶ç«¯ (idx === b[1])ï¼Œæ¨™è¨˜èµ·ä¾†ï¼Œä½†éµæ•¸ç…§ç®— 1
                if (type === "coordinate" && b[1] === idx) {
                    isCoordinateReceiver = true;
                    bondLines += 1;
                } else if (type === "coordinate" && b[0] === idx) {
                    bondLines += 1; // æ–½äºˆç«¯ä¹Ÿç®— 1 æ ¹éµ
                } else {
                    // ä¸€èˆ¬å…±åƒ¹éµè¨ˆç®—
                    if (type.includes("triple")) bondLines += 3;
                    else if (type.includes("double")) bondLines += 2;
                    else bondLines += 1;
                }
            }
        });

        // å°‡æ¨™è¨˜å­˜å…¥ç‰©ä»¶ï¼Œçµ¦ generateElectronDots ä½¿ç”¨
        atomObj.isCoordinateReceiver = isCoordinateReceiver;

        const props = ELEMENT_PROPS[atomObj.elem];
        if (props) {
            const dots = (calcLP * 2) + (atomObj.radical ? 1 : 0);
            // æ­£å¸¸è¨ˆç®—å½¢å¼é›»è· (S->O çš„ O ç®—å‡ºä¾†æœƒæ˜¯ -1ï¼Œé€™æ˜¯å°çš„åŒ–å­¸å®šç¾©)
            atomObj.formalCharge = props.ve - dots - bondLines;
        } else {
            atomObj.formalCharge = 0;
        }
        
        processed.push(atomObj);
        
        if (ELEMENT_PROPS[atomObj.elem]) { 
            const electronDots = generateElectronDots(atomObj, idx, atomObjects, bondList);
            electronDots.forEach(dot => {
                processed.push(dot); 
            });
        }
    });
    return processed;
}

function updateVariantUI(key, activeVariant) {
    const rootData = MOLECULE_DB[key];
    variantSelector.innerHTML = ''; 
    
    // æ¸…é™¤æ‰€æœ‰èˆŠçš„ä¸»é¡Œ class
    variantSelector.classList.remove('acid-theme', 'resonance-theme', 'structure-theme');
    
    if (rootData.variants) {
        // Only show variants that share the same molecular formula as the base
        const allVariantKeys = Object.keys(rootData.variants);
        const baseFormula = ((rootData.fullKey || key).split('|')[0] || key).trim();
        const visibleVariantKeys = allVariantKeys.filter(vKey => {
            const vData = rootData.variants[vKey] || {};
            const vFormula = ((vData.fullKey || vKey).split('|')[0] || vKey).trim();
            return vFormula === baseFormula;
        });

        // If there's 0 or only 1 same-formula variant, do not show the selector
        if (visibleVariantKeys.length <= 1) {
            variantSelector.style.display = 'none';
            return;
        }

        variantSelector.style.display = 'block';

        // --- determine theme based on visible variants only ---
        const isResonance = visibleVariantKeys.some(vKey => vKey.includes("å…±æŒ¯") || vKey.includes("Resonance"));
        const isStructure = visibleVariantKeys.some(vKey => vKey.includes("æ™¶é«”") || vKey.includes("å †ç©") || vKey.includes("Crystal"));

        const hdr = document.createElement('div');
        hdr.className = 'variant-header';
        if (isResonance) {
            variantSelector.classList.add('resonance-theme');
            hdr.textContent = 'é¸æ“‡å…±æŒ¯çµæ§‹ (Resonance):';
        } else if (isStructure) {
            variantSelector.classList.add('structure-theme');
            hdr.textContent = 'é¸æ“‡çµæ§‹å±¤æ¬¡ (Structure):';
        } else {
            hdr.textContent = 'é¸æ“‡åŒåˆ†ç•°æ§‹ç‰©:';
        }
        variantSelector.appendChild(hdr);

        // Populate only visible variants (same formula)
        for (let vKey of visibleVariantKeys) {
            const div = document.createElement('div');
            div.className = 'variant-option';
            const radio = document.createElement('input');
            radio.type = 'radio'; radio.name = 'v';
            if (vKey === activeVariant) radio.checked = true;
            const span = document.createElement('span');
            const variantData = rootData.variants[vKey];
            const fullKeyString = variantData.fullKey || vKey;
            const parts = fullKeyString.split('|');
            let labelText = "";
            if (parts.length > 1) {
                labelText = parts[1].trim();
                span.textContent = ` ${labelText}`;
            } else {
                labelText = parts[0].trim();
                span.innerHTML = ` ${formatFormula(labelText)}`;
            }
            div.appendChild(radio); div.appendChild(span);
            div.addEventListener('click', () => loadMolecule(key, vKey));
            variantSelector.appendChild(div);
        }
    } else {
        variantSelector.style.display = 'none';
    }
}



// ==========================================
// 4. æ¸²æŸ“å¼•æ“
// ==========================================

function project(p) {
    const m = currentMatrix;
    let x3 = p.x * m[0] + p.y * m[1] + p.z * m[2];
    let y3 = p.x * m[3] + p.y * m[4] + p.z * m[5];
    let z3 = p.x * m[6] + p.y * m[7] + p.z * m[8];
    
    let s = (600 / (600 - Math.min(z3, 590))) * scale;
    return { x: x3 * s + panOffset.x, y: y3 * s + panOffset.y, z: z3, scale: s };
}

function renderScene(time = 0) {
    sceneRoot.innerHTML = "";
    if(!currentMolecule) return;
    
    // --- 1. å®šç¾©æ¿¾é¡èˆ‡æ¼¸å±¤ ---
    const defs = document.createElementNS("http://www.w3.org/2000/svg", "defs");
    // Light-mode flag: used to darken very-light visuals for contrast on white background
    const isLight = document.body && document.body.classList && document.body.classList.contains('light-mode');
    // ç™¼å…‰æ¿¾é¡
    const boxGlowFilter = document.createElementNS("http://www.w3.org/2000/svg", "filter");
    boxGlowFilter.setAttribute("id", "box-glow");
    boxGlowFilter.innerHTML = `<feGaussianBlur stdDeviation="1.5" result="coloredBlur"/><feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>`;
    defs.appendChild(boxGlowFilter);

    // åŸå­ç«‹é«”æ¼¸å±¤
    const usedColors = new Set();
    currentMolecule.renderObjects.forEach(obj => { if (obj.type === 'atom') usedColors.add(obj.color); });
    usedColors.forEach(color => {
        const cleanColor = (color || '#000000').replace('#','');
        const atomGrad = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
        atomGrad.setAttribute("id", `atom-grad-${cleanColor}`);
        atomGrad.setAttribute("cx", "35%"); atomGrad.setAttribute("cy", "35%"); atomGrad.setAttribute("r", "60%");
        // In light mode, slightly darken very-light element colors so they remain visible on white
        const baseColor = isLight ? adjustColor(color, -30) : color;
        const highlight = isLight ? "#ffffff" : "#FFFFFF"; // keep highlight bright for vibrant atoms
        const shadowColor = adjustColor(baseColor, -30);
        atomGrad.innerHTML = `<stop offset="0%" stop-color="${highlight}" stop-opacity="0.95"/><stop offset="40%" stop-color="${baseColor}" stop-opacity="1"/><stop offset="100%" stop-color="${shadowColor}" stop-opacity="1"/>`;
        defs.appendChild(atomGrad);
    });

    // ã€é‡è¦ä¿®æ­£ã€‘ç¢ºä¿é‡‘è‰²æ¼¸å±¤å®šç¾©åœ¨æ¯ä¸€å¹€éƒ½å­˜åœ¨
    const goldGrad = document.createElementNS("http://www.w3.org/2000/svg", "linearGradient");
    goldGrad.setAttribute("id", "grad-hyper-gold");
    goldGrad.setAttribute("x1", "0%"); goldGrad.setAttribute("y1", "0%"); goldGrad.setAttribute("x2", "100%"); goldGrad.setAttribute("y2", "0%");
    goldGrad.innerHTML = `<stop offset="0%" stop-color="#bf953f"/><stop offset="25%" stop-color="#fcf6ba"/><stop offset="50%" stop-color="#b38728"/><stop offset="75%" stop-color="#fbf5b7"/><stop offset="100%" stop-color="#aa771c"/>`;
    defs.appendChild(goldGrad);
    
    // å…¶é¤˜å…‰æšˆå®šç¾© (ä¿æŒåŸæ¨£)
    const highlightGlowCenter = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    highlightGlowCenter.setAttribute("id", "highlight-glow-center");
    highlightGlowCenter.setAttribute("cx", "50%"); highlightGlowCenter.setAttribute("cy", "50%"); highlightGlowCenter.setAttribute("r", "50%");
    highlightGlowCenter.innerHTML = `<stop offset="0%" stop-color="#facc15" stop-opacity="0.6"/><stop offset="100%" stop-color="#facc15" stop-opacity="0"/>`;
    defs.appendChild(highlightGlowCenter);
    const highlightGlowNeighbor = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    highlightGlowNeighbor.setAttribute("id", "highlight-glow-neighbor");
    highlightGlowNeighbor.setAttribute("cx", "50%"); highlightGlowNeighbor.setAttribute("cy", "50%"); highlightGlowNeighbor.setAttribute("r", "50%");
    highlightGlowNeighbor.innerHTML = `<stop offset="0%" stop-color="#ffffff" stop-opacity="0.4"/><stop offset="100%" stop-color="#ffffff" stop-opacity="0"/>`;
    defs.appendChild(highlightGlowNeighbor);
    const chargeGlow = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    chargeGlow.setAttribute("id", "charge-glow-pink");
    chargeGlow.setAttribute("cx", "50%"); chargeGlow.setAttribute("cy", "50%"); chargeGlow.setAttribute("r", "50%");
    chargeGlow.innerHTML = `<stop offset="0%" stop-color="#ffffff" stop-opacity="1"/><stop offset="40%" stop-color="#f472b6" stop-opacity="0.9"/><stop offset="100%" stop-color="#ec4899" stop-opacity="0"/>`;
    defs.appendChild(chargeGlow);
    const orbGradP = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    orbGradP.setAttribute("id", "grad-orb-p");
    orbGradP.setAttribute("cx", "30%"); orbGradP.setAttribute("cy", "30%"); orbGradP.setAttribute("r", "80%");
    orbGradP.innerHTML = `<stop offset="0%" stop-color="#34D399" stop-opacity="0.95"/><stop offset="60%" stop-color="#059669" stop-opacity="0.9"/><stop offset="100%" stop-color="#064E3B" stop-opacity="0.9"/>`;
    defs.appendChild(orbGradP);
    const orbGradD = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    orbGradD.setAttribute("id", "grad-orb-d");
    orbGradD.setAttribute("cx", "30%"); orbGradD.setAttribute("cy", "30%"); orbGradD.setAttribute("r", "80%");
    orbGradD.innerHTML = `<stop offset="0%" stop-color="#FBBF24" stop-opacity="0.95"/><stop offset="60%" stop-color="#D97706" stop-opacity="0.9"/><stop offset="100%" stop-color="#78350F" stop-opacity="0.9"/>`;
    defs.appendChild(orbGradD);

    sceneRoot.appendChild(defs);

    // --- 2. æŠ•å½±èˆ‡ç‰©ä»¶æ”¶é›† ---
    const showLPs = document.getElementById('toggle-lp') ? document.getElementById('toggle-lp').checked : true;
    const isAnyHighlighted = currentMolecule.renderObjects.some(o => o.isHighlighted);
    const renderList = [];
    const atomMap = new Map();
    const atomPosList = [];

    currentMolecule.renderObjects.forEach((obj, i) => {
        if (obj.isLobe) {
            const pStart = project(obj); const pEnd = project(obj.end);
            renderList.push({ type: 'lobe', z: (pStart.z + pEnd.z)/2, pStart, pEnd, colorType: obj.colorType, scale: pStart.scale });
            return;
        }
        if (obj.isAxis) {
            const pStart = project(obj); const pEnd = project(obj.end);
            renderList.push({ type: 'axisVector', z: (pStart.z + pEnd.z)/2, pStart, pEnd, label: obj.label, scale: pStart.scale });
            return;
        }
        if (obj.type === 'electron' && !showLPs) return;

        const p = project(obj);
        let alpha = 1.0;
        if (isAnyHighlighted) {
            if (obj.type === 'atom') alpha = obj.isHighlighted ? 1.0 : 0.1;
            else if (obj.type === 'electron') alpha = obj.parentAtom && obj.parentAtom.isHighlighted ? 1.0 : 0.1;
        }
        const renderObj = { ...obj, px: p.x, py: p.y, pz: p.z, scale: p.scale, idx: i, alpha: alpha, z: p.z };
        renderList.push(renderObj);
        if (obj.type === 'atom') {
            atomMap.set(obj.originalIndex, renderObj);
            atomPosList.push({ x: obj.x, y: obj.y, z: obj.z, r: obj.r });
        }
    });

    if (customFaces.length > 0) {
        customFaces.forEach(faceIndices => {
            const nodes = faceIndices.map(idx => atomMap.get(idx)).filter(n => n);
            if (nodes.length === 3) {
                const avgZ = (nodes[0].z + nodes[1].z + nodes[2].z) / 3;
                renderList.push({ type: 'polyFace', z: avgZ, nodes: nodes, colorType: faceIndices[3] || 'yellow', alpha: isAnyHighlighted ? 0.1 : 1.0 });
            }
        });
    }

    if (currentMolecule.extraLines) {
        currentMolecule.extraLines.forEach(line => {
            const pStart = project(line.start); const pEnd = project(line.end);
            const avgZ = (pStart.z + pEnd.z) / 2;
            let alpha = isAnyHighlighted ? 0.1 : 1.0;
            const findAtomR = (pt) => {
                const match = atomPosList.find(a => Math.abs(a.x - pt.x) < 2 && Math.abs(a.y - pt.y) < 2 && Math.abs(a.z - pt.z) < 2);
                return match ? match.r : 0;
            };
            renderList.push({ type: "boxLine", z: avgZ, x1: pStart.x, y1: pStart.y, x2: pEnd.x, y2: pEnd.y, scale: (pStart.scale + pEnd.scale) / 2, r1: findAtomR(line.start), r2: findAtomR(line.end), alpha: alpha });
        });
    }

    if (currentMolecule.bonds3D) {
        currentMolecule.bonds3D.forEach((bond, index) => { 
            const idx1 = bond[0]; const idx2 = bond[1];
            const a1 = atomMap.get(idx1); const a2 = atomMap.get(idx2);
            if (!a1 || !a2) return; 
            let drawStyle = bond[2] || "single";
            let bondAlpha = 1.0;
            if (isAnyHighlighted) {
                const connectedToCenter = (a1.isHighlighted==='center' && a2.isHighlighted==='neighbor') || (a2.isHighlighted==='center' && a1.isHighlighted==='neighbor');
                if (!connectedToCenter) bondAlpha = 0.05;
            }
            renderList.push({ type: "bond", z: (a1.pz + a2.pz) / 2, x1: a1.px, y1: a1.py, x2: a2.px, y2: a2.py, r1: a1.r * a1.scale, r2: a2.r * a2.scale, style: drawStyle, scale: (a1.scale + a2.scale) / 2, c1: a1.color, c2: a2.color, bondIdx: index, opacity: 1, alpha: bondAlpha });
        });
    }

    // CC (é»ç¾¤å°ç¨±å…ƒç´ æ¸²æŸ“å€å¡Šï¼šé‡å¿ƒå°é½Šç‰ˆ)
    if (currentMolecule.symmetry && currentMolecule.symmetry.elements) {
        // å–å¾—ç•¶å‰åˆ†å­çš„é‡å¿ƒï¼Œè‹¥ç„¡å‰‡é è¨­ç‚ºåŸé»
        const mCentroid = currentMolecule.centroid || { x: 0, y: 0, z: 0 };
        
        currentMolecule.symmetry.elements.forEach(el => {
            if (!el.active || !el.v) return;
            try {
                if (el.type === 'axis') {
                    const len = 110; // è»¸çš„è¦–è¦ºé•·åº¦
                    // å‘é‡æ­£è¦åŒ–ï¼Œç¢ºä¿ä¸åŒè§’åº¦é•·åº¦ä¸€è‡´
                    const rawLen = Math.sqrt(el.v[0]**2 + el.v[1]**2 + el.v[2]**2);
                    const vLen = rawLen < 0.001 ? 1 : rawLen;
                    const nx = el.v[0] / vLen, ny = el.v[1] / vLen, nz = el.v[2] / vLen;

                    // å¾åˆ†å­é‡å¿ƒå‡ºç™¼å»¶ä¼¸
                    const p1 = project({ x: mCentroid.x + nx * len, y: mCentroid.y + ny * len, z: mCentroid.z + nz * len });
                    const p2 = project({ x: mCentroid.x - nx * len, y: mCentroid.y - ny * len, z: mCentroid.z - nz * len });
                    
                    renderList.push({ 
                        type: 'axisVector', z: (p1.z + p2.z)/2, pStart: p1, pEnd: p2, 
                        label: el.label, scale: p1.scale, 
                        customColor: "url(#grad-hyper-gold)", labelColor: "#facc15" 
                    });
                } else if (el.type === 'center') {
                    // åè½‰ä¸­å¿ƒ (i) ç›´æ¥å®šä½åœ¨é‡å¿ƒ
                    const p = project({ x: mCentroid.x, y: mCentroid.y, z: mCentroid.z });
                    renderList.push({
                        type: 'atom', z: p.z, px: p.x, py: p.y, scale: p.scale,
                        r: 6, color: "#facc15", elem: "i", isHighlighted: "center"
                    });
                } else if (el.type === 'plane') {
                    const s = 80; // å¹³é¢å°ºå¯¸
                    let v1 = [0, 1, 0], v2 = [0, 0, 1];
                    // è¨ˆç®—å‚ç›´æ–¼ el.v çš„å¹³é¢åŸºåº•å‘é‡
                    if (Math.abs(el.v[0]) < 0.9) { 
                        v1 = [1, 0, 0]; 
                        v2 = [0, el.v[2], -el.v[1]]; 
                    }
                    
                    // æ ¹æ“šåŸºåº•å‘é‡ç”Ÿæˆå¹³é¢çš„å››å€‹é ‚é»ï¼Œä¸¦åŠ ä¸Šé‡å¿ƒä½ç§»
                    const pts = [
                        {x: mCentroid.x + (v1[0]+v2[0])*s, y: mCentroid.y + (v1[1]+v2[1])*s, z: mCentroid.z + (v1[2]+v2[2])*s},
                        {x: mCentroid.x + (v1[0]-v2[0])*s, y: mCentroid.y + (v1[1]-v2[1])*s, z: mCentroid.z + (v1[2]-v2[2])*s},
                        {x: mCentroid.x + (-v1[0]-v2[0])*s, y: mCentroid.y + (-v1[1]-v2[1])*s, z: mCentroid.z + (-v1[2]-v2[2])*s},
                        {x: mCentroid.x + (-v1[0]+v2[0])*s, y: mCentroid.y + (-v1[1]+v2[1])*s, z: mCentroid.z + (-v1[2]+v2[2])*s}
                    ];
                    const proj = pts.map(p => project(p));
                    renderList.push({ 
                        type: 'polyFace', 
                        z: proj.reduce((sum, p) => sum + p.z, 0) / 4, 
                        nodes: proj.map(p => ({ px: p.x, py: p.y })), 
                        colorType: el.colorType || 'cyan' 
                    });
                }
            } catch (err) { console.error("å°ç¨±å…ƒç´ æŠ•å½±å¤±æ•—:", err); }
        });
    }

    // --- 4. æ’åºä¸¦ç¹ªè£½ ---
    renderList.sort((a,b) => (a.z - b.z)).forEach(obj => {
        if (obj.type === "bond") drawBond(obj);
        else if (obj.type === "atom") drawAtom(obj);
        else if (obj.type === "lobe") drawLobe(obj);
        else if (obj.type === "axisVector") drawAxisVector(obj);
        else if (obj.type === "electron") drawElectron(obj);
        else if (obj.type === "boxLine") drawBoxLine(obj);
        else if (obj.type === "polyFace") {
            const poly = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            poly.setAttribute("points", obj.nodes.map(n => `${n.px},${n.py}`).join(" "));
            // ã€é‡è¦ä¿®æ­£ã€‘é¡è‰²å°ç…§è¡¨å¿…é ˆå®šç¾©åœ¨æ¸²æŸ“ç•¶ä¸‹
            const symmetryColors = {
                'yellow': { f: "rgba(253, 224, 71, 0.2)", s: "rgba(253, 224, 71, 0.9)" },
                'cyan':   { f: "rgba(34, 211, 238, 0.2)", s: "rgba(34, 211, 238, 0.9)" },
                'pink':   { f: "rgba(244, 114, 182, 0.2)", s: "rgba(244, 114, 182, 0.9)" }
            };
            const config = symmetryColors[obj.colorType] || symmetryColors.cyan;
            poly.setAttribute("fill", config.f); poly.setAttribute("stroke", config.s);
            poly.setAttribute("stroke-width", "3"); poly.setAttribute("opacity", "1.0");
            sceneRoot.appendChild(poly);
        }
    });
}

function drawBoxLine(l) {
    let x1 = l.x1, y1 = l.y1, x2 = l.x2, y2 = l.y2;
    
    const dx = x2 - x1;
    const dy = y2 - y1;
    const len = Math.sqrt(dx*dx + dy*dy);
    
    if (len > 0) {
        const nx = dx / len;
        const ny = dy / len;

        // æˆªæ–·é‚è¼¯
        const cut1 = (l.r1 || 0) * l.scale * 0.95;
        const cut2 = (l.r2 || 0) * l.scale * 0.95;

        if (len > (cut1 + cut2)) {
            x1 = x1 + nx * cut1;
            y1 = y1 + ny * cut1;
            x2 = x2 - nx * cut2;
            y2 = y2 - ny * cut2;
        } else {
            return;
        }
    }

    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", x1); line.setAttribute("y1", y1);
    line.setAttribute("x2", x2); line.setAttribute("y2", y2);
    
    // [è¨­å®šï¼šç™½è‰²ç²—æ¡†]
    line.setAttribute("stroke", "#ffffff"); 
    line.setAttribute("stroke-width", "5"); 
    line.setAttribute("stroke-linecap", "round");
    
    if (!isMobile) {
        line.setAttribute("filter", "url(#box-glow)"); 
    }
    
    line.setAttribute("opacity", l.alpha === 0.1 ? "0.1" : "0.9"); 
    
    sceneRoot.appendChild(line);
}

// 2. ç¹ªè£½åŸå­é€£ç·š (ç´°ç™½ç·š + æˆªæ–·)
function drawBond(b) {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    const isLight = document.body && document.body.classList && document.body.classList.contains('light-mode');

    // ============================================================
    // [å€å¡Š 1] NaCl / é›¢å­æ™¶é«”å°ˆç”¨ç¹ªåœ–é‚è¼¯ (å¤–é‡‘å±¬æ¡† + å…§ç™¼å…‰ç´°ç·š)
    // ============================================================
    if (b.style === "ionic_thick" || b.style === "ionic_thin") {
        const dx = b.x2 - b.x1, dy = b.y2 - b.y1, len = Math.sqrt(dx*dx + dy*dy);
        if(len === 0) return;
        
        // è¨ˆç®—æˆªæ–·é»ï¼Œè®“ç·šæ¢è²¼é½ŠåŸå­è¡¨é¢
        const nx = dx / len, ny = dy / len;
        const off1 = b.r1 * 0.9, off2 = b.r2 * 0.9; 
        
        if (len > (off1 + off2)) {
            const l = document.createElementNS("http://www.w3.org/2000/svg", "line");
            l.setAttribute("x1", b.x1 + nx * off1);
            l.setAttribute("y1", b.y1 + ny * off1);
            l.setAttribute("x2", b.x2 - nx * off2);
            l.setAttribute("y2", b.y2 - ny * off2);
            
            // 1. è‡ªå‹•æ³¨å…¥ã€Œé«˜è³ªæ„Ÿé‡‘å±¬æ¼¸å±¤ã€ (å¦‚æœé‚„æ²’å»ºç«‹é)
            const gradID = "grad-hyper-metal";
            if (!document.getElementById(gradID)) {
                const defs = document.querySelector("defs") || sceneRoot;
                const grad = document.createElementNS("http://www.w3.org/2000/svg", "linearGradient");
                grad.setAttribute("id", gradID);
                grad.setAttribute("x1", "0%"); grad.setAttribute("y1", "0%");
                grad.setAttribute("x2", "100%"); grad.setAttribute("y2", "0%"); 
                grad.innerHTML = `
                    <stop offset="0%" stop-color="#475569"/>
                    <stop offset="30%" stop-color="#cbd5e1"/>
                    <stop offset="50%" stop-color="#ffffff"/>
                    <stop offset="70%" stop-color="#cbd5e1"/>
                    <stop offset="100%" stop-color="#475569"/>
                `;
                defs.appendChild(grad);
            }

            // 2. æ¨£å¼èˆ‡æ¿¾é¡è¨­å®š
            let baseOpacity = 1.0;

            if (b.style === "ionic_thick") {
                // --- å¤–æ¡† (ç²—é‡‘å±¬) ---
                l.setAttribute("stroke", `url(#${gradID})`); 
                l.setAttribute("stroke-width", 12 * b.scale); 
                baseOpacity = 1.0; 
            } else {
                // --- å…§éƒ¨ (æœ¦æœ§ç™¼å…‰ç·š) ---
                l.setAttribute("stroke", "#ffffff");      
                l.setAttribute("stroke-width", 4.0 * b.scale); 
                
                // [é—œéµä¿®æ”¹] ç§»é™¤ !isMobile åˆ¤æ–·ï¼Œå¼·åˆ¶æ‰€æœ‰è£ç½®éƒ½å¥—ç”¨ç™¼å…‰æ¿¾é¡
                // é€™æ¨£æ‰‹æ©Ÿç‰ˆä¹Ÿèƒ½çœ‹åˆ°æ¼‚äº®çš„ç™¼å…‰æ•ˆæœ
                l.setAttribute("filter", "url(#soft-glow)");

                baseOpacity = 0.6; // åŠé€æ˜
            }
            l.setAttribute("stroke-linecap", "round");

            // 3. äº’å‹•é‚è¼¯ (é»æ“Šä¸­å¿ƒæ™‚çš„æ·¡å‡ºæ•ˆæœ)
            let finalOpacity = baseOpacity; 
            if (b.alpha < 0.9) {
                finalOpacity = 0.05; 
            }
            l.setAttribute("opacity", finalOpacity);

            g.appendChild(l);
        }
        sceneRoot.appendChild(g);
        return; // æ™¶é«”ç¹ªè£½å®Œç•¢ï¼Œç›´æ¥è¿”å›
    }

    // ============================================================
    // [å€å¡Š 2] ä¸€èˆ¬å…±åƒ¹éµèˆ‡èˆŠç‰ˆé‡‘å±¬ (ä¿æŒåŸæ¨£ä¸å‹•)
    // ============================================================
    
    // æ‡‰ç”¨é€æ˜åº¦ (å…±ç”¨)
    if (b.alpha < 1.0) g.setAttribute("opacity", b.alpha);

    // A. èˆŠç‰ˆé‡‘å±¬/ç°¡å–®é›¢å­æ™¶é«”é‚è¼¯
    if (currentMolecule && (currentMolecule.isMetal || (currentMolecule.isIonic && !b.style))) {
        const dx = b.x2 - b.x1;
        const dy = b.y2 - b.y1;
        const len = Math.sqrt(dx*dx + dy*dy);
        if(len > 0) { // åŸæœ¬é‚è¼¯æœ‰åš len > 0 åˆ¤æ–·ï¼Œé€™è£¡æ•´åˆ
            const nx = dx / len;
            const ny = dy / len;
            // é€™è£¡ä½¿ç”¨ 0.95 çš„æˆªæ–·ä¿‚æ•¸ï¼Œèˆ‡ä¸Šé¢æ™¶é«”ä¸åŒï¼Œä¿æŒåŸæ¨£
            const l = document.createElementNS("http://www.w3.org/2000/svg", "line");
            l.setAttribute("x1", b.x1 + nx * b.r1 * 0.95); 
            l.setAttribute("y1", b.y1 + ny * b.r1 * 0.95);
            l.setAttribute("x2", b.x2 - nx * b.r2 * 0.95); 
            l.setAttribute("y2", b.y2 - ny * b.r2 * 0.95);
            l.setAttribute("stroke", "#9ca3af"); 
            l.setAttribute("stroke-width", "4"); 
            l.setAttribute("stroke-linecap", "round");
            l.setAttribute("opacity", b.alpha < 1.0 ? 0.05 : 0.6); 
            g.appendChild(l);
        }
        sceneRoot.appendChild(g);
        return; 
    }

    // B. ä¸€èˆ¬å…±åƒ¹éµ (æ¼¸å±¤ã€å¤šé‡éµ)
    const dxMol = b.x2-b.x1, dyMol = b.y2-b.y1, lenMol = Math.sqrt(dxMol*dxMol+dyMol*dyMol);
    if(lenMol === 0) return;
    const nxMol = dxMol/lenMol, nyMol = dyMol/lenMol;
    const px = -nyMol, py = nxMol;
    const w = 16 * b.scale; const strokeW = w * 0.45; const shorten = 0.75;      
    const x1 = b.x1 + nxMol * b.r1 * shorten; const y1 = b.y1 + nyMol * b.r1 * shorten;
    const x2 = b.x2 - nxMol * b.r2 * shorten; const y2 = b.y2 - nyMol * b.r2 * shorten;
    
    let strokeColor;
        if (b.style === "coordinate") strokeColor = b.c1; 
    else {
        const gradId = `bond-grad-${b.bondIdx}`;
        const defs = sceneRoot.querySelector("defs");
        const grad = document.createElementNS("http://www.w3.org/2000/svg", "linearGradient");
        grad.setAttribute("id", gradId); grad.setAttribute("gradientUnits", "userSpaceOnUse");
        grad.setAttribute("x1", x1); grad.setAttribute("y1", y1); grad.setAttribute("x2", x2); grad.setAttribute("y2", y2);
        // Darken bond end colors in light mode to keep contrast against white viewport
        const c1 = isLight ? adjustColor(b.c1 || '#999999', -30) : (b.c1 || '#999999');
        const c2 = isLight ? adjustColor(b.c2 || '#666666', -30) : (b.c2 || '#666666');
        grad.innerHTML = `<stop offset="0%" stop-color="${c1}"/><stop offset="40%" stop-color="${c1}"/><stop offset="60%" stop-color="${c2}"/><stop offset="100%" stop-color="${c2}"/>`;
        defs.appendChild(grad);
        strokeColor = `url(#${gradId})`;
    }
    
    const drawLine = (ox, oy, width, color, opacity=1) => {
        const l = document.createElementNS("http://www.w3.org/2000/svg", "line");
        l.setAttribute("x1", x1+ox); l.setAttribute("y1", y1+oy); l.setAttribute("x2", x2+ox); l.setAttribute("y2", y2+oy);
        l.setAttribute("stroke", color); l.setAttribute("stroke-width", width); l.setAttribute("stroke-linecap", "round");
        const finalOp = opacity * (b.opacity || 1); 
        if(finalOp < 1) l.setAttribute("opacity", finalOp);
        return l;
    };
    const drawCylinder = (ox, oy) => {
        g.appendChild(drawLine(ox, oy, strokeW, strokeColor));
        g.appendChild(drawLine(ox, oy, strokeW * 0.25, "#ffffff", 0.5));
    };
    
    if (b.style === "double") { const off = w * 0.38; drawCylinder(px*off, py*off); drawCylinder(-px*off, -py*off); } 
    else if (b.style === "triple") { const off = w * 0.75; drawCylinder(0, 0); drawCylinder(px*off, py*off); drawCylinder(-px*off, -py*off); } 
    else if (b.style === "coordinate_triple") { const off = w * 0.75; drawCylinder(0, 0); drawCylinder(px*off, py*off); g.appendChild(drawLine(-px*off, -py*off, strokeW, strokeColor)); } 
    else { drawCylinder(0, 0); }
    
    sceneRoot.appendChild(g);
}

function drawAtom(a) {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    g.setAttribute("data-atom-idx", a.idx); 
    
    if (a.alpha < 1.0) g.setAttribute("opacity", a.alpha);

    // é»æ“Šé«˜äº®
    if (a.isHighlighted) {
        const glowId = a.isHighlighted === "center" ? "highlight-glow-center" : "highlight-glow-neighbor";
        const halo = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        halo.setAttribute("cx", a.px); halo.setAttribute("cy", a.py);
        halo.setAttribute("r", a.r * a.scale * 2.5); 
        halo.setAttribute("fill", `url(#${glowId})`);
        g.appendChild(halo);
    }

    if (isPlasmaMode) {
        // [ä¿®æ­£] æ‰‹æ©Ÿç‰ˆé›»æ¼¿ä¿®å¾©ï¼šå¼·åˆ¶ä½¿ç”¨æ¨™æº–æ¿¾é¡
        g.setAttribute("style", "mix-blend-mode: screen;"); 
        const baseR = a.r * a.scale;
        
        // æ ¸å¿ƒ
        const gasCloud = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        gasCloud.setAttribute("cx", a.px); gasCloud.setAttribute("cy", a.py);
        gasCloud.setAttribute("r", baseR * 1.6); 
        // é€™è£¡éœ€è¦ç¢ºä¿ plasma-grad- å­˜åœ¨ï¼Œå¦‚æœæ²’æœ‰å®šç¾©ï¼Œå›é€€åˆ°å–®è‰²
        // å»ºè­°ç›´æ¥ç”¨ atom-grad ä»¥ç¢ºä¿æœ‰é¡è‰²
        gasCloud.setAttribute("fill", `url(#atom-grad-${a.color.replace('#','')})`);
        gasCloud.setAttribute("filter", "url(#soft-glow)"); // åŠ ä¸Šå…‰æšˆ
        g.appendChild(gasCloud);

        const txt = document.createElementNS("http://www.w3.org/2000/svg", "text");
        txt.setAttribute("x", a.px); txt.setAttribute("y", a.py);
        txt.setAttribute("font-size", baseR * 0.85); 
        txt.setAttribute("class", "atom-label-text");
        txt.style.textShadow = "0 0 3px #000, 0 0 5px #000"; 
        txt.style.fill = "#fff";
        txt.textContent = a.elem;
        g.appendChild(txt);

    } else {
        const useGlow = window.isGlowOn;
        
        if (useGlow) {
            const glow = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            glow.setAttribute("cx", a.px); glow.setAttribute("cy", a.py); 
            
            // [é—œéµä¿®æ­£] ç§»é™¤æ‰‹æ©Ÿç‰ˆ mobile-glow åˆ†æ”¯ï¼Œçµ±ä¸€ä½¿ç”¨é›»è…¦ç‰ˆé‚è¼¯
            glow.setAttribute("r", a.r * a.scale * 1.3); 
            glow.setAttribute("fill", a.color); 
            glow.setAttribute("opacity", "0.36");
            glow.setAttribute("filter", "url(#soft-glow)"); // æ‰‹æ©Ÿç¾åœ¨ä¹Ÿè·‘é€™å€‹
            
            g.appendChild(glow);
        }

        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        circle.setAttribute("cx", a.px); circle.setAttribute("cy", a.py); 
        circle.setAttribute("r", a.r * a.scale); 
        circle.setAttribute("fill", `url(#atom-grad-${a.color.replace('#','')})`); 
        
        const txt = document.createElementNS("http://www.w3.org/2000/svg", "text");
        txt.setAttribute("x", a.px); txt.setAttribute("y", a.py); 
        txt.setAttribute("font-size", a.r * 0.75 * a.scale); 
        txt.setAttribute("class", "atom-label-text"); 
        txt.textContent = a.elem;
        
        g.appendChild(circle); g.appendChild(txt);
    }
    
    sceneRoot.appendChild(g);
}

// ========== [è«‹æ›¿æ› drawElectron] ==========
function drawElectron(e) {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    const r = e.r * e.scale;
    
    let coreColor = "#ffffff";
    let glowFill = "#ffffff";
    let glowOpacity = "0.28";
    const isLight = document.body && document.body.classList && document.body.classList.contains('light-mode');
    if (isLight) {
        // Force electrons to be dark/black in light mode for visibility on white background
        coreColor = "#000000";
        glowFill = "#000000";
        glowOpacity = "0.42";
    }
    
    if (e.isNegativeCharge) {
        // keep negative-charge highlight when not in light mode; in light mode prefer black for contrast
        if (!isLight) {
            coreColor = "#ff9efa"; 
            glowFill = "#ff9efa"; 
            glowOpacity = "0.5"; 
        }
    }

    if (isPlasmaMode) {
        g.setAttribute("style", "mix-blend-mode: screen;"); 
        const halo = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        halo.setAttribute("cx", e.px); halo.setAttribute("cy", e.py);
        halo.setAttribute("r", r * (e.isNegativeCharge ? 3.0 : 2.0)); 
        halo.setAttribute("fill", glowFill);
        halo.setAttribute("opacity", "0.6");
        halo.setAttribute("filter", "url(#soft-glow)"); // [ä¿®æ­£] å¼·åˆ¶åŠ æ¿¾é¡
        g.appendChild(halo);

        const core = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        core.setAttribute("cx", e.px); core.setAttribute("cy", e.py);
        core.setAttribute("r", r * 1.0);
        core.setAttribute("fill", coreColor);
        core.setAttribute("class", "electron-spark"); 
        g.appendChild(core);

    } else {
        const useGlow = window.isGlowOn;
        if (useGlow) {
            const glow = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            glow.setAttribute("cx", e.px); glow.setAttribute("cy", e.py); 
            
            // [é—œéµä¿®æ­£] ç§»é™¤æ‰‹æ©Ÿç‰¹åˆ¤ï¼Œå¼·åˆ¶çµ±ä¸€
            glow.setAttribute("r", r * 2.0); 
            glow.setAttribute("fill", glowFill);
            glow.setAttribute("opacity", glowOpacity);
            glow.setAttribute("filter", "url(#soft-glow)"); 
            
            g.appendChild(glow);
        }

        const c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        c.setAttribute("cx", e.px); c.setAttribute("cy", e.py); c.setAttribute("r", r);
        c.setAttribute("fill", coreColor); 
        c.setAttribute("opacity", "0.95");
        g.appendChild(c);
    }
    
    sceneRoot.appendChild(g);
}

function adjustColor(col, amt) {
    let usePound = false;
    if (col[0] == "#") { col = col.slice(1); usePound = true; }
    let num = parseInt(col,16);
    let r = (num >> 16) + amt; if (r > 255) r = 255; else if  (r < 0) r = 0;
    let b = ((num >> 8) & 0x00FF) + amt; if (b > 255) b = 255; else if  (b < 0) b = 0;
    let g = (num & 0x0000FF) + amt; if (g > 255) g = 255; else if (g < 0) g = 0;
    return (usePound?"#":"") + (g | (b << 8) | (r << 16)).toString(16).padStart(6,'0');
}

function animate() {
    const time = performance.now(); 
    if (!isDragging && !isReactionRunning && !isLongPressActive) {
        rotVelocity.x *= 0.96; rotVelocity.y *= 0.96; rotVelocity.z *= 0.96;
        let speed = Math.sqrt(rotVelocity.x*rotVelocity.x + rotVelocity.y*rotVelocity.y + rotVelocity.z*rotVelocity.z);
        const MIN_SPEED = 0.004; 
        const autoRotateEl = document.getElementById('toggle-auto-rotate');
        const isAutoRotateOn = autoRotateEl ? autoRotateEl.checked : true;

        if (speed > 0.00001) { 
            if (speed < MIN_SPEED) {
                if (isAutoRotateOn) {
                    let scaleFactor = MIN_SPEED / speed;
                    rotVelocity.x *= scaleFactor; rotVelocity.y *= scaleFactor; rotVelocity.z *= scaleFactor;
                }
            }
            applyRotation(rotVelocity.y, rotVelocity.x, rotVelocity.z);
        } else {
            if (isAutoRotateOn) applyRotation(0.004, 0, 0); 
        }
    }
    renderScene(time);
    requestAnimationFrame(animate);
}

function setupInteractions() {
    // Balance UI removed â€” no binding for balance button.

    // æ›´æ–°é»ç¾¤æµç¨‹åœ– Overlay é‚è¼¯
    window.togglePgFlowchart = function() {
        const overlay = document.getElementById('pg-flowchart-overlay');
        if (!overlay) return;
        overlay.style.display = (overlay.style.display === 'none' || overlay.style.display === '') ? 'block' : 'none';
        document.body.style.overflow = (overlay.style.display === 'block') ? 'hidden' : '';
    };
    // Balance feature removed; previously invoked setupEquationBalancer().

    // 1. åŸºç¤æŒ‰éˆ•ç¶å®š
    const modeBtn = document.getElementById('mode-toggle');
    if (modeBtn) modeBtn.addEventListener('click', toggleMode);

    const loadBtn = document.getElementById('load-btn');
    if (loadBtn) loadBtn.addEventListener('click', handleLoadBtn);

    const inputField = document.getElementById('formula-input');
    if (inputField) {
        inputField.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') handleLoadBtn();
        });
    }

    // 2. é¡¯ç¤ºè¨­å®šé–‹é—œ
    const toggleLp = document.getElementById('toggle-lp');
    if (toggleLp) toggleLp.addEventListener('change', () => { renderScene(); });

    // Glow option removed; glow is fixed disabled so no event binding required

    // å„ªå…ˆéµå¾ªå…«éš…é«”ï¼šæ§åˆ¶é …å·²ç§»é™¤ï¼Œç„¡éœ€äº‹ä»¶ç¶å®š

    const togglePoly = document.getElementById('toggle-polyhedron');
    if (togglePoly) togglePoly.addEventListener('change', () => { renderScene(); });

    // é›»æ¼¿æ…‹æ¨¡å¼æ§åˆ¶é …å·²ç§»é™¤; plasma ä¿æŒ disabled (isPlasmaMode defaults to false)

    // Reaction button bindings removed (buttons removed from DOM)

    const btnConfig = document.getElementById('btn-open-config');
    if(btnConfig) btnConfig.addEventListener('click', openConfigModal);

    // Theme toggle handler
    if (themeToggleBtn) {
        themeToggleBtn.addEventListener('click', () => {
            const isLight = document.body.classList.toggle('light-mode');
            try { localStorage.setItem('lightMode', isLight ? 'true' : 'false'); } catch (e) {}
            // Show the mode that will be switched to
            themeToggleBtn.textContent = isLight ? 'æ·±è‰²æ¨¡å¼' : 'æ·ºè‰²æ¨¡å¼';
        });
    }


    // 5. æ‰‹æ©Ÿé¢æ¿èˆ‡éµç›¤
    const mobileHandle = document.getElementById('mobile-panel-handle');
    if (mobileHandle) {
        mobileHandle.addEventListener('click', () => {
            const body = document.body;
            body.classList.toggle('simulate-mobile-open');
            const panel = document.querySelector('.controls-area');
            if (panel) {
                if (body.classList.contains('simulate-mobile-open')) panel.style.transform = 'translateY(0)';
                else panel.style.transform = 'translateY(70vh)';
            }
        });
    }
    window.addEventListener('keydown', (e) => { if (e.key === 'Alt') altKeyIsDown = true; });
    window.addEventListener('keyup', (e) => { if (e.key === 'Alt') altKeyIsDown = false; });

    // 6. 3D æ‹–æ›³æ§åˆ¶
    const MOUSE_SENSITIVITY = 0.005; const TOUCH_SENSITIVITY = 0.004;
    let longPressTimer = null; let startX = 0, startY = 0;
    const LONG_PRESS_MS = 500; const MOVE_TOLERANCE = 10;

    const handleStart = (x, y) => { 
        isDragging = true; isLongPressActive = false; 
        startX = x; startY = y; lastMouse = { x, y }; 
        rotVelocity = { x: 0, y: 0, z: 0 }; hideHybridTooltip(); 
        clearTimeout(longPressTimer);

        if (isFaceBuildMode) {
            // æ‰‹æ©Ÿç‰ˆå„ªåŒ–ï¼šæˆé¢æ¨¡å¼éœ€åœç•™ 0.2 ç§’æ‰è§¸ç™¼ï¼Œé˜²æ­¢æ—‹è½‰èª¤è§¸å°è‡´é¸å–å¤±æ•—
            longPressTimer = setTimeout(() => {
                checkAtomClick(startX, startY);
                isLongPressActive = true; // æ¨™è¨˜å·²è§¸ç™¼ï¼Œé˜²æ­¢æ”¾é–‹æ™‚é‡è¤‡é¸å–
                if (navigator.vibrate) navigator.vibrate(30); 
            }, 200);
        } else {
            // æ­£å¸¸æ¨¡å¼ï¼šé•·æŒ‰ 0.5 ç§’é¡¯ç¤ºæ··æˆè»ŒåŸŸ
            longPressTimer = setTimeout(() => {
                isDragging = false; isLongPressActive = true; 
                checkAtomClick(startX, startY); 
                if (navigator.vibrate) navigator.vibrate(40);
            }, LONG_PRESS_MS);
        }
    };

    const handleMove = (x, y, sensitivity) => {
        if (Math.abs(x - startX) > MOVE_TOLERANCE || Math.abs(y - startY) > MOVE_TOLERANCE) clearTimeout(longPressTimer);
        if (!isDragging) return;
        const dx = x - lastMouse.x; const dy = y - lastMouse.y;
        if (currentMode === 1 || (currentMode === 2 && !altKeyIsDown)) {
            rotVelocity.y = dx * sensitivity; rotVelocity.x = -dy * sensitivity; 
            applyRotation(rotVelocity.y, rotVelocity.x, 0);
        } else {
            panOffset.x += dx * 0.5; panOffset.y += dy * 0.5;
        }
        lastMouse = { x, y };
    };
    const handleEnd = (x, y) => { 
        clearTimeout(longPressTimer); 
        
        // è‹¥åœ¨æˆé¢æ¨¡å¼ï¼Œé¸å–å·²åœ¨ 0.2 ç§’è¨ˆæ™‚å™¨å®Œæˆï¼Œæ­¤è™•åƒ…é‡ç½®æ——æ¨™
        if (isFaceBuildMode) {
            isDragging = false;
            isLongPressActive = false;
            return;
        }

        const moveDist = Math.hypot(x - startX, y - startY);
        if (!isLongPressActive && moveDist < MOVE_TOLERANCE) {
            checkAtomClick(x, y);
        }
        isDragging = false; 
        isLongPressActive = false; 
    };

    viewport.addEventListener("mousedown", e => handleStart(e.clientX, e.clientY));
    viewport.addEventListener("mousemove", e => handleMove(e.clientX, e.clientY, MOUSE_SENSITIVITY));
    viewport.addEventListener("mouseup", handleEnd);
    
    viewport.addEventListener("touchstart", e => {
        if(e.target.closest('.control-button')) return;
        if (e.touches.length === 1) {
            // æ‰‹æ©Ÿç‰ˆä¹Ÿå¼·åˆ¶ç«‹å³åŸ·è¡Œ handleStart é‚è¼¯
            handleStart(e.touches[0].clientX, e.touches[0].clientY);
        } else if (e.touches.length === 2) {
            clearTimeout(longPressTimer); 
            const t1 = e.touches[0], t2 = e.touches[1];
            lastTouchDist = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
            lastTouchCenter = { x: (t1.clientX + t2.clientX)/2, y: (t1.clientY + t2.clientY)/2 };
            lastTouchAngle = Math.atan2(t2.clientY - t1.clientY, t2.clientX - t1.clientX);
        }
    }, { passive: false });

    viewport.addEventListener("touchmove", e => {
        e.preventDefault(); 
        if(e.touches.length === 1) {
            handleMove(e.touches[0].clientX, e.touches[0].clientY, TOUCH_SENSITIVITY);
        } else if (e.touches.length === 2) {
            const t1 = e.touches[0], t2 = e.touches[1];
            const center = { x: (t1.clientX + t2.clientX)/2, y: (t1.clientY + t2.clientY)/2 };
            panOffset.x += (center.x - lastTouchCenter.x) * 0.4;
            panOffset.y += (center.y - lastTouchCenter.y) * 0.4;
            lastTouchCenter = center;
            const dist = Math.hypot(t1.clientX - t2.clientX, t1.clientY - t2.clientY);
            if (lastTouchDist > 0) {
                const zoomDelta = (dist - lastTouchDist) * 0.003;
                scale = Math.max(0.3, Math.min(8, scale + zoomDelta));
            }
            lastTouchDist = dist;
            const angle = Math.atan2(t2.clientY - t1.clientY, t2.clientX - t1.clientX);
            let angleDelta = angle - lastTouchAngle;
            if (angleDelta > Math.PI) angleDelta -= Math.PI * 2;
            if (angleDelta < -Math.PI) angleDelta += Math.PI * 2;
            rotVelocity.z = angleDelta;
            applyRotation(0, 0, rotVelocity.z);
            lastTouchAngle = angle;
        }
    }, { passive: false });

    viewport.addEventListener("touchend", e => {
        if (e.changedTouches.length > 0) {
            handleEnd(e.changedTouches[0].clientX, e.changedTouches[0].clientY);
        } else {
            handleEnd(0, 0);
        }
    });
    viewport.addEventListener("wheel", e => {
        scale = Math.max(0.5, Math.min(6, scale - e.deltaY * 0.001));
        hideHybridTooltip();
    });

    setupMobilePanel();
}

// ç¹ªè£½æ°´æ»´ç‹€èŠ±ç“£ (Bezier Curve)
function drawLobe(lobe) {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    const x1 = lobe.pStart.x; const y1 = lobe.pStart.y;
    const x2 = lobe.pEnd.x;   const y2 = lobe.pEnd.y;
    
    const dx = x2 - x1; const dy = y2 - y1;
    const len = Math.sqrt(dx*dx + dy*dy);
    if (len < 1) return;

    const width = 45 * lobe.scale; 
    const nx = -dy / len; const ny = dx / len; 

    const midX = x1 + dx * 0.6; const midY = y1 + dy * 0.6;
    const cp1x = midX + nx * width; const cp1y = midY + ny * width;
    const cp2x = midX - nx * width; const cp2y = midY - ny * width;

    const d = `M ${x1} ${y1} Q ${cp1x} ${cp1y} ${x2} ${y2} Q ${cp2x} ${cp2y} ${x1} ${y1} Z`;
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", d);
    
    const fillUrl = (lobe.colorType === 'd') ? "url(#grad-orb-d)" : "url(#grad-orb-p)";
    path.setAttribute("fill", fillUrl);
    path.setAttribute("stroke", (lobe.colorType === 'd') ? "#B45309" : "#047857");
    path.setAttribute("stroke-width", "1");
    path.setAttribute("opacity", "0.9"); 

    g.appendChild(path);
    sceneRoot.appendChild(g);
}

// â˜… æ–°ç‰ˆï¼šé«˜è³ªæ„Ÿé‡‘å±¬è»¸ (éŠ€ç°è»¸èº« + ç™½è‰²æ–‡å­— + ç„¡å‡¸é»ç®­é ­) â˜…
function drawAxisVector(axis) {
    const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
    const x1 = axis.pStart.x; const y1 = axis.pStart.y;
    const x2 = axis.pEnd.x;   const y2 = axis.pEnd.y;

    const dx = x2 - x1; const dy = y2 - y1;
    const len = Math.sqrt(dx*dx + dy*dy);
    
    // å®‰å…¨æª¢æŸ¥ï¼šé˜²æ­¢é•·åº¦ç‚º 0 å°è‡´ NaN éŒ¯èª¤
    if (len < 0.1) return;

    const ux = dx/len; const uy = dy/len;
    const arrowSize = 10 * axis.scale;
    const lineEndX = x2 - ux * (arrowSize - 2); 
    const lineEndY = y2 - uy * (arrowSize - 2);

    // 1. ç•«ç·š (æ”¯æ´é‡‘è‰²æ¼¸å±¤)
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", x1); line.setAttribute("y1", y1);
    line.setAttribute("x2", lineEndX); line.setAttribute("y2", lineEndY);
    line.setAttribute("stroke", axis.customColor || "#B0B0B0"); 
    line.setAttribute("stroke-width", 3 * axis.scale); 
    line.setAttribute("stroke-linecap", "butt");
    g.appendChild(line);
    line.setAttribute("stroke", axis.customColor || "#B0B0B0"); 
    line.setAttribute("stroke-width", 3 * axis.scale); 
    line.setAttribute("stroke-linecap", "butt");
    // å¦‚æœæ˜¯ Sn è»¸ï¼Œè¨­å®šç‚ºè™›ç·š
    if (axis.isDashed) {
        line.setAttribute("stroke-dasharray", "8, 5"); 
    }
    g.appendChild(line);

    // 2. ç•«ç®­é ­
    const bx = x2 - ux * arrowSize;
    const by = y2 - uy * arrowSize;
    const vx = -uy * arrowSize * 0.5;
    const vy = ux * arrowSize * 0.5;
    const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
    polygon.setAttribute("points", `${x2},${y2} ${bx + vx},${by + vy} ${bx - vx},${by - vy}`);
    polygon.setAttribute("fill", axis.customColor || "#B0B0B0"); 
    g.appendChild(polygon);

    // 3. ç•«æ–‡å­— (æ”¯æ´é»ƒè‰²æ–‡å­—)
    if (axis.label) {
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", x2 + ux * 18 * axis.scale);
        text.setAttribute("y", y2 + uy * 18 * axis.scale);
        text.setAttribute("fill", axis.labelColor || "#FFFFFF"); 
        text.setAttribute("font-size", 16 * axis.scale);
        text.setAttribute("font-weight", "bold");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("dominant-baseline", "middle");
        text.style.textShadow = "0 0 5px #000000"; 
        text.textContent = axis.label;
        g.appendChild(text);
    }
    sceneRoot.appendChild(g);
}



function toChineseNum(num) { const map={1:'ä¸€',2:'äºŒ',3:'ä¸‰',4:'å››',5:'äº”',6:'å…­',7:'ä¸ƒ'}; return map[num]||num; }
function toSub(num) { 
    const subs = {'0':'â‚€','1':'â‚','2':'â‚‚','3':'â‚ƒ','4':'â‚„','5':'â‚…','6':'â‚†','7':'â‚‡','8':'â‚ˆ','9':'â‚‰'};
    return num.toString().split('').map(c => subs[c] || c).join('');
}

// ========== [è«‹æ’å…¥é€™æ®µ JS] é›¢å­è¨ˆç®—é‚è¼¯ ==========
// ========== [è«‹æ’å…¥é€™æ®µ JS] 1. æ¨™æº–è»ŒåŸŸé †åº & 2. ç¸®å¯«è½‰æ›å™¨ ==========
const ORBITAL_ORDER = ['1s','2s','2p','3s','3p','4s','3d','4p','5s','4d','5p','6s','4f','5d','6p','7s','5f','6d','7p'];

// å°‡å®Œæ•´çµ„æ…‹è½‰ç‚ºæƒ°æ€§æ°£é«”ç¸®å¯« (ä¾‹å¦‚: 1s2 2s2 2p6 -> [Ne])
function toNobleNotation(fullConfig) {
    // å®šç¾©æƒ°æ€§æ°£é«”æ ¸å¿ƒ
    const nobles = [
        { sym: '[Rn]', conf: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6 4f14 5d10 6s2 6p6" },
        { sym: '[Xe]', conf: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6 4d10 5s2 5p6" },
        { sym: '[Kr]', conf: "1s2 2s2 2p6 3s2 3p6 3d10 4s2 4p6" },
        { sym: '[Ar]', conf: "1s2 2s2 2p6 3s2 3p6" },
        { sym: '[Ne]', conf: "1s2 2s2 2p6" },
        { sym: '[He]', conf: "1s2" }
    ];

    for (let gas of nobles) {
        if (fullConfig.startsWith(gas.conf) && fullConfig !== gas.conf) {
            // ç§»é™¤æ ¸å¿ƒéƒ¨åˆ†ï¼Œä¿ç•™å‰©ä¸‹çš„
            let rest = fullConfig.replace(gas.conf, "").trim();
            return `<span class="noble">${gas.sym}</span> ${rest}`;
        }
    }
    // å¦‚æœæ¯” He é‚„å° (ä¾‹å¦‚ H)ï¼Œç›´æ¥å›å‚³
    return fullConfig;
}
function calculateIonConfig(baseConfigStr, charge) {
    if (charge === 0) return baseConfigStr;

    const parts = baseConfigStr.split(' ');
    let orbitals = [];
    const typeVal = { 's':0, 'p':1, 'd':2, 'f':3 };
    // å®šç¾©å„è»ŒåŸŸå®¹é‡
    const capacity = { 's':2, 'p':6, 'd':10, 'f':14 };

    parts.forEach(p => {
        const match = p.match(/(\d)([spdf])(\d+)/);
        if (match) {
            orbitals.push({
                n: parseInt(match[1]),
                type: match[2],
                l: typeVal[match[2]],
                count: parseInt(match[3]),
                name: match[1] + match[2] // e.g., "1s"
            });
        }
    });

    // --- CASE A: é™½é›¢å­ (å¤±å»é›»å­) ---
    if (charge > 0) {
        let removeCount = charge;
        while (removeCount > 0) {
            let candidates = orbitals.filter(o => o.count > 0);
            if (candidates.length === 0) break;

            // æ’åºï¼šå…ˆæ‹” n æœ€å¤§ï¼Œn ç›¸åŒæ‹” l æœ€å¤§
            candidates.sort((a, b) => {
                if (b.n !== a.n) return b.n - a.n;
                return b.l - a.l;
            });

            let target = candidates[0];
            if (target.count >= removeCount) {
                target.count -= removeCount;
                removeCount = 0;
            } else {
                removeCount -= target.count;
                target.count = 0;
            }
        }
    } 
    // --- CASE B: é™°é›¢å­ (å¾—åˆ°é›»å­) ---
    else {
        let addCount = Math.abs(charge);
        
        // 1. å…ˆå˜—è©¦å¡«æ»¿ç¾æœ‰çš„æœ€å¾Œä¸€å€‹è»ŒåŸŸ
        // ä¾ç…§èƒ½é‡æ’åº (åŸæœ¬çš„å­—ä¸²é †åºé€šå¸¸å°±æ˜¯èƒ½é‡é †åºï¼Œé™¤äº†ä¾‹å¤–ï¼Œä½†é€™é‚Šæˆ‘å€‘ç°¡å–®è™•ç†)
        // ç‚ºäº†ä¿éšªï¼Œæˆ‘å€‘ç›´æ¥çœ‹æœ€å¾Œä¸€å€‹è»ŒåŸŸ
        while (addCount > 0) {
            let lastOrbital = orbitals[orbitals.length - 1];
            let maxCap = capacity[lastOrbital.type];

            if (lastOrbital.count < maxCap) {
                let space = maxCap - lastOrbital.count;
                let fill = Math.min(space, addCount);
                lastOrbital.count += fill;
                addCount -= fill;
            } else {
                // ç•¶å‰è»ŒåŸŸå·²æ»¿ï¼Œå°‹æ‰¾ä¸‹ä¸€å€‹è»ŒåŸŸ
                let currentName = lastOrbital.name; // e.g. "2p"
                let idx = ORBITAL_ORDER.indexOf(currentName);
                
                if (idx !== -1 && idx < ORBITAL_ORDER.length - 1) {
                    let nextName = ORBITAL_ORDER[idx + 1]; // e.g. "3s"
                    let nextMatch = nextName.match(/(\d)([spdf])/);
                    
                    // æ–°å¢ä¸€å€‹ç©ºè»ŒåŸŸåˆ°é™£åˆ—ä¸­
                    let newOrb = {
                        n: parseInt(nextMatch[1]),
                        type: nextMatch[2],
                        l: typeVal[nextMatch[2]],
                        count: 0, // åˆå§‹ç‚º0ï¼Œä¸‹ä¸€è¼ªè¿´åœˆæœƒå¡«å…¥
                        name: nextName
                    };
                    orbitals.push(newOrb);
                } else {
                    break; // è¶…å‡ºç¯„åœæˆ–æ‰¾ä¸åˆ°ï¼Œåœæ­¢ (é¿å…ç„¡çª®è¿´åœˆ)
                }
            }
        }
    }

    // é‡çµ„å­—ä¸²
    return orbitals
        .filter(o => o.count > 0)
        .map(o => `${o.n}${o.type}${o.count}`)
        .join(' ');
}

function generateEcViz(configStr) {
    const parts = configStr.split(' ');
    let html = '';
    parts.forEach(part => {
        const match = part.match(/(\d)([spdf])(\d+)/);
        if(match) {
            const level = match[1]; const type = match[2]; const count = parseInt(match[3]);
            const boxCount = {s:1, p:3, d:5, f:7}[type];
            let arrows = []; let e = count;
            for(let i=0; i<boxCount; i++) arrows[i] = "";
            for(let i=0; i<boxCount && e>0; i++, e--) arrows[i] = "â†‘";
            for(let i=0; i<boxCount && e>0; i++, e--) arrows[i] = "â‡…";
            let boxes = '';
            arrows.forEach(a => { boxes += `<div class="ec-box">${a || ''}</div>`; });
            html += `<div class="ec-sub"><div class="ec-boxes">${boxes}</div><div class="ec-label">${level}${type}<sup>${count}</sup></div></div>`;
        }
    });
    return html;
}

function renderConfigList() {
    const input = document.getElementById('configSearchInput');
    const filter = input ? input.value.toLowerCase() : "";
    const container = document.getElementById('configListContainer');
    container.innerHTML = "";
    let shownCount = 0;
    const MAX_SHOW = (window.innerWidth < 768) ? 15 : 118;

    ELECTRON_DATA.forEach(el => {
        if (filter) {
            const isNumeric = !isNaN(filter) && filter !== "";
            const isSymbolMatch = el.s.toLowerCase().startsWith(filter); 
            const isChineseMatch = el.cn === filter; // ä¸­æ–‡å®Œå…¨åŒ¹é…
            const isZMatch = el.z.toString() === filter;

            if (isNumeric) {
                if (!isZMatch) return;
            } else {
                if (!isSymbolMatch && !isChineseMatch) return;
            }
        }

        // 2. æ•ˆèƒ½é™åˆ¶é‚è¼¯ (æœå°‹æ™‚é€šå¸¸ä¸æœƒé”åˆ°é™åˆ¶ï¼Œä¸»è¦æ˜¯ä¿è­·ç©ºæœå°‹ç‹€æ…‹)
        if (shownCount >= MAX_SHOW) return;
        shownCount++;

        const card = document.createElement('div');
        card.className = 'element-card';
        
        // é è¨­é¡¯ç¤ºï¼šç¸®å¯«ç‰ˆ
        // æˆ‘å€‘å°‡ "å®Œæ•´çµ„æ…‹" å­˜åœ¨ data-full-config å±¬æ€§ä¸­
        // å°‡ "ç•¶å‰é›»è·" å­˜åœ¨ data-charge å±¬æ€§ä¸­ (é è¨­0)
        // å°‡ "é¡¯ç¤ºæ¨¡å¼" å­˜åœ¨ data-mode å±¬æ€§ä¸­ (é è¨­ 'noble')
        
        let nobleHtml = el.noble.replace(/(\[.*?\])/g, '<span class="noble">$1</span>')
                                .replace(/([spdf])(\d+)/g, '$1<sup>$2</sup>');
        const vizHtml = generateEcViz(el.c);
        
        let periodGroupStr = "";
        if (el.g === "é‘­ç³»" || el.g === "éŒ’ç³»") {
            periodGroupStr = `ç¬¬${toChineseNum(el.p)}é€±æœŸ <span style="color:#f472b6;">${el.g}</span>`;
        } else {
            periodGroupStr = `ç¬¬${toChineseNum(el.p)}é€±æœŸ ${el.g}æ— (ç¬¬${el.iupac}æ—)`;
        }

        const cardId = `card-${el.s}`;

        card.innerHTML = `
            <div class="ec-header">
                <div class="ec-top-row">
                    <div class="ec-sym-box">
                        <div class="ec-sym">${el.s}</div>
                        <div class="ec-info">
                            <span class="ec-name">${el.cn ? el.cn + " " : ""}${el.n} <span style="color:var(--accent-yellow); font-family:'Noto Serif TC', serif;">Z=${el.z}</span></span>
                            <span class="ec-tag">${periodGroupStr}</span>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 6px;">
                                <div style="border:1px solid rgba(255,255,255,0.2); border-radius:6px; padding:3px 8px; font-size:0.75rem; color:#cbd5e1; background:rgba(20,20,20,0.3); white-space:nowrap;">åˆ†é¡: ${el.type || "-"}</div>
                                <div style="border:1px solid rgba(255,255,255,0.2); border-radius:6px; padding:3px 8px; font-size:0.75rem; color:#cbd5e1; background:rgba(20,20,20,0.3); white-space:nowrap;">ç‹€æ…‹: ${el.state || "-"}</div>
                                <div style="border:1px solid rgba(255,255,255,0.2); border-radius:6px; padding:3px 8px; font-size:0.75rem; color:#cbd5e1; background:rgba(20,20,20,0.3); white-space:nowrap;">ç†”é»: ${el.mp || "-"}</div>
                                <div style="border:1px solid rgba(255,255,255,0.2); border-radius:6px; padding:3px 8px; font-size:0.75rem; color:#cbd5e1; background:rgba(20,20,20,0.3); white-space:nowrap;">æ²¸é»: ${el.bp || "-"}</div>
                            </div>
                        </div>
                    </div>
                
                <!-- é¡¯ç¤ºæ¨¡å¼åˆ‡æ›æŒ‰éˆ• -->
                <button onclick="toggleConfigMode('${el.s}', '${el.c}')" style="font-size:0.75rem; background:rgba(255,255,255,0.1); border:1px solid #555; color:#aaa; border-radius:4px; padding:2px 6px; cursor:pointer;" id="${cardId}-mode-btn">
                    æ¨¡å¼: ç¸®å¯«
                </button>
            </div>
            
            <!-- é›¢å­æ§åˆ¶ -->
            <div id="ion-group-${el.s}" style="display:flex; gap:6px; margin:10px 0; flex-wrap:wrap; align-items:center;">
                <button class="ion-btn active" data-charge="0" data-type="neutral" onclick="updateIonViz('${el.s}', '${el.c}', 0)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #64748b; border-radius:4px; color:#cbd5e1; background:#1e293b; cursor:pointer;">ä¸­æ€§</button>
                
                <button class="ion-btn" data-charge="1" data-type="pos" onclick="updateIonViz('${el.s}', '${el.c}', 1)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #f87171; border-radius:4px; color:#f87171; background:rgba(248,113,113,0.1); cursor:pointer;">+1</button>
                <button class="ion-btn" data-charge="2" data-type="pos" onclick="updateIonViz('${el.s}', '${el.c}', 2)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #f87171; border-radius:4px; color:#f87171; background:rgba(248,113,113,0.1); cursor:pointer;">+2</button>
                <button class="ion-btn" data-charge="3" data-type="pos" onclick="updateIonViz('${el.s}', '${el.c}', 3)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #f87171; border-radius:4px; color:#f87171; background:rgba(248,113,113,0.1); cursor:pointer;">+3</button>
                
                <button class="ion-btn" data-charge="-1" data-type="neg" onclick="updateIonViz('${el.s}', '${el.c}', -1)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #60a5fa; border-radius:4px; color:#60a5fa; background:rgba(96,165,250,0.1); cursor:pointer;">-1</button>
                <button class="ion-btn" data-charge="-2" data-type="neg" onclick="updateIonViz('${el.s}', '${el.c}', -2)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #60a5fa; border-radius:4px; color:#60a5fa; background:rgba(96,165,250,0.1); cursor:pointer;">-2</button>
                <button class="ion-btn" data-charge="-3" data-type="neg" onclick="updateIonViz('${el.s}', '${el.c}', -3)" 
                    style="font-size:0.75rem; padding:4px 8px; border:1px solid #60a5fa; border-radius:4px; color:#60a5fa; background:rgba(96,165,250,0.1); cursor:pointer;">-3</button>
            </div>

                <!-- éš±è—æ¬„ä½ï¼šå„²å­˜ç•¶å‰é›»è·èˆ‡æ¨¡å¼ -->
                <input type="hidden" id="${cardId}-charge" value="0">
                <input type="hidden" id="${cardId}-mode" value="noble">

                <div class="ec-config-row ec-scroll" id="${cardId}-text" style="justify-content: flex-start;">
                    <div class="ec-config" style="white-space: nowrap;">${nobleHtml}</div>
                </div>
            </div>
            <div class="ec-scroll">
                <div class="ec-row" id="${cardId}-viz">
                    ${vizHtml}
                </div>
            </div>
        `;
        container.appendChild(card);
    });
}
// ========== [è«‹æ›¿æ› updateIonViz ä¸¦æ–°å¢ toggleConfigMode] ==========
// [ä¿®æ”¹] æ›´æ–°é›¢å­è¦–è¦ºåŒ– (åŠ å…¥æŒ‰éˆ•ç™¼äº®é‚è¼¯)
function updateIonViz(symbol, baseConfig, charge) {
    // 1. è¨ˆç®—é›¢å­çµ„æ…‹
    const newConfig = calculateIonConfig(baseConfig, charge);
    
    // 2. å–å¾—æ¨¡å¼èˆ‡å„²å­˜é›»è·
    const modeInput = document.getElementById(`card-${symbol}-mode`);
    const currentMode = modeInput ? modeInput.value : 'noble';
    const chargeInput = document.getElementById(`card-${symbol}-charge`);
    if(chargeInput) chargeInput.value = charge;

    // 3. ã€é—œéµã€‘åˆ‡æ›æŒ‰éˆ•ç‹€æ…‹ (é€™è£¡åªæ”¹ Classï¼Œä¸æ¶‰åŠè¤‡é›œé‹ç®—)
    const btnGroup = document.getElementById(`ion-group-${symbol}`);
    if (btnGroup) {
        // ä½¿ç”¨æœ€å‚³çµ±çš„ for è¿´åœˆï¼Œæ•ˆèƒ½æœ€å¥½
        const btns = btnGroup.getElementsByClassName('ion-btn');
        for (let i = 0; i < btns.length; i++) {
            let btn = btns[i];
            let btnCharge = parseInt(btn.getAttribute('data-charge'));
            if (btnCharge === charge) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        }
    }

    // 4. æ›´æ–°æ–‡å­—é¡¯ç¤º
    let displayHtml = (currentMode === 'noble') ? formatConfigHtml(toNobleNotation(newConfig)) : formatConfigHtml(newConfig);
    const textEl = document.getElementById(`card-${symbol}-text`);
    const color = charge > 0 ? '#f87171' : (charge < 0 ? '#60a5fa' : '#a5f3fc');
    if(textEl) textEl.innerHTML = `<div class="ec-config" style="color:${color}">${displayHtml}</div>`;
    
    // 5. æ›´æ–°è»ŒåŸŸåœ–
    const vizEl = document.getElementById(`card-${symbol}-viz`);
    if(vizEl) vizEl.innerHTML = generateEcViz(newConfig);
}

// åˆ‡æ›é¡¯ç¤ºæ¨¡å¼ (ç¸®å¯« <-> å®Œæ•´)
function toggleConfigMode(symbol, baseConfig) {
    const modeInput = document.getElementById(`card-${symbol}-mode`);
    const btn = document.getElementById(`card-${symbol}-mode-btn`);
    const chargeInput = document.getElementById(`card-${symbol}-charge`);
    
    if (modeInput && btn && chargeInput) {
        // åˆ‡æ›ç‹€æ…‹
        if (modeInput.value === 'noble') {
            modeInput.value = 'full';
            btn.textContent = "æ¨¡å¼: å®Œæ•´";
            btn.style.color = "#fff";
        } else {
            modeInput.value = 'noble';
            btn.textContent = "æ¨¡å¼: ç¸®å¯«";
            btn.style.color = "#aaa";
        }
        
        // è®€å–ç•¶å‰é›»è·ï¼Œé‡æ–°åˆ·æ–°é¡¯ç¤º
        const currentCharge = parseInt(chargeInput.value);
        updateIonViz(symbol, baseConfig, currentCharge);
    }
}

// è¼”åŠ©ï¼šHTML æ ¼å¼åŒ– (å°‡ [Ar] è®Šè‰²ï¼Œå°‡æ•¸å­—è®Šä¸Šæ¨™)
function formatConfigHtml(str) {
    return str.replace(/(\[.*?\])/g, '<span class="noble">$1</span>')
              .replace(/([spdf])(\d+)/g, '$1<sup>$2</sup>');
}

function openConfigModal() { const modal = document.getElementById('config-modal'); if(modal) { modal.style.display = 'flex'; renderConfigList(); } }
function closeConfigModal() { const modal = document.getElementById('config-modal'); if(modal) modal.style.display = 'none'; }


function checkAtomClick(screenX, screenY) {
    if (!currentMolecule || !currentMolecule.renderObjects) return;
    const bestMatch = findAtomByScreenPos(screenX, screenY);
    
    if (bestMatch) {
        if (isFaceBuildMode) {
            const idx = bestMatch.originalIndex;
            const selectPos = faceSelection.indexOf(idx);
            
            if (selectPos > -1) {
                // --- å†æ¬¡é»æ“Šï¼šå–æ¶ˆé¸å– ---
                faceSelection.splice(selectPos, 1);
                bestMatch.isHighlighted = false;
            } else {
                // --- æ­£å¸¸é¸å–ï¼šåŠ å…¥æ¸…å–® ---
                faceSelection.push(idx);
                bestMatch.isHighlighted = "center"; 
                
                if (faceSelection.length === 3) {
                    customFaces.push([...faceSelection, currentFaceColor]);
                    faceSelection = [];
                    currentMolecule.renderObjects.forEach(o => o.isHighlighted = false);
                }
            }
            renderScene();
            return; 
        }

        // --- ä»¥ä¸‹ç‚ºåŸæœ¬çš„æ··æˆè»ŒåŸŸ/é›¢å­åˆ¤å®šé‚è¼¯ ---
        if (currentMolecule.isIonic) {
            if (bestMatch.isRepresentative) {
                if (bestMatch.isHighlighted === "center") clearHighlights();
                else highlightNeighbors(bestMatch);
            } else {
                clearHighlights();
            }
        } else {
            showHybridInfo(bestMatch, screenX, screenY);
        }
    } else {
        hideHybridTooltip();
        if (currentMolecule && currentMolecule.isIonic) clearHighlights();
    }
}

function highlightNeighbors(centerAtom) {
    currentMolecule.renderObjects.forEach(obj => obj.isHighlighted = false);
    centerAtom.isHighlighted = "center"; 
    let count = 0;
    const centerIdx = centerAtom.originalIndex;
    if (currentMolecule.bonds3D) {
        currentMolecule.bonds3D.forEach(bond => {
            let nIdx = -1;
            if (bond[0] === centerIdx) nIdx = bond[1];
            else if (bond[1] === centerIdx) nIdx = bond[0];
            if (nIdx !== -1) {
                const n = currentMolecule.renderObjects.find(obj => obj.type === 'atom' && obj.originalIndex === nIdx);
                if (n) { n.isHighlighted = "neighbor"; count++; }
            }
        });
    }
    const tooltip = document.getElementById('hybrid-label');
    if(tooltip) {
        tooltip.innerHTML = `<div style="text-align:center;"><span style="color:#facc15; font-weight:bold; font-size:1.2em;">${centerAtom.elem}</span><br>é…ä½æ•¸: <span style="color:#fff; font-weight:bold; font-size:1.4em;">${count}</span></div>`;
        tooltip.classList.add('show');
    }
    renderScene();
}

function clearHighlights() {
    if(!currentMolecule) return;
    currentMolecule.renderObjects.forEach(obj => obj.isHighlighted = false);
    renderScene();
}

function toggleFaceBuildMode() {
    isFaceBuildMode = !isFaceBuildMode;
    faceSelection = [];
    const btn = document.getElementById('btn-face-mode');
    if (btn) {
        btn.innerHTML = `é»æ“Šä¸‰é»æˆé¢: ${isFaceBuildMode ? 'ON' : 'OFF'}`;
        btn.style.background = isFaceBuildMode ? "rgba(253, 224, 71, 0.25)" : "rgba(0, 0, 0, 0.4)";
        btn.style.boxShadow = isFaceBuildMode ? "0 0 15px rgba(253, 224, 71, 0.4)" : "none";
    }
    if(currentMolecule) currentMolecule.renderObjects.forEach(o => o.isHighlighted = false);
    renderScene();
}

function setFaceColor(color) {
    currentFaceColor = color;
    document.querySelectorAll('.face-color-btn').forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-color') === color);
    });
}

function clearCustomFaces() {
    customFaces = [];
    faceSelection = [];
    if(currentMolecule) currentMolecule.renderObjects.forEach(o => o.isHighlighted = false);
    renderScene();
}

// è¦†å¯«è¼‰å…¥é‚è¼¯ï¼šæ›åˆ†å­æ™‚è‡ªå‹•æ¸…é™¤å¹³é¢
if (typeof loadMolecule === 'function' && !window._manualFaceWrapped) {
    const _originalLoad = loadMolecule;
    loadMolecule = function(key, variant) {
        customFaces = [];
        faceSelection = [];
        _originalLoad(key, variant);
    };
    window._manualFaceWrapped = true;
}

function findAtomByScreenPos(screenX, screenY) {
    const atomGroups = document.querySelectorAll("g[data-atom-idx]");
    let candidates = [];
    atomGroups.forEach(g => {
        const idx = parseInt(g.getAttribute("data-atom-idx"));
        const atomData = currentMolecule.renderObjects[idx];
        if (!atomData) return;
        const circle = g.querySelector("circle");
        if (!circle) return;
        const rect = circle.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;
        const dist = Math.hypot(screenX - cx, screenY - cy);
        if (dist < (rect.width / 2 + 10)) {
            const p = project(atomData);
            candidates.push({ atom: atomData, z: p.z, dist: dist });
        }
    });
    if (candidates.length === 0) return null;
    candidates.sort((a, b) => b.z - a.z);
    return candidates[0].atom;
}

// ========== [è«‹æ›¿æ› showHybridInfo å‡½å¼] ==========
function showHybridInfo(atomObj, x, y) {
    const tooltip = document.getElementById('hybrid-label');
    if(!tooltip) return;

    const atomIdx = atomObj.originalIndex;
    let sigmaCount = 0;
    if (currentMolecule.bonds3D) {
        currentMolecule.bonds3D.forEach(b => {
            if (b[0] === atomIdx || b[1] === atomIdx) {
                sigmaCount++;
            }
        });
    }
    
    const lpCount = atomObj.calculatedLP || 0;
    const sum = sigmaCount + lpCount;
    
    // è¨ˆç®—å½¢å¼é›»è·æ•¸æ“š
    const props = ELEMENT_PROPS[atomObj.elem];
    const ve = props ? props.ve : "?";
    const dots = (lpCount * 2) + (atomObj.radical ? 1 : 0);
    let bondLines = 0;
    if (currentMolecule.bonds3D) {
        currentMolecule.bonds3D.forEach(b => {
            if (b[0] === atomIdx || b[1] === atomIdx) {
                let type = b[2] || "single";
                if (type.includes("triple")) bondLines += 3;
                else if (type.includes("double")) bondLines += 2;
                else if (type === "coordinate") bondLines += 1; 
                else if (type === "coordinate_triple") bondLines += 3;
                else bondLines += 1;
            }
        });
    }

    const fc = atomObj.formalCharge || 0;
    let fcStr = fc > 0 ? `+${fc}` : `${fc}`;
    let fcColor = fc === 0 ? "#9ca3af" : (fc > 0 ? "#f87171" : "#60a5fa");

    // [ä¿®æ”¹] è¨ˆç®—éç¨‹å­—ä¸²ï¼šç·š -> éµ
    const calcStr = `<div style="font-size:0.8em; color:#bbb; margin-top:4px; border-top:1px solid #444; padding-top:2px;">(åƒ¹${ve} - é»${dots} - éµ${bondLines})</div>`;

    let contentHtml = `<span style="color:var(--accent-yellow);font-size:1.5em;line-height:1.2;font-weight:bold;">${atomObj.elem}</span>`;
    
    // [ä¿®æ”¹] èª¿æ•´é¡¯ç¤ºé †åº
    if (sigmaCount >= 2) { 
        let hybrid = "";
        let hybridColor = "#ffffff"; 
        if (sum === 2) { hybrid = "sp"; hybridColor = "var(--accent-yellow)"; } 
        else if (sum === 3) { hybrid = "spÂ²"; hybridColor = "#a3e635"; } 
        else if (sum === 4) { hybrid = "spÂ³"; hybridColor = "#fbbf24"; } 
        else if (sum === 5) { hybrid = "spÂ³d"; hybridColor = "#f472b6"; } 
        else if (sum === 6) { hybrid = "spÂ³dÂ²"; hybridColor = "#818cf8"; } 
        else { hybrid = "-"; }

        // 1. é¡¯ç¤ºæ··æˆ
        contentHtml += `<div style="margin-top:4px;">æ··æˆ: <span style="color:${hybridColor};font-size:1.2em">${hybrid}</span></div>`;
        
        // 2. é¡¯ç¤º Sigma + LP è¨ˆç®— (ç§»åˆ°æ··æˆä¸‹æ–¹)
        contentHtml += `<div style="font-size:0.8em;color:#888;margin-top:2px;margin-bottom:6px;">(&sigma;:${sigmaCount} + LP:${lpCount} = ${sum})</div>`;
        
        // 3. é¡¯ç¤ºå½¢å¼é›»è· (æ–‡å­—æ”¹ç‚º "å½¢å¼é›»è·")
        contentHtml += `<div>å½¢å¼é›»è·: <span style="color:${fcColor};font-size:1.2em;font-weight:bold">${fcStr}</span></div>`;
        
        // 4. é¡¯ç¤ºå½¢å¼é›»è·è¨ˆç®—å…¬å¼ (æ”¾åœ¨æœ€ä¸‹æ–¹)
        contentHtml += calcStr;
        // =====================================

    } else {  
        contentHtml += `<div style="margin-top:4px;">é›»è·: <span style="color:${fcColor};font-size:1.4em;font-weight:bold">${fcStr}</span></div>`;
        if(atomObj.elem === 'H') contentHtml += `<div style="font-size:0.8em;color:#888;">(1s)</div>`;
        
        // [ä¿®æ”¹] è¨ˆç®—éç¨‹æ”¾åœ¨æœ€å¾Œ
        contentHtml += calcStr;
    }

    tooltip.innerHTML = contentHtml;
    tooltip.classList.add('show');
}

function hideHybridTooltip() {
    const tooltip = document.getElementById('hybrid-label');
    if (tooltip) tooltip.classList.remove('show');
}

function setupMobilePanel() {
    const panel = document.querySelector('.controls-area');
    const handle = document.getElementById('mobile-panel-handle');
    
    if(!handle || !panel || window.innerWidth > 768) return;

    // --- è¨­å®šåƒæ•¸ ---
    const getPos = () => {
        const H = window.innerHeight;
        return {
            P98: 0,              // å…¨é–‹
            P70: H * 0.3,        // éœ²å‡º 70%
            P35: H * 0.65,       // éœ²å‡º 35%
            PMIN: H - 45         // æœ€ä½ (é˜²æ¶ˆå¤±ä½)
        };
    };

    let p = getPos();
    let startY = 0, startTransY = p.P35, currentTransY = p.P35, isDragging = false;

    // åˆå§‹ä½ç½®è¨­å®šåœ¨ 35%
    panel.style.transform = `translateY(${p.P35}px)`;

    // æ»‘å‹•é‚è¼¯
    handle.addEventListener('touchstart', (e) => {
        isDragging = true;
        startY = e.touches[0].clientY;
        const style = window.getComputedStyle(panel);
        const matrix = new WebKitCSSMatrix(style.transform);
        startTransY = matrix.m42;
        panel.style.transition = 'none';
    }, {passive: true});

    window.addEventListener('touchmove', (e) => {
        if(!isDragging) return;
        let newY = startTransY + (e.touches[0].clientY - startY);
        if (newY < 0) newY *= 0.3; // é ‚éƒ¨é˜»å°¼
        panel.style.transform = `translateY(${newY}px)`;
        currentTransY = newY;
    }, {passive: true});

    window.addEventListener('touchend', () => {
        if(!isDragging) return;
        isDragging = false;
        panel.style.transition = 'transform 0.5s cubic-bezier(0.19, 1, 0.22, 1)';
        p = getPos();
        const dists = [
            {v: p.P98, d: Math.abs(currentTransY - p.P98)},
            {v: p.P70, d: Math.abs(currentTransY - p.P70)},
            {v: p.P35, d: Math.abs(currentTransY - p.P35)},
            {v: p.PMIN, d: Math.abs(currentTransY - p.PMIN)}
        ];
        const closest = dists.reduce((a, b) => a.d < b.d ? a : b);
        panel.style.transform = `translateY(${closest.v}px)`;
    });

    // ã€ä¿®æ­£ï¼šé»æ“Šæ©«æ§“è·³è½‰ã€‘
    handle.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        p = getPos();
        const style = window.getComputedStyle(panel);
        const matrix = new WebKitCSSMatrix(style.transform);
        const curY = matrix.m42;

        panel.style.transition = 'transform 0.5s cubic-bezier(0.19, 1, 0.22, 1)';
        
        let target;
        // å¾ªç’°åˆ¤å®šï¼šåº•éƒ¨ -> 35 -> 70 -> 98 -> å›åº•éƒ¨
        if (curY > p.P35 + 50) target = p.P35;
        else if (curY > p.P70 + 50) target = p.P70;
        else if (curY > p.P98 + 50) target = p.P98;
        else target = p.PMIN;

        panel.style.transform = `translateY(${target}px)`;
    });
}


// ===============================================
// 1. ç³»çµ±å‚™ä»½èˆ‡åˆå§‹åŒ– (4K é«˜æ¸…é›»å­é›²ç‰ˆ)
// ===============================================

if (!window._nativeRenderScene) {
    window._nativeRenderScene = window.renderScene;
    window._nativeLoadMolecule = window.loadMolecule;
}

// Orbital UI/code removed: restore native render/load if present
if (window._nativeRenderScene) window.renderScene = window._nativeRenderScene;
if (window._nativeLoadMolecule) window.loadMolecule = window._nativeLoadMolecule;

// initOrbitalUI removed; no delayed init required

// ==========================================
// [ç³»çµ±ä¿®å¾©] è§£æ±ºè»ŒåŸŸé‡ç–Šå•é¡Œ & ç¢ºä¿ç•«é¢æ¸…é™¤
// ==========================================

// Orbital rendering removed; restore native renderer if available
if (window._nativeRenderScene) window.renderScene = window._nativeRenderScene;

</script>
<script>
(function(){
    const TRANSLATIONS = {
        zh: {
            'mode-toggle': 'æ¨¡å¼: è¤‡åˆ',
            'theme-toggle': 'ä¸»é¡Œ: æš—è‰²',
            'card-title-input': 'è¼¸å…¥åŒ–å­¸å¼',
            'load-btn': 'è¼‰å…¥',
            'lbl-lp': 'é¡¯ç¤ºå­¤å°é›»å­',
            'lbl-auto-rotate': 'è‡ªå‹•æ—‹è½‰',
            'data-card-title': 'ç‰©è³ªè³‡æ–™',
            'lbl-formula': 'åŒ–å­¸å¼',
            'lbl-name': 'ä¸­æ–‡åç¨±',
            'lbl-shape': 'å½¢ç‹€',
            'lbl-angle': 'éµè§’',
            'lbl-mp': 'ç†”é» (MP)',
            'lbl-bp': 'æ²¸é» (BP)',
            'lbl-bonds': 'éµçµçµ±è¨ˆ',
            'lbl-mass': 'åˆ†å­é‡'
        },
        en: {
            'mode-toggle': 'Mode: Composite',
            'theme-toggle': 'Theme: Dark',
            'card-title-input': 'Input Formula',
            'load-btn': 'Load',
            'lbl-lp': 'Show lone pairs',
            'lbl-auto-rotate': 'Auto-rotate',
            'data-card-title': 'Substance Data',
            'lbl-formula': 'Formula',
            'lbl-name': 'Name',
            'lbl-shape': 'Shape',
            'lbl-angle': 'Bond angle',
            'lbl-mp': 'Melting point',
            'lbl-bp': 'Boiling point',
            'lbl-bonds': 'Bond stats',
            'lbl-mass': 'Molar mass'
        }
    };

    function applyLanguage(lang){
        document.documentElement.lang = (lang === 'en') ? 'en' : 'zh-MO';
        const map = TRANSLATIONS[lang] || {};
        Object.keys(map).forEach(id=>{
            const el = document.getElementById(id);
            if(!el) return;
            if(el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                el.placeholder = map[id];
            } else {
                el.textContent = map[id];
            }
        });
        const langBtn = document.getElementById('lang-toggle');
        if(langBtn) langBtn.textContent = (lang === 'zh' ? 'EN' : 'ä¸­');
        window.__APP_LANG = lang;
    }

        document.addEventListener('DOMContentLoaded', ()=>{
        const saved = localStorage.getItem('app_lang') || (navigator.language && navigator.language.startsWith('en') ? 'en' : 'zh');
        applyLanguage(saved);
        // If a molecule is already loaded, refresh its displayed labels to match language
        try{ if (window.currentKey) loadMolecule(window.currentKey, window.currentVariantKey); }catch(e){}
        const btn = document.getElementById('lang-toggle');
        if(btn){
            btn.addEventListener('click', ()=>{
                const next = (window.__APP_LANG === 'en' ? 'zh' : 'en');
                applyLanguage(next);
                try{ localStorage.setItem('app_lang', next); }catch(e){}
                try{ if (window.currentKey) loadMolecule(window.currentKey, window.currentVariantKey); }catch(e){}
            });
        }
        window.setAppLang = function(lang){ applyLanguage(lang); try{ if (window.currentKey) loadMolecule(window.currentKey, window.currentVariantKey); }catch(e){} };
    });
})();
</script>
<script>
// Recovery: ensure interactions and molecule rendering initialize even if earlier scripts errored
(function(){
    try{
        if (typeof setupInteractions === 'function') setupInteractions();
    } catch(e) { console.error('setupInteractions recovery failed', e); }
    try{
        if (typeof animate === 'function') { try{ animate(); } catch(e){} }
    } catch(e) {}
    try{
        if (typeof loadMolecule === 'function') {
            if (!window.currentKey) loadMolecule('H2O');
            else loadMolecule(window.currentKey, window.currentVariantKey);
        }
    } catch(e) { console.error('loadMolecule recovery failed', e); }
})();
</script>
</body>
</html>
